SELECT DISTINCT ATC.TABLE_NAME, ATC.COLUMN_NAME 
	FROM sys.ALL_TAB_COLUMNS atc
WHERE lower(ATC.OWNER) = lower('BSICRM') 
AND lower(ATC.COLUMN_NAME) LIKE lower('entry_%')
ORDER BY ATC.TABLE_NAME
;

SELECT
	CMP.X_COMPLEX_NO,
	SEMP."NO"
FROM S2_EM_PRODUCT_CONDENSED_IN semp 
	INNER JOIN BSI_COMPANY cmp
	ON CMP.COMPANY_NR = SEMP.NXCUSTOMERID
;


SELECT
	count(DISTINCT XOF.ENTRY_NO) Anzahl
FROM BSI_X_OFFER xof
;
-- 13156

SELECT
	count(DISTINCT XSO.ENTRY_NO) Anzahl
FROM BSI_X_SERVICE_OVERVIEW xso
;
-- 9265

SELECT
	count(DISTINCT XOF.ENTRY_NO) Anzahl
FROM BSI_X_SERVICE_OVERVIEW xso
	INNER JOIN BSI_X_OFFER xof
	ON XOF.ENTRY_NO = XSO.ENTRY_NO
	INNER JOIN EXT_OFFER exo 
	ON EXO.ENTRY_NO = XSO.ENTRY_NO
;
-- 9183

SELECT 
	CMP.X_COMPLEX_NO,
	XOF.ENTRY_NO,
	XOF.CUSTOMER_KEY0_NR,
	XOF.CUSTOMER_NO
FROM BSI_COMPANY cmp 
	INNER JOIN BSI_X_OFFER xof
	ON CAST(REGEXP_REPLACE(XOF.CUSTOMER_NO, '[^0-9]+', '') AS NUMBER(22)) = CMP.COMPANY_NO
;

SELECT 
	CMP.X_COMPLEX_NO,
	XOF.ENTRY_NO,
	XOF.CUSTOMER_KEY0_NR,
	XOF.CUSTOMER_NO
FROM BSI_COMPANY cmp 
	INNER JOIN BSI_X_SERVICE_OVERVIEW xof
	ON CAST(REGEXP_REPLACE(XOF.CUSTOMER_NO, '[^0-9]+', '') AS NUMBER(22)) = CMP.COMPANY_NO
;
