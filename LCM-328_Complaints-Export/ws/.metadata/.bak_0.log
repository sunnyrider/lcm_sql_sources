!SESSION 2019-10-30 14:02:43.819 -----------------------------------------------
eclipse.buildId=4.9.0.I20180906-0745
java.version=11.0.3
java.vendor=Oracle Corporation
BootLoader constants: OS=win32, ARCH=x86_64, WS=win32, NL=de_CH
Framework arguments:  -product org.eclipse.epp.package.jee.product
Command-line arguments:  -os win32 -ws win32 -arch x86_64 -product org.eclipse.epp.package.jee.product

This is a continuation of log file C:\Users\dir14400\OneDrive\Dokumente\Jira\10_Tickets_OKT.2019\LCM-328_Cases-Complaint-Overview\ws\.metadata\.bak_0.log
Created Time: 2019-10-30 14:53:57.477

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-30 14:53:57.479
!MESSAGE SQL-Fehler [904] [42000]: ORA-00904: "CSE"."CHANNEL_UID": ungültiger Bezeichner

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-30 14:53:57.479
!MESSAGE Error : 904, Position : 1797, Sql = WITH preselect AS
(
	SELECT cse.*,
		CMP.COMPANY_NO,
		CMP.NAME1 company_display_name
	FROM BSI_CASE cse
		INNER JOIN BSI_COMPANY cmp
		ON CMP.COMPANY_NR = CSE.X_COMPANY_NR
	INNER JOIN BSI_COMMUNICATION cmc
	ON CMC.CASE_FRAME_NR = CSE.CASE_FRAME_NR
	WHERE CSE.STATUS_UID IN (75959)
	AND CSE.X_COMPANY_NR <> 0
	AND CMP.IS_ACTIVE = 1
	AND CSE.CASE_FRAME_NR <> 0
	AND CSE.EVT_START > TO_DATE('31.12.2014', 'dd.mm.yyyy')
	ORDER BY CSE.X_COMPANY_NR, CSE.CASE_NO
)
SELECT
	to_char(CSE.EVT_END, 'dd.mm.yyyy') closed_date,
	CSE.EMAIL_ADDRESS contact_email,
	CSE.FAX_NO contact_fax,
	CSE.PERSON_NR LCM_Contact_Number,
	CSE.PHONE_NO contact_mobile,
	CSE.PHONE_NO contact_phone,
	to_char(CSE.EVT_START, 'dd.mm.yyyy') created_date,
	1 closed,
	CMC.CHANNEL_UID,
	uc_origin.TEXT case_origin,
--	CSE.PROCESS_UID,
	'LCM' case_reason,
	CASE WHEN uc_process.text = 'Beschwerde' THEN
		uc_process.text
	ELSE
		'other'
	END record_type,
	'Closed' Status,
	CMC.DISPLAY_NAME subject,
	CSE.COMPANY_NO company,
	CSE.company_display_name description,
	CSE.CASE_NO,
	CASE WHEN prsopen.FIRST_NAME IS NOT NULL THEN 
		prsopen.FIRST_NAME || ' ' || prsopen.LAST_NAME
	WHEN prsopen.LAST_NAME IS NULL THEN
		''
	ELSE 
		prsopen.LAST_NAME
	END LCM_User_opened_Case,
	CASE WHEN prsclose.FIRST_NAME IS NOT NULL THEN 
		prsclose.FIRST_NAME || ' ' || prsclose.LAST_NAME
	WHEN prsclose.LAST_NAME IS NULL THEN
		''
	ELSE 
		prsclose.LAST_NAME
	END LCM_User_closed_CASE,
	CASE WHEN CMC.TEXT_LOB IS NOT NULL THEN 
		REPLACE(dbms_lob.substr(CMC.TEXT_LOB, 3000, 1), '\t', ' ') 
	ELSE 
		''
	END LCM_Communcation_Text,
	CMC.X_COMMUNICATION_EXT_KEY LCM_Document_link
FROM preselect cse
	INNER JOIN BSI_COMMUNICATION cmc
	    INNER JOIN BSI_UC_TEXT uc_origin ON uc_origin.UC_UID = CSE.CHANNEL_UID AND uc_origin.LANGUAGE_UID = 1303
	ON CMC.CASE_FRAME_NR = CSE.CASE_FRAME_NR
--	ON CMC.COMPANY_NR = CSE.X_COMPANY_NR
    INNER JOIN BSI_PERSON prsopen ON prsopen.PERSON_NR = CSE.CREATE_USER_NR
    INNER JOIN BSI_PERSON prsclose ON prsclose.PERSON_NR = CSE.X_CLOSE_USER_NR
	INNER JOIN BSI_UC_TEXT uc_process ON uc_process.UC_UID = CSE.PROCESS_UID AND uc_process.LANGUAGE_UID = 246
WHERE CMC.ORIGIN_UID NOT IN (105356, 143891)  -- 105356	Marketing, 143891	National Report
AND CSE.CHANNEL_UID IN (100032, 100030, 100029, 104860, 104864, 133803)
AND CMC.EVT_START > TO_DATE('31.12.2014', 'dd.mm.yyyy')
AND CMC.CASE_FRAME_NR = CSE.CASE_FRAME_NR
, OriginalSql = WITH preselect AS
(
	SELECT cse.*,
		CMP.COMPANY_NO,
		CMP.NAME1 company_display_name
	FROM BSI_CASE cse
		INNER JOIN BSI_COMPANY cmp
		ON CMP.COMPANY_NR = CSE.X_COMPANY_NR
	INNER JOIN BSI_COMMUNICATION cmc
	ON CMC.CASE_FRAME_NR = CSE.CASE_FRAME_NR
	WHERE CSE.STATUS_UID IN (75959)
	AND CSE.X_COMPANY_NR <> 0
	AND CMP.IS_ACTIVE = 1
	AND CSE.CASE_FRAME_NR <> 0
	AND CSE.EVT_START > TO_DATE('31.12.2014', 'dd.mm.yyyy')
	ORDER BY CSE.X_COMPANY_NR, CSE.CASE_NO
)
SELECT
	to_char(CSE.EVT_END, 'dd.mm.yyyy') closed_date,
	CSE.EMAIL_ADDRESS contact_email,
	CSE.FAX_NO contact_fax,
	CSE.PERSON_NR LCM_Contact_Number,
	CSE.PHONE_NO contact_mobile,
	CSE.PHONE_NO contact_phone,
	to_char(CSE.EVT_START, 'dd.mm.yyyy') created_date,
	1 closed,
	CMC.CHANNEL_UID,
	uc_origin.TEXT case_origin,
--	CSE.PROCESS_UID,
	'LCM' case_reason,
	CASE WHEN uc_process.text = 'Beschwerde' THEN
		uc_process.text
	ELSE
		'other'
	END record_type,
	'Closed' Status,
	CMC.DISPLAY_NAME subject,
	CSE.COMPANY_NO company,
	CSE.company_display_name description,
	CSE.CASE_NO,
	CASE WHEN prsopen.FIRST_NAME IS NOT NULL THEN 
		prsopen.FIRST_NAME || ' ' || prsopen.LAST_NAME
	WHEN prsopen.LAST_NAME IS NULL THEN
		''
	ELSE 
		prsopen.LAST_NAME
	END LCM_User_opened_Case,
	CASE WHEN prsclose.FIRST_NAME IS NOT NULL THEN 
		prsclose.FIRST_NAME || ' ' || prsclose.LAST_NAME
	WHEN prsclose.LAST_NAME IS NULL THEN
		''
	ELSE 
		prsclose.LAST_NAME
	END LCM_User_closed_CASE,
	CASE WHEN CMC.TEXT_LOB IS NOT NULL THEN 
		REPLACE(dbms_lob.substr(CMC.TEXT_LOB, 3000, 1), '\t', ' ') 
	ELSE 
		''
	END LCM_Communcation_Text,
	CMC.X_COMMUNICATION_EXT_KEY LCM_Document_link
FROM preselect cse
	INNER JOIN BSI_COMMUNICATION cmc
	    INNER JOIN BSI_UC_TEXT uc_origin ON uc_origin.UC_UID = CSE.CHANNEL_UID AND uc_origin.LANGUAGE_UID = 1303
	ON CMC.CASE_FRAME_NR = CSE.CASE_FRAME_NR
--	ON CMC.COMPANY_NR = CSE.X_COMPANY_NR
    INNER JOIN BSI_PERSON prsopen ON prsopen.PERSON_NR = CSE.CREATE_USER_NR
    INNER JOIN BSI_PERSON prsclose ON prsclose.PERSON_NR = CSE.X_CLOSE_USER_NR
	INNER JOIN BSI_UC_TEXT uc_process ON uc_process.UC_UID = CSE.PROCESS_UID AND uc_process.LANGUAGE_UID = 246
WHERE CMC.ORIGIN_UID NOT IN (105356, 143891)  -- 105356	Marketing, 143891	National Report
AND CSE.CHANNEL_UID IN (100032, 100030, 100029, 104860, 104864, 133803)
AND CMC.EVT_START > TO_DATE('31.12.2014', 'dd.mm.yyyy')
AND CMC.CASE_FRAME_NR = CSE.CASE_FRAME_NR
, Error Msg = ORA-00904: "CSE"."CHANNEL_UID": ungültiger Bezeichner

!STACK 0
Error : 904, Position : 1797, Sql = WITH preselect AS
(
	SELECT cse.*,
		CMP.COMPANY_NO,
		CMP.NAME1 company_display_name
	FROM BSI_CASE cse
		INNER JOIN BSI_COMPANY cmp
		ON CMP.COMPANY_NR = CSE.X_COMPANY_NR
	INNER JOIN BSI_COMMUNICATION cmc
	ON CMC.CASE_FRAME_NR = CSE.CASE_FRAME_NR
	WHERE CSE.STATUS_UID IN (75959)
	AND CSE.X_COMPANY_NR <> 0
	AND CMP.IS_ACTIVE = 1
	AND CSE.CASE_FRAME_NR <> 0
	AND CSE.EVT_START > TO_DATE('31.12.2014', 'dd.mm.yyyy')
	ORDER BY CSE.X_COMPANY_NR, CSE.CASE_NO
)
SELECT
	to_char(CSE.EVT_END, 'dd.mm.yyyy') closed_date,
	CSE.EMAIL_ADDRESS contact_email,
	CSE.FAX_NO contact_fax,
	CSE.PERSON_NR LCM_Contact_Number,
	CSE.PHONE_NO contact_mobile,
	CSE.PHONE_NO contact_phone,
	to_char(CSE.EVT_START, 'dd.mm.yyyy') created_date,
	1 closed,
	CMC.CHANNEL_UID,
	uc_origin.TEXT case_origin,
--	CSE.PROCESS_UID,
	'LCM' case_reason,
	CASE WHEN uc_process.text = 'Beschwerde' THEN
		uc_process.text
	ELSE
		'other'
	END record_type,
	'Closed' Status,
	CMC.DISPLAY_NAME subject,
	CSE.COMPANY_NO company,
	CSE.company_display_name description,
	CSE.CASE_NO,
	CASE WHEN prsopen.FIRST_NAME IS NOT NULL THEN 
		prsopen.FIRST_NAME || ' ' || prsopen.LAST_NAME
	WHEN prsopen.LAST_NAME IS NULL THEN
		''
	ELSE 
		prsopen.LAST_NAME
	END LCM_User_opened_Case,
	CASE WHEN prsclose.FIRST_NAME IS NOT NULL THEN 
		prsclose.FIRST_NAME || ' ' || prsclose.LAST_NAME
	WHEN prsclose.LAST_NAME IS NULL THEN
		''
	ELSE 
		prsclose.LAST_NAME
	END LCM_User_closed_CASE,
	CASE WHEN CMC.TEXT_LOB IS NOT NULL THEN 
		REPLACE(dbms_lob.substr(CMC.TEXT_LOB, 3000, 1), '\t', ' ') 
	ELSE 
		''
	END LCM_Communcation_Text,
	CMC.X_COMMUNICATION_EXT_KEY LCM_Document_link
FROM preselect cse
	INNER JOIN BSI_COMMUNICATION cmc
	    INNER JOIN BSI_UC_TEXT uc_origin ON uc_origin.UC_UID = CSE.CHANNEL_UID AND uc_origin.LANGUAGE_UID = 1303
	ON CMC.CASE_FRAME_NR = CSE.CASE_FRAME_NR
--	ON CMC.COMPANY_NR = CSE.X_COMPANY_NR
    INNER JOIN BSI_PERSON prsopen ON prsopen.PERSON_NR = CSE.CREATE_USER_NR
    INNER JOIN BSI_PERSON prsclose ON prsclose.PERSON_NR = CSE.X_CLOSE_USER_NR
	INNER JOIN BSI_UC_TEXT uc_process ON uc_process.UC_UID = CSE.PROCESS_UID AND uc_process.LANGUAGE_UID = 246
WHERE CMC.ORIGIN_UID NOT IN (105356, 143891)  -- 105356	Marketing, 143891	National Report
AND CSE.CHANNEL_UID IN (100032, 100030, 100029, 104860, 104864, 133803)
AND CMC.EVT_START > TO_DATE('31.12.2014', 'dd.mm.yyyy')
AND CMC.CASE_FRAME_NR = CSE.CASE_FRAME_NR
, OriginalSql = WITH preselect AS
(
	SELECT cse.*,
		CMP.COMPANY_NO,
		CMP.NAME1 company_display_name
	FROM BSI_CASE cse
		INNER JOIN BSI_COMPANY cmp
		ON CMP.COMPANY_NR = CSE.X_COMPANY_NR
	INNER JOIN BSI_COMMUNICATION cmc
	ON CMC.CASE_FRAME_NR = CSE.CASE_FRAME_NR
	WHERE CSE.STATUS_UID IN (75959)
	AND CSE.X_COMPANY_NR <> 0
	AND CMP.IS_ACTIVE = 1
	AND CSE.CASE_FRAME_NR <> 0
	AND CSE.EVT_START > TO_DATE('31.12.2014', 'dd.mm.yyyy')
	ORDER BY CSE.X_COMPANY_NR, CSE.CASE_NO
)
SELECT
	to_char(CSE.EVT_END, 'dd.mm.yyyy') closed_date,
	CSE.EMAIL_ADDRESS contact_email,
	CSE.FAX_NO contact_fax,
	CSE.PERSON_NR LCM_Contact_Number,
	CSE.PHONE_NO contact_mobile,
	CSE.PHONE_NO contact_phone,
	to_char(CSE.EVT_START, 'dd.mm.yyyy') created_date,
	1 closed,
	CMC.CHANNEL_UID,
	uc_origin.TEXT case_origin,
--	CSE.PROCESS_UID,
	'LCM' case_reason,
	CASE WHEN uc_process.text = 'Beschwerde' THEN
		uc_process.text
	ELSE
		'other'
	END record_type,
	'Closed' Status,
	CMC.DISPLAY_NAME subject,
	CSE.COMPANY_NO company,
	CSE.company_display_name description,
	CSE.CASE_NO,
	CASE WHEN prsopen.FIRST_NAME IS NOT NULL THEN 
		prsopen.FIRST_NAME || ' ' || prsopen.LAST_NAME
	WHEN prsopen.LAST_NAME IS NULL THEN
		''
	ELSE 
		prsopen.LAST_NAME
	END LCM_User_opened_Case,
	CASE WHEN prsclose.FIRST_NAME IS NOT NULL THEN 
		prsclose.FIRST_NAME || ' ' || prsclose.LAST_NAME
	WHEN prsclose.LAST_NAME IS NULL THEN
		''
	ELSE 
		prsclose.LAST_NAME
	END LCM_User_closed_CASE,
	CASE WHEN CMC.TEXT_LOB IS NOT NULL THEN 
		REPLACE(dbms_lob.substr(CMC.TEXT_LOB, 3000, 1), '\t', ' ') 
	ELSE 
		''
	END LCM_Communcation_Text,
	CMC.X_COMMUNICATION_EXT_KEY LCM_Document_link
FROM preselect cse
	INNER JOIN BSI_COMMUNICATION cmc
	    INNER JOIN BSI_UC_TEXT uc_origin ON uc_origin.UC_UID = CSE.CHANNEL_UID AND uc_origin.LANGUAGE_UID = 1303
	ON CMC.CASE_FRAME_NR = CSE.CASE_FRAME_NR
--	ON CMC.COMPANY_NR = CSE.X_COMPANY_NR
    INNER JOIN BSI_PERSON prsopen ON prsopen.PERSON_NR = CSE.CREATE_USER_NR
    INNER JOIN BSI_PERSON prsclose ON prsclose.PERSON_NR = CSE.X_CLOSE_USER_NR
	INNER JOIN BSI_UC_TEXT uc_process ON uc_process.UC_UID = CSE.PROCESS_UID AND uc_process.LANGUAGE_UID = 246
WHERE CMC.ORIGIN_UID NOT IN (105356, 143891)  -- 105356	Marketing, 143891	National Report
AND CSE.CHANNEL_UID IN (100032, 100030, 100029, 104860, 104864, 133803)
AND CMC.EVT_START > TO_DATE('31.12.2014', 'dd.mm.yyyy')
AND CMC.CASE_FRAME_NR = CSE.CASE_FRAME_NR
, Error Msg = ORA-00904: "CSE"."CHANNEL_UID": ungültiger Bezeichner

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-30 15:17:10.457
!MESSAGE SQL-Fehler [933] [42000]: ORA-00933: SQL-Befehl wurde nicht korrekt beendet

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-30 15:17:10.457
!MESSAGE Error : 933, Position : 269, Sql = --	REPLACE(dbms_lob.substr(XCPL.SOLUTION_NOTES, 100, 1), ';', '') solution_notes,
--	XCPL.CREATE_CASE_NR,
	(
		SELECT CASE WHEN ICSA.STATUS_UID != 75959 THEN
			0
		ELSE 
			XCPL.COMPLAINT_NR 
		END 
		FROM BSI_CASE ICSA
		WHERE ICSA.CASE_NR = MCC.CASE_NR
	) AS update_complaint_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uct ON UCT.UC_UID = CSE.STATUS_UID AND UCT.LANGUAGE_UID = 1303
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_UC_TEXT xuct ON XUCT.UC_UID = XCPL.STATUS_UID AND XUCT.LANGUAGE_UID = 1303
	INNER JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.STATUS_UID AND uc_cp_cat.LANGUAGE_UID = 1303
WHERE XCPL.COMPANY_NR > 0
AND XCPL.STATUS_UID IN (109053, 119170)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (
	SELECT start_date FROM date_range
)
--AND XCPL.EVT_DUE < (
--	SELECT end_date FROM date_range
--)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, OriginalSql = --	REPLACE(dbms_lob.substr(XCPL.SOLUTION_NOTES, 100, 1), ';', '') solution_notes,
--	XCPL.CREATE_CASE_NR,
	(
		SELECT CASE WHEN ICSA.STATUS_UID != 75959 THEN
			0
		ELSE 
			XCPL.COMPLAINT_NR 
		END 
		FROM BSI_CASE ICSA
		WHERE ICSA.CASE_NR = MCC.CASE_NR
	) AS update_complaint_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uct ON UCT.UC_UID = CSE.STATUS_UID AND UCT.LANGUAGE_UID = 1303
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_UC_TEXT xuct ON XUCT.UC_UID = XCPL.STATUS_UID AND XUCT.LANGUAGE_UID = 1303
	INNER JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.STATUS_UID AND uc_cp_cat.LANGUAGE_UID = 1303
WHERE XCPL.COMPANY_NR > 0
AND XCPL.STATUS_UID IN (109053, 119170)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (
	SELECT start_date FROM date_range
)
--AND XCPL.EVT_DUE < (
--	SELECT end_date FROM date_range
--)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, Error Msg = ORA-00933: SQL-Befehl wurde nicht korrekt beendet

!STACK 0
Error : 933, Position : 269, Sql = --	REPLACE(dbms_lob.substr(XCPL.SOLUTION_NOTES, 100, 1), ';', '') solution_notes,
--	XCPL.CREATE_CASE_NR,
	(
		SELECT CASE WHEN ICSA.STATUS_UID != 75959 THEN
			0
		ELSE 
			XCPL.COMPLAINT_NR 
		END 
		FROM BSI_CASE ICSA
		WHERE ICSA.CASE_NR = MCC.CASE_NR
	) AS update_complaint_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uct ON UCT.UC_UID = CSE.STATUS_UID AND UCT.LANGUAGE_UID = 1303
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_UC_TEXT xuct ON XUCT.UC_UID = XCPL.STATUS_UID AND XUCT.LANGUAGE_UID = 1303
	INNER JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.STATUS_UID AND uc_cp_cat.LANGUAGE_UID = 1303
WHERE XCPL.COMPANY_NR > 0
AND XCPL.STATUS_UID IN (109053, 119170)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (
	SELECT start_date FROM date_range
)
--AND XCPL.EVT_DUE < (
--	SELECT end_date FROM date_range
--)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, OriginalSql = --	REPLACE(dbms_lob.substr(XCPL.SOLUTION_NOTES, 100, 1), ';', '') solution_notes,
--	XCPL.CREATE_CASE_NR,
	(
		SELECT CASE WHEN ICSA.STATUS_UID != 75959 THEN
			0
		ELSE 
			XCPL.COMPLAINT_NR 
		END 
		FROM BSI_CASE ICSA
		WHERE ICSA.CASE_NR = MCC.CASE_NR
	) AS update_complaint_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uct ON UCT.UC_UID = CSE.STATUS_UID AND UCT.LANGUAGE_UID = 1303
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_UC_TEXT xuct ON XUCT.UC_UID = XCPL.STATUS_UID AND XUCT.LANGUAGE_UID = 1303
	INNER JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.STATUS_UID AND uc_cp_cat.LANGUAGE_UID = 1303
WHERE XCPL.COMPANY_NR > 0
AND XCPL.STATUS_UID IN (109053, 119170)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (
	SELECT start_date FROM date_range
)
--AND XCPL.EVT_DUE < (
--	SELECT end_date FROM date_range
--)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, Error Msg = ORA-00933: SQL-Befehl wurde nicht korrekt beendet

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-30 15:18:05.042
!MESSAGE SQL-Fehler [900] [42000]: ORA-00900: Ungültige SQL-Anweisung

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-30 15:18:05.042
!MESSAGE Error : 900, Position : 311, Sql = --	REPLACE(dbms_lob.substr(XCPL.SOLUTION_NOTES, 100, 1), ';', '') solution_notes,
--	XCPL.CREATE_CASE_NR,
--	(
--		SELECT CASE WHEN ICSA.STATUS_UID != 75959 THEN
--			0
--		ELSE 
--			XCPL.COMPLAINT_NR 
--		END 
--		FROM BSI_CASE ICSA
--		WHERE ICSA.CASE_NR = MCC.CASE_NR
--	) AS update_complaint_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uct ON UCT.UC_UID = CSE.STATUS_UID AND UCT.LANGUAGE_UID = 1303
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_UC_TEXT xuct ON XUCT.UC_UID = XCPL.STATUS_UID AND XUCT.LANGUAGE_UID = 1303
	INNER JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.STATUS_UID AND uc_cp_cat.LANGUAGE_UID = 1303
WHERE XCPL.COMPANY_NR > 0
AND XCPL.STATUS_UID IN (109053, 119170)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (
	SELECT start_date FROM date_range
)
--AND XCPL.EVT_DUE < (
--	SELECT end_date FROM date_range
--)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, OriginalSql = --	REPLACE(dbms_lob.substr(XCPL.SOLUTION_NOTES, 100, 1), ';', '') solution_notes,
--	XCPL.CREATE_CASE_NR,
--	(
--		SELECT CASE WHEN ICSA.STATUS_UID != 75959 THEN
--			0
--		ELSE 
--			XCPL.COMPLAINT_NR 
--		END 
--		FROM BSI_CASE ICSA
--		WHERE ICSA.CASE_NR = MCC.CASE_NR
--	) AS update_complaint_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uct ON UCT.UC_UID = CSE.STATUS_UID AND UCT.LANGUAGE_UID = 1303
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_UC_TEXT xuct ON XUCT.UC_UID = XCPL.STATUS_UID AND XUCT.LANGUAGE_UID = 1303
	INNER JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.STATUS_UID AND uc_cp_cat.LANGUAGE_UID = 1303
WHERE XCPL.COMPANY_NR > 0
AND XCPL.STATUS_UID IN (109053, 119170)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (
	SELECT start_date FROM date_range
)
--AND XCPL.EVT_DUE < (
--	SELECT end_date FROM date_range
--)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, Error Msg = ORA-00900: Ungültige SQL-Anweisung

!STACK 0
Error : 900, Position : 311, Sql = --	REPLACE(dbms_lob.substr(XCPL.SOLUTION_NOTES, 100, 1), ';', '') solution_notes,
--	XCPL.CREATE_CASE_NR,
--	(
--		SELECT CASE WHEN ICSA.STATUS_UID != 75959 THEN
--			0
--		ELSE 
--			XCPL.COMPLAINT_NR 
--		END 
--		FROM BSI_CASE ICSA
--		WHERE ICSA.CASE_NR = MCC.CASE_NR
--	) AS update_complaint_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uct ON UCT.UC_UID = CSE.STATUS_UID AND UCT.LANGUAGE_UID = 1303
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_UC_TEXT xuct ON XUCT.UC_UID = XCPL.STATUS_UID AND XUCT.LANGUAGE_UID = 1303
	INNER JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.STATUS_UID AND uc_cp_cat.LANGUAGE_UID = 1303
WHERE XCPL.COMPANY_NR > 0
AND XCPL.STATUS_UID IN (109053, 119170)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (
	SELECT start_date FROM date_range
)
--AND XCPL.EVT_DUE < (
--	SELECT end_date FROM date_range
--)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, OriginalSql = --	REPLACE(dbms_lob.substr(XCPL.SOLUTION_NOTES, 100, 1), ';', '') solution_notes,
--	XCPL.CREATE_CASE_NR,
--	(
--		SELECT CASE WHEN ICSA.STATUS_UID != 75959 THEN
--			0
--		ELSE 
--			XCPL.COMPLAINT_NR 
--		END 
--		FROM BSI_CASE ICSA
--		WHERE ICSA.CASE_NR = MCC.CASE_NR
--	) AS update_complaint_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uct ON UCT.UC_UID = CSE.STATUS_UID AND UCT.LANGUAGE_UID = 1303
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_UC_TEXT xuct ON XUCT.UC_UID = XCPL.STATUS_UID AND XUCT.LANGUAGE_UID = 1303
	INNER JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.STATUS_UID AND uc_cp_cat.LANGUAGE_UID = 1303
WHERE XCPL.COMPANY_NR > 0
AND XCPL.STATUS_UID IN (109053, 119170)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (
	SELECT start_date FROM date_range
)
--AND XCPL.EVT_DUE < (
--	SELECT end_date FROM date_range
--)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, Error Msg = ORA-00900: Ungültige SQL-Anweisung

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForRows(T4CStatement.java:887)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1136)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-30 15:18:10.657
!MESSAGE SQL-Fehler [1791] [42000]: ORA-01791: Kein mit SELECT ausgewählter Ausdruck

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-30 15:18:10.657
!MESSAGE Error : 1791, Position : 1616, Sql = 
with date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 100, 1), '\t', ' ') description,
	1 Closed,
	xcpl.COMPLAINT_CATEGORY_UID
--	XCPL.COMPLAINT_NO,
--	XCPL.EVT_ISSUED,
--	XCPL.SUBJECT,
----	XUCT.TEXT status,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
--	XCPL.COMPANY_NR,
--	XCPL.CONTRACT_NR,
--	XCPL.INVOICE_NR,
	
--	REPLACE(dbms_lob.substr(XCPL.SOLUTION_NOTES, 100, 1), ';', '') solution_notes,
--	XCPL.CREATE_CASE_NR,
--	(
--		SELECT CASE WHEN ICSA.STATUS_UID != 75959 THEN
--			0
--		ELSE 
--			XCPL.COMPLAINT_NR 
--		END 
--		FROM BSI_CASE ICSA
--		WHERE ICSA.CASE_NR = MCC.CASE_NR
--	) AS update_complaint_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uct ON UCT.UC_UID = CSE.STATUS_UID AND UCT.LANGUAGE_UID = 1303
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_UC_TEXT xuct ON XUCT.UC_UID = XCPL.STATUS_UID AND XUCT.LANGUAGE_UID = 1303
	INNER JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.STATUS_UID AND uc_cp_cat.LANGUAGE_UID = 1303
WHERE XCPL.COMPANY_NR > 0
AND XCPL.STATUS_UID IN (109053, 119170)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (
	SELECT start_date FROM date_range
)
--AND XCPL.EVT_DUE < (
--	SELECT end_date FROM date_range
--)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO

, OriginalSql = 
with date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 100, 1), '\t', ' ') description,
	1 Closed,
	xcpl.COMPLAINT_CATEGORY_UID
--	XCPL.COMPLAINT_NO,
--	XCPL.EVT_ISSUED,
--	XCPL.SUBJECT,
----	XUCT.TEXT status,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
--	XCPL.COMPANY_NR,
--	XCPL.CONTRACT_NR,
--	XCPL.INVOICE_NR,
	
--	REPLACE(dbms_lob.substr(XCPL.SOLUTION_NOTES, 100, 1), ';', '') solution_notes,
--	XCPL.CREATE_CASE_NR,
--	(
--		SELECT CASE WHEN ICSA.STATUS_UID != 75959 THEN
--			0
--		ELSE 
--			XCPL.COMPLAINT_NR 
--		END 
--		FROM BSI_CASE ICSA
--		WHERE ICSA.CASE_NR = MCC.CASE_NR
--	) AS update_complaint_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uct ON UCT.UC_UID = CSE.STATUS_UID AND UCT.LANGUAGE_UID = 1303
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_UC_TEXT xuct ON XUCT.UC_UID = XCPL.STATUS_UID AND XUCT.LANGUAGE_UID = 1303
	INNER JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.STATUS_UID AND uc_cp_cat.LANGUAGE_UID = 1303
WHERE XCPL.COMPANY_NR > 0
AND XCPL.STATUS_UID IN (109053, 119170)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (
	SELECT start_date FROM date_range
)
--AND XCPL.EVT_DUE < (
--	SELECT end_date FROM date_range
--)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO

, Error Msg = ORA-01791: Kein mit SELECT ausgewählter Ausdruck

!STACK 0
Error : 1791, Position : 1616, Sql = 
with date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 100, 1), '\t', ' ') description,
	1 Closed,
	xcpl.COMPLAINT_CATEGORY_UID
--	XCPL.COMPLAINT_NO,
--	XCPL.EVT_ISSUED,
--	XCPL.SUBJECT,
----	XUCT.TEXT status,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
--	XCPL.COMPANY_NR,
--	XCPL.CONTRACT_NR,
--	XCPL.INVOICE_NR,
	
--	REPLACE(dbms_lob.substr(XCPL.SOLUTION_NOTES, 100, 1), ';', '') solution_notes,
--	XCPL.CREATE_CASE_NR,
--	(
--		SELECT CASE WHEN ICSA.STATUS_UID != 75959 THEN
--			0
--		ELSE 
--			XCPL.COMPLAINT_NR 
--		END 
--		FROM BSI_CASE ICSA
--		WHERE ICSA.CASE_NR = MCC.CASE_NR
--	) AS update_complaint_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uct ON UCT.UC_UID = CSE.STATUS_UID AND UCT.LANGUAGE_UID = 1303
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_UC_TEXT xuct ON XUCT.UC_UID = XCPL.STATUS_UID AND XUCT.LANGUAGE_UID = 1303
	INNER JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.STATUS_UID AND uc_cp_cat.LANGUAGE_UID = 1303
WHERE XCPL.COMPANY_NR > 0
AND XCPL.STATUS_UID IN (109053, 119170)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (
	SELECT start_date FROM date_range
)
--AND XCPL.EVT_DUE < (
--	SELECT end_date FROM date_range
--)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO

, OriginalSql = 
with date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 100, 1), '\t', ' ') description,
	1 Closed,
	xcpl.COMPLAINT_CATEGORY_UID
--	XCPL.COMPLAINT_NO,
--	XCPL.EVT_ISSUED,
--	XCPL.SUBJECT,
----	XUCT.TEXT status,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
--	XCPL.COMPANY_NR,
--	XCPL.CONTRACT_NR,
--	XCPL.INVOICE_NR,
	
--	REPLACE(dbms_lob.substr(XCPL.SOLUTION_NOTES, 100, 1), ';', '') solution_notes,
--	XCPL.CREATE_CASE_NR,
--	(
--		SELECT CASE WHEN ICSA.STATUS_UID != 75959 THEN
--			0
--		ELSE 
--			XCPL.COMPLAINT_NR 
--		END 
--		FROM BSI_CASE ICSA
--		WHERE ICSA.CASE_NR = MCC.CASE_NR
--	) AS update_complaint_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uct ON UCT.UC_UID = CSE.STATUS_UID AND UCT.LANGUAGE_UID = 1303
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_UC_TEXT xuct ON XUCT.UC_UID = XCPL.STATUS_UID AND XUCT.LANGUAGE_UID = 1303
	INNER JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.STATUS_UID AND uc_cp_cat.LANGUAGE_UID = 1303
WHERE XCPL.COMPANY_NR > 0
AND XCPL.STATUS_UID IN (109053, 119170)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (
	SELECT start_date FROM date_range
)
--AND XCPL.EVT_DUE < (
--	SELECT end_date FROM date_range
--)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO

, Error Msg = ORA-01791: Kein mit SELECT ausgewählter Ausdruck

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-30 15:21:35.471
!MESSAGE SQL-Fehler [923] [42000]: ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-30 15:21:35.471
!MESSAGE Error : 923, Position : 553, Sql = with date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 100, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
	uc_cp_cat.text case_reason
--	XCPL.COMPLAINT_NO,
--	XCPL.EVT_ISSUED,
--	XCPL.SUBJECT,
----	XUCT.TEXT status,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
--	XCPL.COMPANY_NR,
--	XCPL.CONTRACT_NR,
--	XCPL.INVOICE_NR,
, OriginalSql = with date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 100, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
	uc_cp_cat.text case_reason
--	XCPL.COMPLAINT_NO,
--	XCPL.EVT_ISSUED,
--	XCPL.SUBJECT,
----	XUCT.TEXT status,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
--	XCPL.COMPANY_NR,
--	XCPL.CONTRACT_NR,
--	XCPL.INVOICE_NR,
, Error Msg = ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

!STACK 0
Error : 923, Position : 553, Sql = with date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 100, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
	uc_cp_cat.text case_reason
--	XCPL.COMPLAINT_NO,
--	XCPL.EVT_ISSUED,
--	XCPL.SUBJECT,
----	XUCT.TEXT status,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
--	XCPL.COMPANY_NR,
--	XCPL.CONTRACT_NR,
--	XCPL.INVOICE_NR,
, OriginalSql = with date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 100, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
	uc_cp_cat.text case_reason
--	XCPL.COMPLAINT_NO,
--	XCPL.EVT_ISSUED,
--	XCPL.SUBJECT,
----	XUCT.TEXT status,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
--	XCPL.COMPANY_NR,
--	XCPL.CONTRACT_NR,
--	XCPL.INVOICE_NR,
, Error Msg = ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-30 15:23:53.471
!MESSAGE SQL-Fehler [923] [42000]: ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-30 15:23:53.471
!MESSAGE Error : 923, Position : 360, Sql = with date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 100, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
	uc_cp_cat.text case_reason
	uc_status.TEXT status
--	XCPL.COMPLAINT_NO,
--	XCPL.EVT_ISSUED,
--	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
--	XCPL.COMPANY_NR,
--	XCPL.CONTRACT_NR,
--	XCPL.INVOICE_NR,	
--	REPLACE(dbms_lob.substr(XCPL.SOLUTION_NOTES, 100, 1), ';', '') solution_notes,
--	XCPL.CREATE_CASE_NR,
--	(
--		SELECT CASE WHEN ICSA.STATUS_UID != 75959 THEN
--			0
--		ELSE 
--			XCPL.COMPLAINT_NR 
--		END 
--		FROM BSI_CASE ICSA
--		WHERE ICSA.CASE_NR = MCC.CASE_NR
--	) AS update_complaint_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uct ON UCT.UC_UID = CSE.STATUS_UID AND UCT.LANGUAGE_UID = 1303
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_UC_TEXT uc_status ON uc_status.UC_UID = XCPL.STATUS_UID AND uc_status.LANGUAGE_UID = 1303
	INNER JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.STATUS_UID AND uc_cp_cat.LANGUAGE_UID = 1303
WHERE XCPL.COMPANY_NR > 0
AND XCPL.STATUS_UID IN (109053, 119170)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (
	SELECT start_date FROM date_range
)
--AND XCPL.EVT_DUE < (
--	SELECT end_date FROM date_range
--)
--ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, OriginalSql = with date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 100, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
	uc_cp_cat.text case_reason
	uc_status.TEXT status
--	XCPL.COMPLAINT_NO,
--	XCPL.EVT_ISSUED,
--	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
--	XCPL.COMPANY_NR,
--	XCPL.CONTRACT_NR,
--	XCPL.INVOICE_NR,	
--	REPLACE(dbms_lob.substr(XCPL.SOLUTION_NOTES, 100, 1), ';', '') solution_notes,
--	XCPL.CREATE_CASE_NR,
--	(
--		SELECT CASE WHEN ICSA.STATUS_UID != 75959 THEN
--			0
--		ELSE 
--			XCPL.COMPLAINT_NR 
--		END 
--		FROM BSI_CASE ICSA
--		WHERE ICSA.CASE_NR = MCC.CASE_NR
--	) AS update_complaint_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uct ON UCT.UC_UID = CSE.STATUS_UID AND UCT.LANGUAGE_UID = 1303
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_UC_TEXT uc_status ON uc_status.UC_UID = XCPL.STATUS_UID AND uc_status.LANGUAGE_UID = 1303
	INNER JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.STATUS_UID AND uc_cp_cat.LANGUAGE_UID = 1303
WHERE XCPL.COMPANY_NR > 0
AND XCPL.STATUS_UID IN (109053, 119170)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (
	SELECT start_date FROM date_range
)
--AND XCPL.EVT_DUE < (
--	SELECT end_date FROM date_range
--)
--ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, Error Msg = ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

!STACK 0
Error : 923, Position : 360, Sql = with date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 100, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
	uc_cp_cat.text case_reason
	uc_status.TEXT status
--	XCPL.COMPLAINT_NO,
--	XCPL.EVT_ISSUED,
--	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
--	XCPL.COMPANY_NR,
--	XCPL.CONTRACT_NR,
--	XCPL.INVOICE_NR,	
--	REPLACE(dbms_lob.substr(XCPL.SOLUTION_NOTES, 100, 1), ';', '') solution_notes,
--	XCPL.CREATE_CASE_NR,
--	(
--		SELECT CASE WHEN ICSA.STATUS_UID != 75959 THEN
--			0
--		ELSE 
--			XCPL.COMPLAINT_NR 
--		END 
--		FROM BSI_CASE ICSA
--		WHERE ICSA.CASE_NR = MCC.CASE_NR
--	) AS update_complaint_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uct ON UCT.UC_UID = CSE.STATUS_UID AND UCT.LANGUAGE_UID = 1303
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_UC_TEXT uc_status ON uc_status.UC_UID = XCPL.STATUS_UID AND uc_status.LANGUAGE_UID = 1303
	INNER JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.STATUS_UID AND uc_cp_cat.LANGUAGE_UID = 1303
WHERE XCPL.COMPANY_NR > 0
AND XCPL.STATUS_UID IN (109053, 119170)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (
	SELECT start_date FROM date_range
)
--AND XCPL.EVT_DUE < (
--	SELECT end_date FROM date_range
--)
--ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, OriginalSql = with date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 100, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
	uc_cp_cat.text case_reason
	uc_status.TEXT status
--	XCPL.COMPLAINT_NO,
--	XCPL.EVT_ISSUED,
--	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
--	XCPL.COMPANY_NR,
--	XCPL.CONTRACT_NR,
--	XCPL.INVOICE_NR,	
--	REPLACE(dbms_lob.substr(XCPL.SOLUTION_NOTES, 100, 1), ';', '') solution_notes,
--	XCPL.CREATE_CASE_NR,
--	(
--		SELECT CASE WHEN ICSA.STATUS_UID != 75959 THEN
--			0
--		ELSE 
--			XCPL.COMPLAINT_NR 
--		END 
--		FROM BSI_CASE ICSA
--		WHERE ICSA.CASE_NR = MCC.CASE_NR
--	) AS update_complaint_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uct ON UCT.UC_UID = CSE.STATUS_UID AND UCT.LANGUAGE_UID = 1303
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_UC_TEXT uc_status ON uc_status.UC_UID = XCPL.STATUS_UID AND uc_status.LANGUAGE_UID = 1303
	INNER JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.STATUS_UID AND uc_cp_cat.LANGUAGE_UID = 1303
WHERE XCPL.COMPANY_NR > 0
AND XCPL.STATUS_UID IN (109053, 119170)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (
	SELECT start_date FROM date_range
)
--AND XCPL.EVT_DUE < (
--	SELECT end_date FROM date_range
--)
--ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, Error Msg = ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 2 0 2019-10-31 08:25:35.663
!MESSAGE Can't read execution warnings
!SUBENTRY 1 org.jkiss.dbeaver.model 2 0 2019-10-31 08:25:35.663
!MESSAGE SQL-Fehler [17008] [08003]: Getrennte Verbindung
!SUBENTRY 2 org.jkiss.dbeaver.model 2 0 2019-10-31 08:25:35.663
!MESSAGE Getrennte Verbindung
!STACK 0
java.sql.SQLRecoverableException: Getrennte Verbindung
	at oracle.jdbc.driver.OracleStatement.ensureOpen(OracleStatement.java:4114)
	at oracle.jdbc.driver.OracleStatement.getWarnings(OracleStatement.java:3113)
	at oracle.jdbc.driver.OracleStatementWrapper.getWarnings(OracleStatementWrapper.java:348)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.getWarnings(JDBCStatementImpl.java:582)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.getStatementWarnings(JDBCStatementImpl.java:612)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:524)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 08:25:35.668
!MESSAGE Can't close statement
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 08:25:35.668
!MESSAGE Getrennte Verbindung
!STACK 0
java.sql.SQLRecoverableException: Getrennte Verbindung
	at oracle.jdbc.driver.PhysicalConnection.needLine(PhysicalConnection.java:3305)
	at oracle.jdbc.driver.OracleStatement.closeOrCache(OracleStatement.java:1409)
	at oracle.jdbc.driver.OracleStatement.close(OracleStatement.java:1392)
	at oracle.jdbc.driver.OracleStatementWrapper.close(OracleStatementWrapper.java:119)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.close(JDBCStatementImpl.java:512)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.closeStatement(SQLQueryJob.java:797)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:530)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 08:25:35.853
!MESSAGE Operation failed. Retry count remains = 1
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 08:25:35.853
!MESSAGE SQL-Fehler [17002] [08006]: I/O-Fehler: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!SUBENTRY 2 org.jkiss.dbeaver.model 4 0 2019-10-31 08:25:35.853
!MESSAGE I/O-Fehler: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!STACK 0
java.sql.SQLRecoverableException: I/O-Fehler: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:738)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.doScrollExecuteCommon(OracleStatement.java:4699)
	at oracle.jdbc.driver.OracleStatement.doScrollStmtExecuteQuery(OracleStatement.java:4815)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1758)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)
Caused by: java.io.IOException: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
	at java.base/sun.nio.ch.SocketDispatcher.read0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:43)
	at java.base/sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:276)
	at java.base/sun.nio.ch.IOUtil.read(IOUtil.java:245)
	at java.base/sun.nio.ch.IOUtil.read(IOUtil.java:223)
	at java.base/sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:355)
	at oracle.net.nt.TimeoutSocketChannel.read(TimeoutSocketChannel.java:178)
	at oracle.net.ns.NSProtocolNIO.doSocketRead(NSProtocolNIO.java:544)
	at oracle.net.ns.NIOPacket.readHeader(NIOPacket.java:234)
	at oracle.net.ns.NIOPacket.readPacketFromSocketChannel(NIOPacket.java:174)
	at oracle.net.ns.NIOPacket.readFromSocketChannel(NIOPacket.java:122)
	at oracle.net.ns.NIOPacket.readFromSocketChannel(NIOPacket.java:100)
	at oracle.net.ns.NIONSDataChannel.readDataFromSocketChannel(NIONSDataChannel.java:86)
	at oracle.jdbc.driver.T4CMAREngineNIO.prepareForUnmarshall(T4CMAREngineNIO.java:762)
	at oracle.jdbc.driver.T4CMAREngineNIO.unmarshalUB1(T4CMAREngineNIO.java:427)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:394)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	... 20 more
!SUBENTRY 3 org.jkiss.dbeaver.model 4 0 2019-10-31 08:25:35.854
!MESSAGE Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!STACK 0
java.io.IOException: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
	at java.base/sun.nio.ch.SocketDispatcher.read0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:43)
	at java.base/sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:276)
	at java.base/sun.nio.ch.IOUtil.read(IOUtil.java:245)
	at java.base/sun.nio.ch.IOUtil.read(IOUtil.java:223)
	at java.base/sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:355)
	at oracle.net.nt.TimeoutSocketChannel.read(TimeoutSocketChannel.java:178)
	at oracle.net.ns.NSProtocolNIO.doSocketRead(NSProtocolNIO.java:544)
	at oracle.net.ns.NIOPacket.readHeader(NIOPacket.java:234)
	at oracle.net.ns.NIOPacket.readPacketFromSocketChannel(NIOPacket.java:174)
	at oracle.net.ns.NIOPacket.readFromSocketChannel(NIOPacket.java:122)
	at oracle.net.ns.NIOPacket.readFromSocketChannel(NIOPacket.java:100)
	at oracle.net.ns.NIONSDataChannel.readDataFromSocketChannel(NIONSDataChannel.java:86)
	at oracle.jdbc.driver.T4CMAREngineNIO.prepareForUnmarshall(T4CMAREngineNIO.java:762)
	at oracle.jdbc.driver.T4CMAREngineNIO.unmarshalUB1(T4CMAREngineNIO.java:427)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:394)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.doScrollExecuteCommon(OracleStatement.java:4699)
	at oracle.jdbc.driver.OracleStatement.doScrollStmtExecuteQuery(OracleStatement.java:4815)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1758)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 08:35:03.346
!MESSAGE SQL-Fehler [937] [42000]: ORA-00937: keine Gruppenfunktion für Einzelgruppe

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 08:35:03.346
!MESSAGE Error : 937, Position : 17, Sql = select count (*),status_uid from bsicrm.bsi_x_complaint
where status_uid in
('109053','119170')
and company_nr is not null
and evt_issued > '31.12.14'
, OriginalSql = select count (*),status_uid from bsicrm.bsi_x_complaint
where status_uid in
('109053','119170')
and company_nr is not null
and evt_issued > '31.12.14'
, Error Msg = ORA-00937: keine Gruppenfunktion für Einzelgruppe

!STACK 0
Error : 937, Position : 17, Sql = select count (*),status_uid from bsicrm.bsi_x_complaint
where status_uid in
('109053','119170')
and company_nr is not null
and evt_issued > '31.12.14'
, OriginalSql = select count (*),status_uid from bsicrm.bsi_x_complaint
where status_uid in
('109053','119170')
and company_nr is not null
and evt_issued > '31.12.14'
, Error Msg = ORA-00937: keine Gruppenfunktion für Einzelgruppe

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.doScrollExecuteCommon(OracleStatement.java:4699)
	at oracle.jdbc.driver.OracleStatement.doScrollStmtExecuteQuery(OracleStatement.java:4815)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1758)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 08:40:52.637
!MESSAGE SQL-Fehler [923] [42000]: ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 08:40:52.637
!MESSAGE Error : 923, Position : 627, Sql = WITH date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
--	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
--	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
--		INNER JOIN BSI_CASE CSE ON CSE.CASE_NR = MCC.CASE_NR AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
--	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR > 0
AND XCPL.COMPANY_NR IS NOT NULL
AND XCPL.STATUS_UID IN (119170, 109053)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (SELECT start_date FROM date_range)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, OriginalSql = WITH date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
--	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
--	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
--		INNER JOIN BSI_CASE CSE ON CSE.CASE_NR = MCC.CASE_NR AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
--	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR > 0
AND XCPL.COMPANY_NR IS NOT NULL
AND XCPL.STATUS_UID IN (119170, 109053)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (SELECT start_date FROM date_range)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, Error Msg = ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

!STACK 0
Error : 923, Position : 627, Sql = WITH date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
--	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
--	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
--		INNER JOIN BSI_CASE CSE ON CSE.CASE_NR = MCC.CASE_NR AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
--	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR > 0
AND XCPL.COMPANY_NR IS NOT NULL
AND XCPL.STATUS_UID IN (119170, 109053)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (SELECT start_date FROM date_range)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, OriginalSql = WITH date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
--	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
--	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
--		INNER JOIN BSI_CASE CSE ON CSE.CASE_NR = MCC.CASE_NR AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
--	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR > 0
AND XCPL.COMPANY_NR IS NOT NULL
AND XCPL.STATUS_UID IN (119170, 109053)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (SELECT start_date FROM date_range)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, Error Msg = ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 08:41:10.831
!MESSAGE SQL-Fehler [923] [42000]: ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 08:41:10.832
!MESSAGE Error : 923, Position : 627, Sql = WITH date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
--	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
--	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
--		INNER JOIN BSI_CASE CSE ON CSE.CASE_NR = MCC.CASE_NR AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
--	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR > 0
AND XCPL.COMPANY_NR IS NOT NULL
AND XCPL.STATUS_UID IN (119170, 109053)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (SELECT start_date FROM date_range)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, OriginalSql = WITH date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
--	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
--	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
--		INNER JOIN BSI_CASE CSE ON CSE.CASE_NR = MCC.CASE_NR AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
--	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR > 0
AND XCPL.COMPANY_NR IS NOT NULL
AND XCPL.STATUS_UID IN (119170, 109053)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (SELECT start_date FROM date_range)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, Error Msg = ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

!STACK 0
Error : 923, Position : 627, Sql = WITH date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
--	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
--	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
--		INNER JOIN BSI_CASE CSE ON CSE.CASE_NR = MCC.CASE_NR AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
--	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR > 0
AND XCPL.COMPANY_NR IS NOT NULL
AND XCPL.STATUS_UID IN (119170, 109053)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (SELECT start_date FROM date_range)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, OriginalSql = WITH date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
--	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
--	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
--		INNER JOIN BSI_CASE CSE ON CSE.CASE_NR = MCC.CASE_NR AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
--	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR > 0
AND XCPL.COMPANY_NR IS NOT NULL
AND XCPL.STATUS_UID IN (119170, 109053)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (SELECT start_date FROM date_range)
ORDER BY XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, Error Msg = ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 08:43:47.319
!MESSAGE SQL-Fehler [1791] [42000]: ORA-01791: Kein mit SELECT ausgewählter Ausdruck

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 08:43:47.319
!MESSAGE Error : 1791, Position : 1516, Sql = WITH date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
--	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
--		INNER JOIN BSI_CASE CSE ON CSE.CASE_NR = MCC.CASE_NR AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR > 0
AND XCPL.COMPANY_NR IS NOT NULL
AND XCPL.STATUS_UID IN (119170, 109053)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (SELECT start_date FROM date_range)
ORDER BY XCPL.EVT_ISSUED, XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, OriginalSql = WITH date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
--	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
--		INNER JOIN BSI_CASE CSE ON CSE.CASE_NR = MCC.CASE_NR AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR > 0
AND XCPL.COMPANY_NR IS NOT NULL
AND XCPL.STATUS_UID IN (119170, 109053)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (SELECT start_date FROM date_range)
ORDER BY XCPL.EVT_ISSUED, XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, Error Msg = ORA-01791: Kein mit SELECT ausgewählter Ausdruck

!STACK 0
Error : 1791, Position : 1516, Sql = WITH date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
--	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
--		INNER JOIN BSI_CASE CSE ON CSE.CASE_NR = MCC.CASE_NR AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR > 0
AND XCPL.COMPANY_NR IS NOT NULL
AND XCPL.STATUS_UID IN (119170, 109053)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (SELECT start_date FROM date_range)
ORDER BY XCPL.EVT_ISSUED, XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, OriginalSql = WITH date_range as (
	select to_date('31.12.2014', 'dd.mm.yyyy') start_date, to_date('01.10.2019', 'dd.mm.yyyy') end_date from dual
)
SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
--	INNER JOIN BSI_X_CASE_COMPLAINT mcc 
--		INNER JOIN BSI_CASE CSE ON CSE.CASE_NR = MCC.CASE_NR AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR > 0
AND XCPL.COMPANY_NR IS NOT NULL
AND XCPL.STATUS_UID IN (119170, 109053)
--109053	Abgeschlossen
--119170	Abgeschlossen
--128898	Warten auf Rückmeldung
AND XCPL.EVT_ISSUED > (SELECT start_date FROM date_range)
ORDER BY XCPL.EVT_ISSUED, XCPL.COMPANY_NR, XCPL.COMPLAINT_NO
, Error Msg = ORA-01791: Kein mit SELECT ausgewählter Ausdruck

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.doScrollExecuteCommon(OracleStatement.java:4699)
	at oracle.jdbc.driver.OracleStatement.doScrollStmtExecuteQuery(OracleStatement.java:4815)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1758)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 08:50:33.964
!MESSAGE SQL-Fehler [904] [42000]: ORA-00904: "XCPL"."EVT_ISSUED": ungültiger Bezeichner

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 08:50:33.964
!MESSAGE Error : 904, Position : 433, Sql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
--	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM
from bsicrm.bsi_x_complaint
where status_uid in
('109053','119170')
and company_nr is not null
and TO_DATE(evt_issued, 'dd.mm.yyyy') > to_date('31.12.14', 'dd.mm.yyyy')
, OriginalSql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
--	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM
from bsicrm.bsi_x_complaint
where status_uid in
('109053','119170')
and company_nr is not null
and TO_DATE(evt_issued, 'dd.mm.yyyy') > to_date('31.12.14', 'dd.mm.yyyy')
, Error Msg = ORA-00904: "XCPL"."EVT_ISSUED": ungültiger Bezeichner

!STACK 0
Error : 904, Position : 433, Sql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
--	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM
from bsicrm.bsi_x_complaint
where status_uid in
('109053','119170')
and company_nr is not null
and TO_DATE(evt_issued, 'dd.mm.yyyy') > to_date('31.12.14', 'dd.mm.yyyy')
, OriginalSql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
--	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM
from bsicrm.bsi_x_complaint
where status_uid in
('109053','119170')
and company_nr is not null
and TO_DATE(evt_issued, 'dd.mm.yyyy') > to_date('31.12.14', 'dd.mm.yyyy')
, Error Msg = ORA-00904: "XCPL"."EVT_ISSUED": ungültiger Bezeichner

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.doScrollExecuteCommon(OracleStatement.java:4699)
	at oracle.jdbc.driver.OracleStatement.doScrollStmtExecuteQuery(OracleStatement.java:4815)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1758)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 13:41:40.450
!MESSAGE SQL-Fehler [904] [42000]: ORA-00904: "EC"."ADDRESS_NR": ungültiger Bezeichner

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 13:41:40.450
!MESSAGE Error : 904, Position : 11171, Sql = WITH exported_companies AS (
                SELECT /*+ ordered use_hash(ejj ej company a sspa sspba cp_join) full(ejj) full(ej) full(company) full(a) full(sspa) full(sspba) full(cp_join) */
                       company.x_complex_no,  -- leads
                       TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
                       company.language_uid,
                       ejj.join_nr,
                       ej.ext_join_nr,
                       ej.ext_join_type_uid,
                       ej.interface_uid,
--                       sadr.fone,
--                       sadr.handy,
--                       sadr.fax,
--                       sadr.email,
--                       sadr.www,
--                       kam.kamtyp,
--                       sspa.address_nr address_nr,
--                       sspba.address_nr pobox_address_nr,
--                       company.y_legal_status_uid,           
--                       company.x_is_locked,
--                       company.x_advisory_status_uid,
--                       dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx,
                       collection.join_nr coll_join_nr,
                       cp_join.person_nr,
                       kuba_data.kuba_join_nr,
                      COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
                      CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
                      		'Email'
                      WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
                      		'Letter'
                      WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
                             'n.a.'
                      END Communication_Channel__c

                FROM   bsicrm.bsi_x_ext_join_join ejj
                JOIN   bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
                LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
                JOIN   bsicrm.bsi_company company ON company.company_nr = ejj.join_nr and company.is_active = 1
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ejj2 ej2) full(ejj2) full(ej2) */
                                        MIN(ej2.kam_uid) kamtyp, ejj2.join_nr innerjnr
                                   FROM bsicrm.bsi_x_ext_join ej2
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                    
                                  WHERE ej2.kam_uid != 0
                                  GROUP BY ejj2.join_nr) kam ON kam.innerjnr = ejj.join_nr  
                LEFT JOIN (SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
                                  adr.item_key0_nr,
                                  MAX(CASE WHEN adr.channel_uid = 113638 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fone,
                                  MAX(CASE WHEN adr.channel_uid = 113640 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) handy,
                                  MAX(CASE WHEN adr.channel_uid = 113639 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fax,
                                  MAX(CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
                                  MAX(CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
                             FROM bsicrm.bsi_address adr
                                  JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
                                  JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr AND ej2.ACTIVE = 1
                            WHERE adr.is_default_address = 1
                              AND adr.item_type_id = 318594
                            GROUP BY adr.item_key0_nr) sadr
				ON sadr.item_key0_nr = company.company_nr
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa
                       ON  sspa.ext_join_nr = ejj.ext_join_nr
                       AND sspa.join_type_uid = 318594
                       AND sspa.type_uid = 2315 /* Hauptadresse */
                       AND sspa.channel_uid = 113688
                       AND sspa.join_nr = ejj.join_nr  
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba
                       ON  sspba.ext_join_nr = ejj.ext_join_nr
                       AND sspba.join_type_uid = 318594
                       AND sspba.type_uid = 108240 /* Postfach */
                       AND sspba.channel_uid = 113688
                       AND sspba.join_nr = ejj.join_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(cp_join P cpr) full(cp_join) full(P) full(cpr) */
                                        cp_join.company_nr, MAX(cp_join.person_nr) person_nr
                                   FROM bsicrm.bsi_company_person cp_join
                                        JOIN bsicrm.bsi_person P ON P.person_nr = cp_join.person_nr AND P.is_active = 1
                                        JOIN bsicrm.bsi_uc_company_person_role cpr ON cpr.company_person_role_uid = cp_join.role_uid AND cpr.is_use_for_display_name = 1
                                  GROUP BY cp_join.company_nr) cp_join ON cp_join.company_nr = company.company_nr 
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
                                        max(kd.join_nr) kuba_join_nr, ejj2.join_nr             
                                   FROM bsicrm.bsi_x_ext_kuba_data kd
                                        JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr  AND  ej2.ext_join_type_uid = kd.join_type_uid AND ej2.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
                                  WHERE kd.status_uid = 4800511372 --aktiv  
                                  GROUP BY ejj2.join_nr) KUBA_DATA ON kuba_data.join_nr = company.company_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
                                        ejj2.join_nr, RTRIM(XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
                                   FROM bsicrm.bsi_x_ext_join ej2
                                   JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ej2.ACTIVE = 1
                                  WHERE ej2.active = 1
                                    AND ejj2.ext_join_type_uid = 108224
                                    AND ej2.interface_uid = 108205
                                  GROUP BY ejj2.join_nr) comp_nx ON comp_nx.join_nr = company.company_nr      
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
                                        DISTINCT ejjinner.join_nr
                                   FROM bsicrm.bsi_x_collection coll 
                                        JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr AND ejinner.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
                                  WHERE coll.status_uid <> 137824) collection ON collection.join_nr = company.company_nr    
                WHERE  ejj.is_master = 1
                AND    ejj.ext_join_type_uid = 108224
                AND    ej.active = 1
                AND    ej.interface_uid  = 108205 --nx   
                AND company.company_nr NOT IN (SELECT cc.company_nr     --nicht = Konzern, Unternehmen, Filiale 
                                                 FROM bsicrm.bsi_company_company cc
                                               UNION  
                                               SELECT cc.group_company_nr
                                                 FROM bsicrm.bsi_company_company cc) 
               AND ejj.join_nr NOT IN (SELECT /*+ ordered use_hash(prod ejj2) full(prod) full(ejj2) */
                                               DISTINCT ejj2.join_nr 
                                          FROM bsicrm.bsi_x_ext_product prod 
                                          JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = prod.join_nr
                                         WHERE prod.status_uid = 109307 --aktuell
                                           AND prod.type_uid IN (1000408,1000409,1923083777,1923083778,1923083779,5684031909,6077978250,6077978180,6077978542,6077978285,1000415,1000419,1923083780,1923083781,1923083782,1923083783,1923083784,1923083785,5684031938,5684031911,6077978344,6599798156,6077978035,6599798005,6077978528,6599797809,6077978220,6599797644,1000427,1000428,1000429,1000623)
                                       )), --hat KEIN aktuelles Eintragsprodukt     
                dunning AS (select /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
                                   distinct ejj.join_nr -- company.x_complex_no            
                              FROM bsicrm.bsi_x_ext_receipt xrcp
                                   JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr  AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
                                   JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid
                             WHERE xrcp.overdue_level_uid IN (137663,137664,137665)         
                           )    
            SELECT /*+ ordered use_hash(kuba d legaladdr cy ap cyp pers tkam tlf tnc tne) full(kuba) full(d) full(legaladdr) full(cy) full(ap) full(cyp) full(pers) full(tkam) full(tlf) full(tnc) full(tne) */
                   DISTINCT ec.x_complex_no uk_lcm_x_complex_no__c,
                   ec.person_nr uk_LCM_PERSON_NR__c,       
                   ec.join_nos_nx LCM_NX_MergeIDs__c,   

                   DECODE(ec.language_uid, 246, 'German', 1303, 'English', 7770, 'French', 7771, 'Italian', '?') PreferedLanguage__c,       
                   CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
--                        WHEN dnng.join_nr IS NOT NULL THEN 'C'
						WHEN ec.x_is_locked = 1 THEN 'C'
                        ELSE NULL           
                        END clientrating__c,  

					EC.Communication_Channel__c
            FROM   exported_companies ec
            LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
            LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr     -- dnng.x_complex_no = C.x_complex_no
            LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
            LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
            LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
            LEFT JOIN bsicrm.bsi_city cyp on cyp.city_nr = ap.city_nr
            LEFT JOIN bsicrm.bsi_person pers on pers.person_nr = ec.person_nr
            LEFT JOIN bsicrm.bsi_uc_text tkam on tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tlf on tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tnc on tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tne on tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, OriginalSql = WITH exported_companies AS (
                SELECT /*+ ordered use_hash(ejj ej company a sspa sspba cp_join) full(ejj) full(ej) full(company) full(a) full(sspa) full(sspba) full(cp_join) */
                       company.x_complex_no,  -- leads
                       TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
                       company.language_uid,
                       ejj.join_nr,
                       ej.ext_join_nr,
                       ej.ext_join_type_uid,
                       ej.interface_uid,
--                       sadr.fone,
--                       sadr.handy,
--                       sadr.fax,
--                       sadr.email,
--                       sadr.www,
--                       kam.kamtyp,
--                       sspa.address_nr address_nr,
--                       sspba.address_nr pobox_address_nr,
--                       company.y_legal_status_uid,           
--                       company.x_is_locked,
--                       company.x_advisory_status_uid,
--                       dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx,
                       collection.join_nr coll_join_nr,
                       cp_join.person_nr,
                       kuba_data.kuba_join_nr,
                      COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
                      CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
                      		'Email'
                      WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
                      		'Letter'
                      WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
                             'n.a.'
                      END Communication_Channel__c

                FROM   bsicrm.bsi_x_ext_join_join ejj
                JOIN   bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
                LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
                JOIN   bsicrm.bsi_company company ON company.company_nr = ejj.join_nr and company.is_active = 1
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ejj2 ej2) full(ejj2) full(ej2) */
                                        MIN(ej2.kam_uid) kamtyp, ejj2.join_nr innerjnr
                                   FROM bsicrm.bsi_x_ext_join ej2
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                    
                                  WHERE ej2.kam_uid != 0
                                  GROUP BY ejj2.join_nr) kam ON kam.innerjnr = ejj.join_nr  
                LEFT JOIN (SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
                                  adr.item_key0_nr,
                                  MAX(CASE WHEN adr.channel_uid = 113638 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fone,
                                  MAX(CASE WHEN adr.channel_uid = 113640 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) handy,
                                  MAX(CASE WHEN adr.channel_uid = 113639 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fax,
                                  MAX(CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
                                  MAX(CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
                             FROM bsicrm.bsi_address adr
                                  JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
                                  JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr AND ej2.ACTIVE = 1
                            WHERE adr.is_default_address = 1
                              AND adr.item_type_id = 318594
                            GROUP BY adr.item_key0_nr) sadr
				ON sadr.item_key0_nr = company.company_nr
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa
                       ON  sspa.ext_join_nr = ejj.ext_join_nr
                       AND sspa.join_type_uid = 318594
                       AND sspa.type_uid = 2315 /* Hauptadresse */
                       AND sspa.channel_uid = 113688
                       AND sspa.join_nr = ejj.join_nr  
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba
                       ON  sspba.ext_join_nr = ejj.ext_join_nr
                       AND sspba.join_type_uid = 318594
                       AND sspba.type_uid = 108240 /* Postfach */
                       AND sspba.channel_uid = 113688
                       AND sspba.join_nr = ejj.join_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(cp_join P cpr) full(cp_join) full(P) full(cpr) */
                                        cp_join.company_nr, MAX(cp_join.person_nr) person_nr
                                   FROM bsicrm.bsi_company_person cp_join
                                        JOIN bsicrm.bsi_person P ON P.person_nr = cp_join.person_nr AND P.is_active = 1
                                        JOIN bsicrm.bsi_uc_company_person_role cpr ON cpr.company_person_role_uid = cp_join.role_uid AND cpr.is_use_for_display_name = 1
                                  GROUP BY cp_join.company_nr) cp_join ON cp_join.company_nr = company.company_nr 
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
                                        max(kd.join_nr) kuba_join_nr, ejj2.join_nr             
                                   FROM bsicrm.bsi_x_ext_kuba_data kd
                                        JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr  AND  ej2.ext_join_type_uid = kd.join_type_uid AND ej2.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
                                  WHERE kd.status_uid = 4800511372 --aktiv  
                                  GROUP BY ejj2.join_nr) KUBA_DATA ON kuba_data.join_nr = company.company_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
                                        ejj2.join_nr, RTRIM(XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
                                   FROM bsicrm.bsi_x_ext_join ej2
                                   JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ej2.ACTIVE = 1
                                  WHERE ej2.active = 1
                                    AND ejj2.ext_join_type_uid = 108224
                                    AND ej2.interface_uid = 108205
                                  GROUP BY ejj2.join_nr) comp_nx ON comp_nx.join_nr = company.company_nr      
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
                                        DISTINCT ejjinner.join_nr
                                   FROM bsicrm.bsi_x_collection coll 
                                        JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr AND ejinner.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
                                  WHERE coll.status_uid <> 137824) collection ON collection.join_nr = company.company_nr    
                WHERE  ejj.is_master = 1
                AND    ejj.ext_join_type_uid = 108224
                AND    ej.active = 1
                AND    ej.interface_uid  = 108205 --nx   
                AND company.company_nr NOT IN (SELECT cc.company_nr     --nicht = Konzern, Unternehmen, Filiale 
                                                 FROM bsicrm.bsi_company_company cc
                                               UNION  
                                               SELECT cc.group_company_nr
                                                 FROM bsicrm.bsi_company_company cc) 
               AND ejj.join_nr NOT IN (SELECT /*+ ordered use_hash(prod ejj2) full(prod) full(ejj2) */
                                               DISTINCT ejj2.join_nr 
                                          FROM bsicrm.bsi_x_ext_product prod 
                                          JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = prod.join_nr
                                         WHERE prod.status_uid = 109307 --aktuell
                                           AND prod.type_uid IN (1000408,1000409,1923083777,1923083778,1923083779,5684031909,6077978250,6077978180,6077978542,6077978285,1000415,1000419,1923083780,1923083781,1923083782,1923083783,1923083784,1923083785,5684031938,5684031911,6077978344,6599798156,6077978035,6599798005,6077978528,6599797809,6077978220,6599797644,1000427,1000428,1000429,1000623)
                                       )), --hat KEIN aktuelles Eintragsprodukt     
                dunning AS (select /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
                                   distinct ejj.join_nr -- company.x_complex_no            
                              FROM bsicrm.bsi_x_ext_receipt xrcp
                                   JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr  AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
                                   JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid
                             WHERE xrcp.overdue_level_uid IN (137663,137664,137665)         
                           )    
            SELECT /*+ ordered use_hash(kuba d legaladdr cy ap cyp pers tkam tlf tnc tne) full(kuba) full(d) full(legaladdr) full(cy) full(ap) full(cyp) full(pers) full(tkam) full(tlf) full(tnc) full(tne) */
                   DISTINCT ec.x_complex_no uk_lcm_x_complex_no__c,
                   ec.person_nr uk_LCM_PERSON_NR__c,       
                   ec.join_nos_nx LCM_NX_MergeIDs__c,   

                   DECODE(ec.language_uid, 246, 'German', 1303, 'English', 7770, 'French', 7771, 'Italian', '?') PreferedLanguage__c,       
                   CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
--                        WHEN dnng.join_nr IS NOT NULL THEN 'C'
						WHEN ec.x_is_locked = 1 THEN 'C'
                        ELSE NULL           
                        END clientrating__c,  

					EC.Communication_Channel__c
            FROM   exported_companies ec
            LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
            LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr     -- dnng.x_complex_no = C.x_complex_no
            LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
            LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
            LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
            LEFT JOIN bsicrm.bsi_city cyp on cyp.city_nr = ap.city_nr
            LEFT JOIN bsicrm.bsi_person pers on pers.person_nr = ec.person_nr
            LEFT JOIN bsicrm.bsi_uc_text tkam on tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tlf on tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tnc on tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tne on tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, Error Msg = ORA-00904: "EC"."ADDRESS_NR": ungültiger Bezeichner

!STACK 0
Error : 904, Position : 11171, Sql = WITH exported_companies AS (
                SELECT /*+ ordered use_hash(ejj ej company a sspa sspba cp_join) full(ejj) full(ej) full(company) full(a) full(sspa) full(sspba) full(cp_join) */
                       company.x_complex_no,  -- leads
                       TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
                       company.language_uid,
                       ejj.join_nr,
                       ej.ext_join_nr,
                       ej.ext_join_type_uid,
                       ej.interface_uid,
--                       sadr.fone,
--                       sadr.handy,
--                       sadr.fax,
--                       sadr.email,
--                       sadr.www,
--                       kam.kamtyp,
--                       sspa.address_nr address_nr,
--                       sspba.address_nr pobox_address_nr,
--                       company.y_legal_status_uid,           
--                       company.x_is_locked,
--                       company.x_advisory_status_uid,
--                       dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx,
                       collection.join_nr coll_join_nr,
                       cp_join.person_nr,
                       kuba_data.kuba_join_nr,
                      COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
                      CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
                      		'Email'
                      WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
                      		'Letter'
                      WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
                             'n.a.'
                      END Communication_Channel__c

                FROM   bsicrm.bsi_x_ext_join_join ejj
                JOIN   bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
                LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
                JOIN   bsicrm.bsi_company company ON company.company_nr = ejj.join_nr and company.is_active = 1
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ejj2 ej2) full(ejj2) full(ej2) */
                                        MIN(ej2.kam_uid) kamtyp, ejj2.join_nr innerjnr
                                   FROM bsicrm.bsi_x_ext_join ej2
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                    
                                  WHERE ej2.kam_uid != 0
                                  GROUP BY ejj2.join_nr) kam ON kam.innerjnr = ejj.join_nr  
                LEFT JOIN (SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
                                  adr.item_key0_nr,
                                  MAX(CASE WHEN adr.channel_uid = 113638 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fone,
                                  MAX(CASE WHEN adr.channel_uid = 113640 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) handy,
                                  MAX(CASE WHEN adr.channel_uid = 113639 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fax,
                                  MAX(CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
                                  MAX(CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
                             FROM bsicrm.bsi_address adr
                                  JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
                                  JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr AND ej2.ACTIVE = 1
                            WHERE adr.is_default_address = 1
                              AND adr.item_type_id = 318594
                            GROUP BY adr.item_key0_nr) sadr
				ON sadr.item_key0_nr = company.company_nr
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa
                       ON  sspa.ext_join_nr = ejj.ext_join_nr
                       AND sspa.join_type_uid = 318594
                       AND sspa.type_uid = 2315 /* Hauptadresse */
                       AND sspa.channel_uid = 113688
                       AND sspa.join_nr = ejj.join_nr  
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba
                       ON  sspba.ext_join_nr = ejj.ext_join_nr
                       AND sspba.join_type_uid = 318594
                       AND sspba.type_uid = 108240 /* Postfach */
                       AND sspba.channel_uid = 113688
                       AND sspba.join_nr = ejj.join_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(cp_join P cpr) full(cp_join) full(P) full(cpr) */
                                        cp_join.company_nr, MAX(cp_join.person_nr) person_nr
                                   FROM bsicrm.bsi_company_person cp_join
                                        JOIN bsicrm.bsi_person P ON P.person_nr = cp_join.person_nr AND P.is_active = 1
                                        JOIN bsicrm.bsi_uc_company_person_role cpr ON cpr.company_person_role_uid = cp_join.role_uid AND cpr.is_use_for_display_name = 1
                                  GROUP BY cp_join.company_nr) cp_join ON cp_join.company_nr = company.company_nr 
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
                                        max(kd.join_nr) kuba_join_nr, ejj2.join_nr             
                                   FROM bsicrm.bsi_x_ext_kuba_data kd
                                        JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr  AND  ej2.ext_join_type_uid = kd.join_type_uid AND ej2.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
                                  WHERE kd.status_uid = 4800511372 --aktiv  
                                  GROUP BY ejj2.join_nr) KUBA_DATA ON kuba_data.join_nr = company.company_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
                                        ejj2.join_nr, RTRIM(XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
                                   FROM bsicrm.bsi_x_ext_join ej2
                                   JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ej2.ACTIVE = 1
                                  WHERE ej2.active = 1
                                    AND ejj2.ext_join_type_uid = 108224
                                    AND ej2.interface_uid = 108205
                                  GROUP BY ejj2.join_nr) comp_nx ON comp_nx.join_nr = company.company_nr      
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
                                        DISTINCT ejjinner.join_nr
                                   FROM bsicrm.bsi_x_collection coll 
                                        JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr AND ejinner.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
                                  WHERE coll.status_uid <> 137824) collection ON collection.join_nr = company.company_nr    
                WHERE  ejj.is_master = 1
                AND    ejj.ext_join_type_uid = 108224
                AND    ej.active = 1
                AND    ej.interface_uid  = 108205 --nx   
                AND company.company_nr NOT IN (SELECT cc.company_nr     --nicht = Konzern, Unternehmen, Filiale 
                                                 FROM bsicrm.bsi_company_company cc
                                               UNION  
                                               SELECT cc.group_company_nr
                                                 FROM bsicrm.bsi_company_company cc) 
               AND ejj.join_nr NOT IN (SELECT /*+ ordered use_hash(prod ejj2) full(prod) full(ejj2) */
                                               DISTINCT ejj2.join_nr 
                                          FROM bsicrm.bsi_x_ext_product prod 
                                          JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = prod.join_nr
                                         WHERE prod.status_uid = 109307 --aktuell
                                           AND prod.type_uid IN (1000408,1000409,1923083777,1923083778,1923083779,5684031909,6077978250,6077978180,6077978542,6077978285,1000415,1000419,1923083780,1923083781,1923083782,1923083783,1923083784,1923083785,5684031938,5684031911,6077978344,6599798156,6077978035,6599798005,6077978528,6599797809,6077978220,6599797644,1000427,1000428,1000429,1000623)
                                       )), --hat KEIN aktuelles Eintragsprodukt     
                dunning AS (select /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
                                   distinct ejj.join_nr -- company.x_complex_no            
                              FROM bsicrm.bsi_x_ext_receipt xrcp
                                   JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr  AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
                                   JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid
                             WHERE xrcp.overdue_level_uid IN (137663,137664,137665)         
                           )    
            SELECT /*+ ordered use_hash(kuba d legaladdr cy ap cyp pers tkam tlf tnc tne) full(kuba) full(d) full(legaladdr) full(cy) full(ap) full(cyp) full(pers) full(tkam) full(tlf) full(tnc) full(tne) */
                   DISTINCT ec.x_complex_no uk_lcm_x_complex_no__c,
                   ec.person_nr uk_LCM_PERSON_NR__c,       
                   ec.join_nos_nx LCM_NX_MergeIDs__c,   

                   DECODE(ec.language_uid, 246, 'German', 1303, 'English', 7770, 'French', 7771, 'Italian', '?') PreferedLanguage__c,       
                   CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
--                        WHEN dnng.join_nr IS NOT NULL THEN 'C'
						WHEN ec.x_is_locked = 1 THEN 'C'
                        ELSE NULL           
                        END clientrating__c,  

					EC.Communication_Channel__c
            FROM   exported_companies ec
            LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
            LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr     -- dnng.x_complex_no = C.x_complex_no
            LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
            LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
            LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
            LEFT JOIN bsicrm.bsi_city cyp on cyp.city_nr = ap.city_nr
            LEFT JOIN bsicrm.bsi_person pers on pers.person_nr = ec.person_nr
            LEFT JOIN bsicrm.bsi_uc_text tkam on tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tlf on tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tnc on tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tne on tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, OriginalSql = WITH exported_companies AS (
                SELECT /*+ ordered use_hash(ejj ej company a sspa sspba cp_join) full(ejj) full(ej) full(company) full(a) full(sspa) full(sspba) full(cp_join) */
                       company.x_complex_no,  -- leads
                       TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
                       company.language_uid,
                       ejj.join_nr,
                       ej.ext_join_nr,
                       ej.ext_join_type_uid,
                       ej.interface_uid,
--                       sadr.fone,
--                       sadr.handy,
--                       sadr.fax,
--                       sadr.email,
--                       sadr.www,
--                       kam.kamtyp,
--                       sspa.address_nr address_nr,
--                       sspba.address_nr pobox_address_nr,
--                       company.y_legal_status_uid,           
--                       company.x_is_locked,
--                       company.x_advisory_status_uid,
--                       dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx,
                       collection.join_nr coll_join_nr,
                       cp_join.person_nr,
                       kuba_data.kuba_join_nr,
                      COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
                      CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
                      		'Email'
                      WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
                      		'Letter'
                      WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
                             'n.a.'
                      END Communication_Channel__c

                FROM   bsicrm.bsi_x_ext_join_join ejj
                JOIN   bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
                LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
                JOIN   bsicrm.bsi_company company ON company.company_nr = ejj.join_nr and company.is_active = 1
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ejj2 ej2) full(ejj2) full(ej2) */
                                        MIN(ej2.kam_uid) kamtyp, ejj2.join_nr innerjnr
                                   FROM bsicrm.bsi_x_ext_join ej2
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                    
                                  WHERE ej2.kam_uid != 0
                                  GROUP BY ejj2.join_nr) kam ON kam.innerjnr = ejj.join_nr  
                LEFT JOIN (SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
                                  adr.item_key0_nr,
                                  MAX(CASE WHEN adr.channel_uid = 113638 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fone,
                                  MAX(CASE WHEN adr.channel_uid = 113640 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) handy,
                                  MAX(CASE WHEN adr.channel_uid = 113639 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fax,
                                  MAX(CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
                                  MAX(CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
                             FROM bsicrm.bsi_address adr
                                  JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
                                  JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr AND ej2.ACTIVE = 1
                            WHERE adr.is_default_address = 1
                              AND adr.item_type_id = 318594
                            GROUP BY adr.item_key0_nr) sadr
				ON sadr.item_key0_nr = company.company_nr
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa
                       ON  sspa.ext_join_nr = ejj.ext_join_nr
                       AND sspa.join_type_uid = 318594
                       AND sspa.type_uid = 2315 /* Hauptadresse */
                       AND sspa.channel_uid = 113688
                       AND sspa.join_nr = ejj.join_nr  
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba
                       ON  sspba.ext_join_nr = ejj.ext_join_nr
                       AND sspba.join_type_uid = 318594
                       AND sspba.type_uid = 108240 /* Postfach */
                       AND sspba.channel_uid = 113688
                       AND sspba.join_nr = ejj.join_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(cp_join P cpr) full(cp_join) full(P) full(cpr) */
                                        cp_join.company_nr, MAX(cp_join.person_nr) person_nr
                                   FROM bsicrm.bsi_company_person cp_join
                                        JOIN bsicrm.bsi_person P ON P.person_nr = cp_join.person_nr AND P.is_active = 1
                                        JOIN bsicrm.bsi_uc_company_person_role cpr ON cpr.company_person_role_uid = cp_join.role_uid AND cpr.is_use_for_display_name = 1
                                  GROUP BY cp_join.company_nr) cp_join ON cp_join.company_nr = company.company_nr 
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
                                        max(kd.join_nr) kuba_join_nr, ejj2.join_nr             
                                   FROM bsicrm.bsi_x_ext_kuba_data kd
                                        JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr  AND  ej2.ext_join_type_uid = kd.join_type_uid AND ej2.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
                                  WHERE kd.status_uid = 4800511372 --aktiv  
                                  GROUP BY ejj2.join_nr) KUBA_DATA ON kuba_data.join_nr = company.company_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
                                        ejj2.join_nr, RTRIM(XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
                                   FROM bsicrm.bsi_x_ext_join ej2
                                   JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ej2.ACTIVE = 1
                                  WHERE ej2.active = 1
                                    AND ejj2.ext_join_type_uid = 108224
                                    AND ej2.interface_uid = 108205
                                  GROUP BY ejj2.join_nr) comp_nx ON comp_nx.join_nr = company.company_nr      
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
                                        DISTINCT ejjinner.join_nr
                                   FROM bsicrm.bsi_x_collection coll 
                                        JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr AND ejinner.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
                                  WHERE coll.status_uid <> 137824) collection ON collection.join_nr = company.company_nr    
                WHERE  ejj.is_master = 1
                AND    ejj.ext_join_type_uid = 108224
                AND    ej.active = 1
                AND    ej.interface_uid  = 108205 --nx   
                AND company.company_nr NOT IN (SELECT cc.company_nr     --nicht = Konzern, Unternehmen, Filiale 
                                                 FROM bsicrm.bsi_company_company cc
                                               UNION  
                                               SELECT cc.group_company_nr
                                                 FROM bsicrm.bsi_company_company cc) 
               AND ejj.join_nr NOT IN (SELECT /*+ ordered use_hash(prod ejj2) full(prod) full(ejj2) */
                                               DISTINCT ejj2.join_nr 
                                          FROM bsicrm.bsi_x_ext_product prod 
                                          JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = prod.join_nr
                                         WHERE prod.status_uid = 109307 --aktuell
                                           AND prod.type_uid IN (1000408,1000409,1923083777,1923083778,1923083779,5684031909,6077978250,6077978180,6077978542,6077978285,1000415,1000419,1923083780,1923083781,1923083782,1923083783,1923083784,1923083785,5684031938,5684031911,6077978344,6599798156,6077978035,6599798005,6077978528,6599797809,6077978220,6599797644,1000427,1000428,1000429,1000623)
                                       )), --hat KEIN aktuelles Eintragsprodukt     
                dunning AS (select /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
                                   distinct ejj.join_nr -- company.x_complex_no            
                              FROM bsicrm.bsi_x_ext_receipt xrcp
                                   JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr  AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
                                   JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid
                             WHERE xrcp.overdue_level_uid IN (137663,137664,137665)         
                           )    
            SELECT /*+ ordered use_hash(kuba d legaladdr cy ap cyp pers tkam tlf tnc tne) full(kuba) full(d) full(legaladdr) full(cy) full(ap) full(cyp) full(pers) full(tkam) full(tlf) full(tnc) full(tne) */
                   DISTINCT ec.x_complex_no uk_lcm_x_complex_no__c,
                   ec.person_nr uk_LCM_PERSON_NR__c,       
                   ec.join_nos_nx LCM_NX_MergeIDs__c,   

                   DECODE(ec.language_uid, 246, 'German', 1303, 'English', 7770, 'French', 7771, 'Italian', '?') PreferedLanguage__c,       
                   CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
--                        WHEN dnng.join_nr IS NOT NULL THEN 'C'
						WHEN ec.x_is_locked = 1 THEN 'C'
                        ELSE NULL           
                        END clientrating__c,  

					EC.Communication_Channel__c
            FROM   exported_companies ec
            LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
            LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr     -- dnng.x_complex_no = C.x_complex_no
            LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
            LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
            LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
            LEFT JOIN bsicrm.bsi_city cyp on cyp.city_nr = ap.city_nr
            LEFT JOIN bsicrm.bsi_person pers on pers.person_nr = ec.person_nr
            LEFT JOIN bsicrm.bsi_uc_text tkam on tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tlf on tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tnc on tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tne on tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, Error Msg = ORA-00904: "EC"."ADDRESS_NR": ungültiger Bezeichner

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 13:42:05.249
!MESSAGE SQL-Fehler [904] [42000]: ORA-00904: "EC"."POBOX_ADDRESS_NR": ungültiger Bezeichner

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 13:42:05.250
!MESSAGE Error : 904, Position : 11323, Sql = WITH exported_companies AS (
                SELECT /*+ ordered use_hash(ejj ej company a sspa sspba cp_join) full(ejj) full(ej) full(company) full(a) full(sspa) full(sspba) full(cp_join) */
                       company.x_complex_no,  -- leads
                       TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
                       company.language_uid,
                       ejj.join_nr,
                       ej.ext_join_nr,
                       ej.ext_join_type_uid,
                       ej.interface_uid,
--                       sadr.fone,
--                       sadr.handy,
--                       sadr.fax,
--                       sadr.email,
--                       sadr.www,
--                       kam.kamtyp,
                       sspa.address_nr address_nr,
--                       sspba.address_nr pobox_address_nr,
--                       company.y_legal_status_uid,           
--                       company.x_is_locked,
--                       company.x_advisory_status_uid,
--                       dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx,
                       collection.join_nr coll_join_nr,
                       cp_join.person_nr,
                       kuba_data.kuba_join_nr,
                      COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
                      CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
                      		'Email'
                      WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
                      		'Letter'
                      WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
                             'n.a.'
                      END Communication_Channel__c

                FROM   bsicrm.bsi_x_ext_join_join ejj
                JOIN   bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
                LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
                JOIN   bsicrm.bsi_company company ON company.company_nr = ejj.join_nr and company.is_active = 1
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ejj2 ej2) full(ejj2) full(ej2) */
                                        MIN(ej2.kam_uid) kamtyp, ejj2.join_nr innerjnr
                                   FROM bsicrm.bsi_x_ext_join ej2
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                    
                                  WHERE ej2.kam_uid != 0
                                  GROUP BY ejj2.join_nr) kam ON kam.innerjnr = ejj.join_nr  
                LEFT JOIN (SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
                                  adr.item_key0_nr,
                                  MAX(CASE WHEN adr.channel_uid = 113638 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fone,
                                  MAX(CASE WHEN adr.channel_uid = 113640 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) handy,
                                  MAX(CASE WHEN adr.channel_uid = 113639 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fax,
                                  MAX(CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
                                  MAX(CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
                             FROM bsicrm.bsi_address adr
                                  JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
                                  JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr AND ej2.ACTIVE = 1
                            WHERE adr.is_default_address = 1
                              AND adr.item_type_id = 318594
                            GROUP BY adr.item_key0_nr) sadr
				ON sadr.item_key0_nr = company.company_nr
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa
                       ON  sspa.ext_join_nr = ejj.ext_join_nr
                       AND sspa.join_type_uid = 318594
                       AND sspa.type_uid = 2315 /* Hauptadresse */
                       AND sspa.channel_uid = 113688
                       AND sspa.join_nr = ejj.join_nr  
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba
                       ON  sspba.ext_join_nr = ejj.ext_join_nr
                       AND sspba.join_type_uid = 318594
                       AND sspba.type_uid = 108240 /* Postfach */
                       AND sspba.channel_uid = 113688
                       AND sspba.join_nr = ejj.join_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(cp_join P cpr) full(cp_join) full(P) full(cpr) */
                                        cp_join.company_nr, MAX(cp_join.person_nr) person_nr
                                   FROM bsicrm.bsi_company_person cp_join
                                        JOIN bsicrm.bsi_person P ON P.person_nr = cp_join.person_nr AND P.is_active = 1
                                        JOIN bsicrm.bsi_uc_company_person_role cpr ON cpr.company_person_role_uid = cp_join.role_uid AND cpr.is_use_for_display_name = 1
                                  GROUP BY cp_join.company_nr) cp_join ON cp_join.company_nr = company.company_nr 
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
                                        max(kd.join_nr) kuba_join_nr, ejj2.join_nr             
                                   FROM bsicrm.bsi_x_ext_kuba_data kd
                                        JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr  AND  ej2.ext_join_type_uid = kd.join_type_uid AND ej2.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
                                  WHERE kd.status_uid = 4800511372 --aktiv  
                                  GROUP BY ejj2.join_nr) KUBA_DATA ON kuba_data.join_nr = company.company_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
                                        ejj2.join_nr, RTRIM(XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
                                   FROM bsicrm.bsi_x_ext_join ej2
                                   JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ej2.ACTIVE = 1
                                  WHERE ej2.active = 1
                                    AND ejj2.ext_join_type_uid = 108224
                                    AND ej2.interface_uid = 108205
                                  GROUP BY ejj2.join_nr) comp_nx ON comp_nx.join_nr = company.company_nr      
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
                                        DISTINCT ejjinner.join_nr
                                   FROM bsicrm.bsi_x_collection coll 
                                        JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr AND ejinner.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
                                  WHERE coll.status_uid <> 137824) collection ON collection.join_nr = company.company_nr    
                WHERE  ejj.is_master = 1
                AND    ejj.ext_join_type_uid = 108224
                AND    ej.active = 1
                AND    ej.interface_uid  = 108205 --nx   
                AND company.company_nr NOT IN (SELECT cc.company_nr     --nicht = Konzern, Unternehmen, Filiale 
                                                 FROM bsicrm.bsi_company_company cc
                                               UNION  
                                               SELECT cc.group_company_nr
                                                 FROM bsicrm.bsi_company_company cc) 
               AND ejj.join_nr NOT IN (SELECT /*+ ordered use_hash(prod ejj2) full(prod) full(ejj2) */
                                               DISTINCT ejj2.join_nr 
                                          FROM bsicrm.bsi_x_ext_product prod 
                                          JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = prod.join_nr
                                         WHERE prod.status_uid = 109307 --aktuell
                                           AND prod.type_uid IN (1000408,1000409,1923083777,1923083778,1923083779,5684031909,6077978250,6077978180,6077978542,6077978285,1000415,1000419,1923083780,1923083781,1923083782,1923083783,1923083784,1923083785,5684031938,5684031911,6077978344,6599798156,6077978035,6599798005,6077978528,6599797809,6077978220,6599797644,1000427,1000428,1000429,1000623)
                                       )), --hat KEIN aktuelles Eintragsprodukt     
                dunning AS (select /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
                                   distinct ejj.join_nr -- company.x_complex_no            
                              FROM bsicrm.bsi_x_ext_receipt xrcp
                                   JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr  AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
                                   JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid
                             WHERE xrcp.overdue_level_uid IN (137663,137664,137665)         
                           )    
            SELECT /*+ ordered use_hash(kuba d legaladdr cy ap cyp pers tkam tlf tnc tne) full(kuba) full(d) full(legaladdr) full(cy) full(ap) full(cyp) full(pers) full(tkam) full(tlf) full(tnc) full(tne) */
                   DISTINCT ec.x_complex_no uk_lcm_x_complex_no__c,
                   ec.person_nr uk_LCM_PERSON_NR__c,       
                   ec.join_nos_nx LCM_NX_MergeIDs__c,   

                   DECODE(ec.language_uid, 246, 'German', 1303, 'English', 7770, 'French', 7771, 'Italian', '?') PreferedLanguage__c,       
                   CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
--                        WHEN dnng.join_nr IS NOT NULL THEN 'C'
						WHEN ec.x_is_locked = 1 THEN 'C'
                        ELSE NULL           
                        END clientrating__c,  

					EC.Communication_Channel__c
            FROM   exported_companies ec
            LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
            LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr     -- dnng.x_complex_no = C.x_complex_no
            LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
            LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
            LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
            LEFT JOIN bsicrm.bsi_city cyp on cyp.city_nr = ap.city_nr
            LEFT JOIN bsicrm.bsi_person pers on pers.person_nr = ec.person_nr
            LEFT JOIN bsicrm.bsi_uc_text tkam on tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tlf on tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tnc on tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tne on tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, OriginalSql = WITH exported_companies AS (
                SELECT /*+ ordered use_hash(ejj ej company a sspa sspba cp_join) full(ejj) full(ej) full(company) full(a) full(sspa) full(sspba) full(cp_join) */
                       company.x_complex_no,  -- leads
                       TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
                       company.language_uid,
                       ejj.join_nr,
                       ej.ext_join_nr,
                       ej.ext_join_type_uid,
                       ej.interface_uid,
--                       sadr.fone,
--                       sadr.handy,
--                       sadr.fax,
--                       sadr.email,
--                       sadr.www,
--                       kam.kamtyp,
                       sspa.address_nr address_nr,
--                       sspba.address_nr pobox_address_nr,
--                       company.y_legal_status_uid,           
--                       company.x_is_locked,
--                       company.x_advisory_status_uid,
--                       dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx,
                       collection.join_nr coll_join_nr,
                       cp_join.person_nr,
                       kuba_data.kuba_join_nr,
                      COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
                      CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
                      		'Email'
                      WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
                      		'Letter'
                      WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
                             'n.a.'
                      END Communication_Channel__c

                FROM   bsicrm.bsi_x_ext_join_join ejj
                JOIN   bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
                LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
                JOIN   bsicrm.bsi_company company ON company.company_nr = ejj.join_nr and company.is_active = 1
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ejj2 ej2) full(ejj2) full(ej2) */
                                        MIN(ej2.kam_uid) kamtyp, ejj2.join_nr innerjnr
                                   FROM bsicrm.bsi_x_ext_join ej2
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                    
                                  WHERE ej2.kam_uid != 0
                                  GROUP BY ejj2.join_nr) kam ON kam.innerjnr = ejj.join_nr  
                LEFT JOIN (SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
                                  adr.item_key0_nr,
                                  MAX(CASE WHEN adr.channel_uid = 113638 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fone,
                                  MAX(CASE WHEN adr.channel_uid = 113640 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) handy,
                                  MAX(CASE WHEN adr.channel_uid = 113639 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fax,
                                  MAX(CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
                                  MAX(CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
                             FROM bsicrm.bsi_address adr
                                  JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
                                  JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr AND ej2.ACTIVE = 1
                            WHERE adr.is_default_address = 1
                              AND adr.item_type_id = 318594
                            GROUP BY adr.item_key0_nr) sadr
				ON sadr.item_key0_nr = company.company_nr
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa
                       ON  sspa.ext_join_nr = ejj.ext_join_nr
                       AND sspa.join_type_uid = 318594
                       AND sspa.type_uid = 2315 /* Hauptadresse */
                       AND sspa.channel_uid = 113688
                       AND sspa.join_nr = ejj.join_nr  
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba
                       ON  sspba.ext_join_nr = ejj.ext_join_nr
                       AND sspba.join_type_uid = 318594
                       AND sspba.type_uid = 108240 /* Postfach */
                       AND sspba.channel_uid = 113688
                       AND sspba.join_nr = ejj.join_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(cp_join P cpr) full(cp_join) full(P) full(cpr) */
                                        cp_join.company_nr, MAX(cp_join.person_nr) person_nr
                                   FROM bsicrm.bsi_company_person cp_join
                                        JOIN bsicrm.bsi_person P ON P.person_nr = cp_join.person_nr AND P.is_active = 1
                                        JOIN bsicrm.bsi_uc_company_person_role cpr ON cpr.company_person_role_uid = cp_join.role_uid AND cpr.is_use_for_display_name = 1
                                  GROUP BY cp_join.company_nr) cp_join ON cp_join.company_nr = company.company_nr 
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
                                        max(kd.join_nr) kuba_join_nr, ejj2.join_nr             
                                   FROM bsicrm.bsi_x_ext_kuba_data kd
                                        JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr  AND  ej2.ext_join_type_uid = kd.join_type_uid AND ej2.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
                                  WHERE kd.status_uid = 4800511372 --aktiv  
                                  GROUP BY ejj2.join_nr) KUBA_DATA ON kuba_data.join_nr = company.company_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
                                        ejj2.join_nr, RTRIM(XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
                                   FROM bsicrm.bsi_x_ext_join ej2
                                   JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ej2.ACTIVE = 1
                                  WHERE ej2.active = 1
                                    AND ejj2.ext_join_type_uid = 108224
                                    AND ej2.interface_uid = 108205
                                  GROUP BY ejj2.join_nr) comp_nx ON comp_nx.join_nr = company.company_nr      
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
                                        DISTINCT ejjinner.join_nr
                                   FROM bsicrm.bsi_x_collection coll 
                                        JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr AND ejinner.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
                                  WHERE coll.status_uid <> 137824) collection ON collection.join_nr = company.company_nr    
                WHERE  ejj.is_master = 1
                AND    ejj.ext_join_type_uid = 108224
                AND    ej.active = 1
                AND    ej.interface_uid  = 108205 --nx   
                AND company.company_nr NOT IN (SELECT cc.company_nr     --nicht = Konzern, Unternehmen, Filiale 
                                                 FROM bsicrm.bsi_company_company cc
                                               UNION  
                                               SELECT cc.group_company_nr
                                                 FROM bsicrm.bsi_company_company cc) 
               AND ejj.join_nr NOT IN (SELECT /*+ ordered use_hash(prod ejj2) full(prod) full(ejj2) */
                                               DISTINCT ejj2.join_nr 
                                          FROM bsicrm.bsi_x_ext_product prod 
                                          JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = prod.join_nr
                                         WHERE prod.status_uid = 109307 --aktuell
                                           AND prod.type_uid IN (1000408,1000409,1923083777,1923083778,1923083779,5684031909,6077978250,6077978180,6077978542,6077978285,1000415,1000419,1923083780,1923083781,1923083782,1923083783,1923083784,1923083785,5684031938,5684031911,6077978344,6599798156,6077978035,6599798005,6077978528,6599797809,6077978220,6599797644,1000427,1000428,1000429,1000623)
                                       )), --hat KEIN aktuelles Eintragsprodukt     
                dunning AS (select /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
                                   distinct ejj.join_nr -- company.x_complex_no            
                              FROM bsicrm.bsi_x_ext_receipt xrcp
                                   JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr  AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
                                   JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid
                             WHERE xrcp.overdue_level_uid IN (137663,137664,137665)         
                           )    
            SELECT /*+ ordered use_hash(kuba d legaladdr cy ap cyp pers tkam tlf tnc tne) full(kuba) full(d) full(legaladdr) full(cy) full(ap) full(cyp) full(pers) full(tkam) full(tlf) full(tnc) full(tne) */
                   DISTINCT ec.x_complex_no uk_lcm_x_complex_no__c,
                   ec.person_nr uk_LCM_PERSON_NR__c,       
                   ec.join_nos_nx LCM_NX_MergeIDs__c,   

                   DECODE(ec.language_uid, 246, 'German', 1303, 'English', 7770, 'French', 7771, 'Italian', '?') PreferedLanguage__c,       
                   CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
--                        WHEN dnng.join_nr IS NOT NULL THEN 'C'
						WHEN ec.x_is_locked = 1 THEN 'C'
                        ELSE NULL           
                        END clientrating__c,  

					EC.Communication_Channel__c
            FROM   exported_companies ec
            LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
            LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr     -- dnng.x_complex_no = C.x_complex_no
            LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
            LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
            LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
            LEFT JOIN bsicrm.bsi_city cyp on cyp.city_nr = ap.city_nr
            LEFT JOIN bsicrm.bsi_person pers on pers.person_nr = ec.person_nr
            LEFT JOIN bsicrm.bsi_uc_text tkam on tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tlf on tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tnc on tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tne on tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, Error Msg = ORA-00904: "EC"."POBOX_ADDRESS_NR": ungültiger Bezeichner

!STACK 0
Error : 904, Position : 11323, Sql = WITH exported_companies AS (
                SELECT /*+ ordered use_hash(ejj ej company a sspa sspba cp_join) full(ejj) full(ej) full(company) full(a) full(sspa) full(sspba) full(cp_join) */
                       company.x_complex_no,  -- leads
                       TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
                       company.language_uid,
                       ejj.join_nr,
                       ej.ext_join_nr,
                       ej.ext_join_type_uid,
                       ej.interface_uid,
--                       sadr.fone,
--                       sadr.handy,
--                       sadr.fax,
--                       sadr.email,
--                       sadr.www,
--                       kam.kamtyp,
                       sspa.address_nr address_nr,
--                       sspba.address_nr pobox_address_nr,
--                       company.y_legal_status_uid,           
--                       company.x_is_locked,
--                       company.x_advisory_status_uid,
--                       dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx,
                       collection.join_nr coll_join_nr,
                       cp_join.person_nr,
                       kuba_data.kuba_join_nr,
                      COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
                      CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
                      		'Email'
                      WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
                      		'Letter'
                      WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
                             'n.a.'
                      END Communication_Channel__c

                FROM   bsicrm.bsi_x_ext_join_join ejj
                JOIN   bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
                LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
                JOIN   bsicrm.bsi_company company ON company.company_nr = ejj.join_nr and company.is_active = 1
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ejj2 ej2) full(ejj2) full(ej2) */
                                        MIN(ej2.kam_uid) kamtyp, ejj2.join_nr innerjnr
                                   FROM bsicrm.bsi_x_ext_join ej2
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                    
                                  WHERE ej2.kam_uid != 0
                                  GROUP BY ejj2.join_nr) kam ON kam.innerjnr = ejj.join_nr  
                LEFT JOIN (SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
                                  adr.item_key0_nr,
                                  MAX(CASE WHEN adr.channel_uid = 113638 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fone,
                                  MAX(CASE WHEN adr.channel_uid = 113640 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) handy,
                                  MAX(CASE WHEN adr.channel_uid = 113639 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fax,
                                  MAX(CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
                                  MAX(CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
                             FROM bsicrm.bsi_address adr
                                  JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
                                  JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr AND ej2.ACTIVE = 1
                            WHERE adr.is_default_address = 1
                              AND adr.item_type_id = 318594
                            GROUP BY adr.item_key0_nr) sadr
				ON sadr.item_key0_nr = company.company_nr
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa
                       ON  sspa.ext_join_nr = ejj.ext_join_nr
                       AND sspa.join_type_uid = 318594
                       AND sspa.type_uid = 2315 /* Hauptadresse */
                       AND sspa.channel_uid = 113688
                       AND sspa.join_nr = ejj.join_nr  
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba
                       ON  sspba.ext_join_nr = ejj.ext_join_nr
                       AND sspba.join_type_uid = 318594
                       AND sspba.type_uid = 108240 /* Postfach */
                       AND sspba.channel_uid = 113688
                       AND sspba.join_nr = ejj.join_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(cp_join P cpr) full(cp_join) full(P) full(cpr) */
                                        cp_join.company_nr, MAX(cp_join.person_nr) person_nr
                                   FROM bsicrm.bsi_company_person cp_join
                                        JOIN bsicrm.bsi_person P ON P.person_nr = cp_join.person_nr AND P.is_active = 1
                                        JOIN bsicrm.bsi_uc_company_person_role cpr ON cpr.company_person_role_uid = cp_join.role_uid AND cpr.is_use_for_display_name = 1
                                  GROUP BY cp_join.company_nr) cp_join ON cp_join.company_nr = company.company_nr 
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
                                        max(kd.join_nr) kuba_join_nr, ejj2.join_nr             
                                   FROM bsicrm.bsi_x_ext_kuba_data kd
                                        JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr  AND  ej2.ext_join_type_uid = kd.join_type_uid AND ej2.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
                                  WHERE kd.status_uid = 4800511372 --aktiv  
                                  GROUP BY ejj2.join_nr) KUBA_DATA ON kuba_data.join_nr = company.company_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
                                        ejj2.join_nr, RTRIM(XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
                                   FROM bsicrm.bsi_x_ext_join ej2
                                   JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ej2.ACTIVE = 1
                                  WHERE ej2.active = 1
                                    AND ejj2.ext_join_type_uid = 108224
                                    AND ej2.interface_uid = 108205
                                  GROUP BY ejj2.join_nr) comp_nx ON comp_nx.join_nr = company.company_nr      
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
                                        DISTINCT ejjinner.join_nr
                                   FROM bsicrm.bsi_x_collection coll 
                                        JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr AND ejinner.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
                                  WHERE coll.status_uid <> 137824) collection ON collection.join_nr = company.company_nr    
                WHERE  ejj.is_master = 1
                AND    ejj.ext_join_type_uid = 108224
                AND    ej.active = 1
                AND    ej.interface_uid  = 108205 --nx   
                AND company.company_nr NOT IN (SELECT cc.company_nr     --nicht = Konzern, Unternehmen, Filiale 
                                                 FROM bsicrm.bsi_company_company cc
                                               UNION  
                                               SELECT cc.group_company_nr
                                                 FROM bsicrm.bsi_company_company cc) 
               AND ejj.join_nr NOT IN (SELECT /*+ ordered use_hash(prod ejj2) full(prod) full(ejj2) */
                                               DISTINCT ejj2.join_nr 
                                          FROM bsicrm.bsi_x_ext_product prod 
                                          JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = prod.join_nr
                                         WHERE prod.status_uid = 109307 --aktuell
                                           AND prod.type_uid IN (1000408,1000409,1923083777,1923083778,1923083779,5684031909,6077978250,6077978180,6077978542,6077978285,1000415,1000419,1923083780,1923083781,1923083782,1923083783,1923083784,1923083785,5684031938,5684031911,6077978344,6599798156,6077978035,6599798005,6077978528,6599797809,6077978220,6599797644,1000427,1000428,1000429,1000623)
                                       )), --hat KEIN aktuelles Eintragsprodukt     
                dunning AS (select /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
                                   distinct ejj.join_nr -- company.x_complex_no            
                              FROM bsicrm.bsi_x_ext_receipt xrcp
                                   JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr  AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
                                   JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid
                             WHERE xrcp.overdue_level_uid IN (137663,137664,137665)         
                           )    
            SELECT /*+ ordered use_hash(kuba d legaladdr cy ap cyp pers tkam tlf tnc tne) full(kuba) full(d) full(legaladdr) full(cy) full(ap) full(cyp) full(pers) full(tkam) full(tlf) full(tnc) full(tne) */
                   DISTINCT ec.x_complex_no uk_lcm_x_complex_no__c,
                   ec.person_nr uk_LCM_PERSON_NR__c,       
                   ec.join_nos_nx LCM_NX_MergeIDs__c,   

                   DECODE(ec.language_uid, 246, 'German', 1303, 'English', 7770, 'French', 7771, 'Italian', '?') PreferedLanguage__c,       
                   CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
--                        WHEN dnng.join_nr IS NOT NULL THEN 'C'
						WHEN ec.x_is_locked = 1 THEN 'C'
                        ELSE NULL           
                        END clientrating__c,  

					EC.Communication_Channel__c
            FROM   exported_companies ec
            LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
            LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr     -- dnng.x_complex_no = C.x_complex_no
            LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
            LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
            LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
            LEFT JOIN bsicrm.bsi_city cyp on cyp.city_nr = ap.city_nr
            LEFT JOIN bsicrm.bsi_person pers on pers.person_nr = ec.person_nr
            LEFT JOIN bsicrm.bsi_uc_text tkam on tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tlf on tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tnc on tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tne on tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, OriginalSql = WITH exported_companies AS (
                SELECT /*+ ordered use_hash(ejj ej company a sspa sspba cp_join) full(ejj) full(ej) full(company) full(a) full(sspa) full(sspba) full(cp_join) */
                       company.x_complex_no,  -- leads
                       TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
                       company.language_uid,
                       ejj.join_nr,
                       ej.ext_join_nr,
                       ej.ext_join_type_uid,
                       ej.interface_uid,
--                       sadr.fone,
--                       sadr.handy,
--                       sadr.fax,
--                       sadr.email,
--                       sadr.www,
--                       kam.kamtyp,
                       sspa.address_nr address_nr,
--                       sspba.address_nr pobox_address_nr,
--                       company.y_legal_status_uid,           
--                       company.x_is_locked,
--                       company.x_advisory_status_uid,
--                       dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx,
                       collection.join_nr coll_join_nr,
                       cp_join.person_nr,
                       kuba_data.kuba_join_nr,
                      COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
                      CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
                      		'Email'
                      WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
                      		'Letter'
                      WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
                             'n.a.'
                      END Communication_Channel__c

                FROM   bsicrm.bsi_x_ext_join_join ejj
                JOIN   bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
                LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
                JOIN   bsicrm.bsi_company company ON company.company_nr = ejj.join_nr and company.is_active = 1
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ejj2 ej2) full(ejj2) full(ej2) */
                                        MIN(ej2.kam_uid) kamtyp, ejj2.join_nr innerjnr
                                   FROM bsicrm.bsi_x_ext_join ej2
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                    
                                  WHERE ej2.kam_uid != 0
                                  GROUP BY ejj2.join_nr) kam ON kam.innerjnr = ejj.join_nr  
                LEFT JOIN (SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
                                  adr.item_key0_nr,
                                  MAX(CASE WHEN adr.channel_uid = 113638 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fone,
                                  MAX(CASE WHEN adr.channel_uid = 113640 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) handy,
                                  MAX(CASE WHEN adr.channel_uid = 113639 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fax,
                                  MAX(CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
                                  MAX(CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
                             FROM bsicrm.bsi_address adr
                                  JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
                                  JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr AND ej2.ACTIVE = 1
                            WHERE adr.is_default_address = 1
                              AND adr.item_type_id = 318594
                            GROUP BY adr.item_key0_nr) sadr
				ON sadr.item_key0_nr = company.company_nr
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa
                       ON  sspa.ext_join_nr = ejj.ext_join_nr
                       AND sspa.join_type_uid = 318594
                       AND sspa.type_uid = 2315 /* Hauptadresse */
                       AND sspa.channel_uid = 113688
                       AND sspa.join_nr = ejj.join_nr  
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba
                       ON  sspba.ext_join_nr = ejj.ext_join_nr
                       AND sspba.join_type_uid = 318594
                       AND sspba.type_uid = 108240 /* Postfach */
                       AND sspba.channel_uid = 113688
                       AND sspba.join_nr = ejj.join_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(cp_join P cpr) full(cp_join) full(P) full(cpr) */
                                        cp_join.company_nr, MAX(cp_join.person_nr) person_nr
                                   FROM bsicrm.bsi_company_person cp_join
                                        JOIN bsicrm.bsi_person P ON P.person_nr = cp_join.person_nr AND P.is_active = 1
                                        JOIN bsicrm.bsi_uc_company_person_role cpr ON cpr.company_person_role_uid = cp_join.role_uid AND cpr.is_use_for_display_name = 1
                                  GROUP BY cp_join.company_nr) cp_join ON cp_join.company_nr = company.company_nr 
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
                                        max(kd.join_nr) kuba_join_nr, ejj2.join_nr             
                                   FROM bsicrm.bsi_x_ext_kuba_data kd
                                        JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr  AND  ej2.ext_join_type_uid = kd.join_type_uid AND ej2.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
                                  WHERE kd.status_uid = 4800511372 --aktiv  
                                  GROUP BY ejj2.join_nr) KUBA_DATA ON kuba_data.join_nr = company.company_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
                                        ejj2.join_nr, RTRIM(XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
                                   FROM bsicrm.bsi_x_ext_join ej2
                                   JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ej2.ACTIVE = 1
                                  WHERE ej2.active = 1
                                    AND ejj2.ext_join_type_uid = 108224
                                    AND ej2.interface_uid = 108205
                                  GROUP BY ejj2.join_nr) comp_nx ON comp_nx.join_nr = company.company_nr      
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
                                        DISTINCT ejjinner.join_nr
                                   FROM bsicrm.bsi_x_collection coll 
                                        JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr AND ejinner.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
                                  WHERE coll.status_uid <> 137824) collection ON collection.join_nr = company.company_nr    
                WHERE  ejj.is_master = 1
                AND    ejj.ext_join_type_uid = 108224
                AND    ej.active = 1
                AND    ej.interface_uid  = 108205 --nx   
                AND company.company_nr NOT IN (SELECT cc.company_nr     --nicht = Konzern, Unternehmen, Filiale 
                                                 FROM bsicrm.bsi_company_company cc
                                               UNION  
                                               SELECT cc.group_company_nr
                                                 FROM bsicrm.bsi_company_company cc) 
               AND ejj.join_nr NOT IN (SELECT /*+ ordered use_hash(prod ejj2) full(prod) full(ejj2) */
                                               DISTINCT ejj2.join_nr 
                                          FROM bsicrm.bsi_x_ext_product prod 
                                          JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = prod.join_nr
                                         WHERE prod.status_uid = 109307 --aktuell
                                           AND prod.type_uid IN (1000408,1000409,1923083777,1923083778,1923083779,5684031909,6077978250,6077978180,6077978542,6077978285,1000415,1000419,1923083780,1923083781,1923083782,1923083783,1923083784,1923083785,5684031938,5684031911,6077978344,6599798156,6077978035,6599798005,6077978528,6599797809,6077978220,6599797644,1000427,1000428,1000429,1000623)
                                       )), --hat KEIN aktuelles Eintragsprodukt     
                dunning AS (select /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
                                   distinct ejj.join_nr -- company.x_complex_no            
                              FROM bsicrm.bsi_x_ext_receipt xrcp
                                   JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr  AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
                                   JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid
                             WHERE xrcp.overdue_level_uid IN (137663,137664,137665)         
                           )    
            SELECT /*+ ordered use_hash(kuba d legaladdr cy ap cyp pers tkam tlf tnc tne) full(kuba) full(d) full(legaladdr) full(cy) full(ap) full(cyp) full(pers) full(tkam) full(tlf) full(tnc) full(tne) */
                   DISTINCT ec.x_complex_no uk_lcm_x_complex_no__c,
                   ec.person_nr uk_LCM_PERSON_NR__c,       
                   ec.join_nos_nx LCM_NX_MergeIDs__c,   

                   DECODE(ec.language_uid, 246, 'German', 1303, 'English', 7770, 'French', 7771, 'Italian', '?') PreferedLanguage__c,       
                   CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
--                        WHEN dnng.join_nr IS NOT NULL THEN 'C'
						WHEN ec.x_is_locked = 1 THEN 'C'
                        ELSE NULL           
                        END clientrating__c,  

					EC.Communication_Channel__c
            FROM   exported_companies ec
            LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
            LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr     -- dnng.x_complex_no = C.x_complex_no
            LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
            LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
            LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
            LEFT JOIN bsicrm.bsi_city cyp on cyp.city_nr = ap.city_nr
            LEFT JOIN bsicrm.bsi_person pers on pers.person_nr = ec.person_nr
            LEFT JOIN bsicrm.bsi_uc_text tkam on tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tlf on tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tnc on tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tne on tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, Error Msg = ORA-00904: "EC"."POBOX_ADDRESS_NR": ungültiger Bezeichner

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 13:42:31.716
!MESSAGE SQL-Fehler [904] [42000]: ORA-00904: "EC"."JOIN_NOS_NX": ungültiger Bezeichner

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 13:42:31.716
!MESSAGE Error : 904, Position : 10348, Sql = WITH exported_companies AS (
                SELECT /*+ ordered use_hash(ejj ej company a sspa sspba cp_join) full(ejj) full(ej) full(company) full(a) full(sspa) full(sspba) full(cp_join) */
                       company.x_complex_no,  -- leads
                       TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
                       company.language_uid,
                       ejj.join_nr,
                       ej.ext_join_nr,
                       ej.ext_join_type_uid,
                       ej.interface_uid,
                       sadr.fone,
                       sadr.handy,
                       sadr.fax,
                       sadr.email,
                       sadr.www,
                       kam.kamtyp,
                       sspa.address_nr address_nr,
                       sspba.address_nr pobox_address_nr,
                       company.y_legal_status_uid,           
                       company.x_is_locked,
                       company.x_advisory_status_uid,
--                       dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx,
                       collection.join_nr coll_join_nr,
                       cp_join.person_nr,
                       kuba_data.kuba_join_nr,
                      COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
                      CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
                      		'Email'
                      WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
                      		'Letter'
                      WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
                             'n.a.'
                      END Communication_Channel__c

                FROM   bsicrm.bsi_x_ext_join_join ejj
                JOIN   bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
                LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
                JOIN   bsicrm.bsi_company company ON company.company_nr = ejj.join_nr and company.is_active = 1
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ejj2 ej2) full(ejj2) full(ej2) */
                                        MIN(ej2.kam_uid) kamtyp, ejj2.join_nr innerjnr
                                   FROM bsicrm.bsi_x_ext_join ej2
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                    
                                  WHERE ej2.kam_uid != 0
                                  GROUP BY ejj2.join_nr) kam ON kam.innerjnr = ejj.join_nr  
                LEFT JOIN (SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
                                  adr.item_key0_nr,
                                  MAX(CASE WHEN adr.channel_uid = 113638 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fone,
                                  MAX(CASE WHEN adr.channel_uid = 113640 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) handy,
                                  MAX(CASE WHEN adr.channel_uid = 113639 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fax,
                                  MAX(CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
                                  MAX(CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
                             FROM bsicrm.bsi_address adr
                                  JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
                                  JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr AND ej2.ACTIVE = 1
                            WHERE adr.is_default_address = 1
                              AND adr.item_type_id = 318594
                            GROUP BY adr.item_key0_nr) sadr
				ON sadr.item_key0_nr = company.company_nr
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa
                       ON  sspa.ext_join_nr = ejj.ext_join_nr
                       AND sspa.join_type_uid = 318594
                       AND sspa.type_uid = 2315 /* Hauptadresse */
                       AND sspa.channel_uid = 113688
                       AND sspa.join_nr = ejj.join_nr  
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba
                       ON  sspba.ext_join_nr = ejj.ext_join_nr
                       AND sspba.join_type_uid = 318594
                       AND sspba.type_uid = 108240 /* Postfach */
                       AND sspba.channel_uid = 113688
                       AND sspba.join_nr = ejj.join_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(cp_join P cpr) full(cp_join) full(P) full(cpr) */
                                        cp_join.company_nr, MAX(cp_join.person_nr) person_nr
                                   FROM bsicrm.bsi_company_person cp_join
                                        JOIN bsicrm.bsi_person P ON P.person_nr = cp_join.person_nr AND P.is_active = 1
                                        JOIN bsicrm.bsi_uc_company_person_role cpr ON cpr.company_person_role_uid = cp_join.role_uid AND cpr.is_use_for_display_name = 1
                                  GROUP BY cp_join.company_nr) cp_join ON cp_join.company_nr = company.company_nr 
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
                                        max(kd.join_nr) kuba_join_nr, ejj2.join_nr             
                                   FROM bsicrm.bsi_x_ext_kuba_data kd
                                        JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr  AND  ej2.ext_join_type_uid = kd.join_type_uid AND ej2.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
                                  WHERE kd.status_uid = 4800511372 --aktiv  
                                  GROUP BY ejj2.join_nr) KUBA_DATA ON kuba_data.join_nr = company.company_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
                                        ejj2.join_nr, RTRIM(XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
                                   FROM bsicrm.bsi_x_ext_join ej2
                                   JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ej2.ACTIVE = 1
                                  WHERE ej2.active = 1
                                    AND ejj2.ext_join_type_uid = 108224
                                    AND ej2.interface_uid = 108205
                                  GROUP BY ejj2.join_nr) comp_nx ON comp_nx.join_nr = company.company_nr      
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
                                        DISTINCT ejjinner.join_nr
                                   FROM bsicrm.bsi_x_collection coll 
                                        JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr AND ejinner.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
                                  WHERE coll.status_uid <> 137824) collection ON collection.join_nr = company.company_nr    
                WHERE  ejj.is_master = 1
                AND    ejj.ext_join_type_uid = 108224
                AND    ej.active = 1
                AND    ej.interface_uid  = 108205 --nx   
                AND company.company_nr NOT IN (SELECT cc.company_nr     --nicht = Konzern, Unternehmen, Filiale 
                                                 FROM bsicrm.bsi_company_company cc
                                               UNION  
                                               SELECT cc.group_company_nr
                                                 FROM bsicrm.bsi_company_company cc) 
               AND ejj.join_nr NOT IN (SELECT /*+ ordered use_hash(prod ejj2) full(prod) full(ejj2) */
                                               DISTINCT ejj2.join_nr 
                                          FROM bsicrm.bsi_x_ext_product prod 
                                          JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = prod.join_nr
                                         WHERE prod.status_uid = 109307 --aktuell
                                           AND prod.type_uid IN (1000408,1000409,1923083777,1923083778,1923083779,5684031909,6077978250,6077978180,6077978542,6077978285,1000415,1000419,1923083780,1923083781,1923083782,1923083783,1923083784,1923083785,5684031938,5684031911,6077978344,6599798156,6077978035,6599798005,6077978528,6599797809,6077978220,6599797644,1000427,1000428,1000429,1000623)
                                       )), --hat KEIN aktuelles Eintragsprodukt     
                dunning AS (select /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
                                   distinct ejj.join_nr -- company.x_complex_no            
                              FROM bsicrm.bsi_x_ext_receipt xrcp
                                   JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr  AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
                                   JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid
                             WHERE xrcp.overdue_level_uid IN (137663,137664,137665)         
                           )    
            SELECT /*+ ordered use_hash(kuba d legaladdr cy ap cyp pers tkam tlf tnc tne) full(kuba) full(d) full(legaladdr) full(cy) full(ap) full(cyp) full(pers) full(tkam) full(tlf) full(tnc) full(tne) */
                   DISTINCT ec.x_complex_no uk_lcm_x_complex_no__c,
                   ec.person_nr uk_LCM_PERSON_NR__c,       
                   ec.join_nos_nx LCM_NX_MergeIDs__c,   

                   DECODE(ec.language_uid, 246, 'German', 1303, 'English', 7770, 'French', 7771, 'Italian', '?') PreferedLanguage__c,       
                   CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
--                        WHEN dnng.join_nr IS NOT NULL THEN 'C'
						WHEN ec.x_is_locked = 1 THEN 'C'
                        ELSE NULL           
                        END clientrating__c,  

					EC.Communication_Channel__c
            FROM   exported_companies ec
            LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
            LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr     -- dnng.x_complex_no = C.x_complex_no
            LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
            LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
            LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
            LEFT JOIN bsicrm.bsi_city cyp on cyp.city_nr = ap.city_nr
            LEFT JOIN bsicrm.bsi_person pers on pers.person_nr = ec.person_nr
            LEFT JOIN bsicrm.bsi_uc_text tkam on tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tlf on tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tnc on tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tne on tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, OriginalSql = WITH exported_companies AS (
                SELECT /*+ ordered use_hash(ejj ej company a sspa sspba cp_join) full(ejj) full(ej) full(company) full(a) full(sspa) full(sspba) full(cp_join) */
                       company.x_complex_no,  -- leads
                       TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
                       company.language_uid,
                       ejj.join_nr,
                       ej.ext_join_nr,
                       ej.ext_join_type_uid,
                       ej.interface_uid,
                       sadr.fone,
                       sadr.handy,
                       sadr.fax,
                       sadr.email,
                       sadr.www,
                       kam.kamtyp,
                       sspa.address_nr address_nr,
                       sspba.address_nr pobox_address_nr,
                       company.y_legal_status_uid,           
                       company.x_is_locked,
                       company.x_advisory_status_uid,
--                       dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx,
                       collection.join_nr coll_join_nr,
                       cp_join.person_nr,
                       kuba_data.kuba_join_nr,
                      COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
                      CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
                      		'Email'
                      WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
                      		'Letter'
                      WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
                             'n.a.'
                      END Communication_Channel__c

                FROM   bsicrm.bsi_x_ext_join_join ejj
                JOIN   bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
                LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
                JOIN   bsicrm.bsi_company company ON company.company_nr = ejj.join_nr and company.is_active = 1
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ejj2 ej2) full(ejj2) full(ej2) */
                                        MIN(ej2.kam_uid) kamtyp, ejj2.join_nr innerjnr
                                   FROM bsicrm.bsi_x_ext_join ej2
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                    
                                  WHERE ej2.kam_uid != 0
                                  GROUP BY ejj2.join_nr) kam ON kam.innerjnr = ejj.join_nr  
                LEFT JOIN (SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
                                  adr.item_key0_nr,
                                  MAX(CASE WHEN adr.channel_uid = 113638 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fone,
                                  MAX(CASE WHEN adr.channel_uid = 113640 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) handy,
                                  MAX(CASE WHEN adr.channel_uid = 113639 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fax,
                                  MAX(CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
                                  MAX(CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
                             FROM bsicrm.bsi_address adr
                                  JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
                                  JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr AND ej2.ACTIVE = 1
                            WHERE adr.is_default_address = 1
                              AND adr.item_type_id = 318594
                            GROUP BY adr.item_key0_nr) sadr
				ON sadr.item_key0_nr = company.company_nr
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa
                       ON  sspa.ext_join_nr = ejj.ext_join_nr
                       AND sspa.join_type_uid = 318594
                       AND sspa.type_uid = 2315 /* Hauptadresse */
                       AND sspa.channel_uid = 113688
                       AND sspa.join_nr = ejj.join_nr  
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba
                       ON  sspba.ext_join_nr = ejj.ext_join_nr
                       AND sspba.join_type_uid = 318594
                       AND sspba.type_uid = 108240 /* Postfach */
                       AND sspba.channel_uid = 113688
                       AND sspba.join_nr = ejj.join_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(cp_join P cpr) full(cp_join) full(P) full(cpr) */
                                        cp_join.company_nr, MAX(cp_join.person_nr) person_nr
                                   FROM bsicrm.bsi_company_person cp_join
                                        JOIN bsicrm.bsi_person P ON P.person_nr = cp_join.person_nr AND P.is_active = 1
                                        JOIN bsicrm.bsi_uc_company_person_role cpr ON cpr.company_person_role_uid = cp_join.role_uid AND cpr.is_use_for_display_name = 1
                                  GROUP BY cp_join.company_nr) cp_join ON cp_join.company_nr = company.company_nr 
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
                                        max(kd.join_nr) kuba_join_nr, ejj2.join_nr             
                                   FROM bsicrm.bsi_x_ext_kuba_data kd
                                        JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr  AND  ej2.ext_join_type_uid = kd.join_type_uid AND ej2.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
                                  WHERE kd.status_uid = 4800511372 --aktiv  
                                  GROUP BY ejj2.join_nr) KUBA_DATA ON kuba_data.join_nr = company.company_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
                                        ejj2.join_nr, RTRIM(XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
                                   FROM bsicrm.bsi_x_ext_join ej2
                                   JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ej2.ACTIVE = 1
                                  WHERE ej2.active = 1
                                    AND ejj2.ext_join_type_uid = 108224
                                    AND ej2.interface_uid = 108205
                                  GROUP BY ejj2.join_nr) comp_nx ON comp_nx.join_nr = company.company_nr      
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
                                        DISTINCT ejjinner.join_nr
                                   FROM bsicrm.bsi_x_collection coll 
                                        JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr AND ejinner.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
                                  WHERE coll.status_uid <> 137824) collection ON collection.join_nr = company.company_nr    
                WHERE  ejj.is_master = 1
                AND    ejj.ext_join_type_uid = 108224
                AND    ej.active = 1
                AND    ej.interface_uid  = 108205 --nx   
                AND company.company_nr NOT IN (SELECT cc.company_nr     --nicht = Konzern, Unternehmen, Filiale 
                                                 FROM bsicrm.bsi_company_company cc
                                               UNION  
                                               SELECT cc.group_company_nr
                                                 FROM bsicrm.bsi_company_company cc) 
               AND ejj.join_nr NOT IN (SELECT /*+ ordered use_hash(prod ejj2) full(prod) full(ejj2) */
                                               DISTINCT ejj2.join_nr 
                                          FROM bsicrm.bsi_x_ext_product prod 
                                          JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = prod.join_nr
                                         WHERE prod.status_uid = 109307 --aktuell
                                           AND prod.type_uid IN (1000408,1000409,1923083777,1923083778,1923083779,5684031909,6077978250,6077978180,6077978542,6077978285,1000415,1000419,1923083780,1923083781,1923083782,1923083783,1923083784,1923083785,5684031938,5684031911,6077978344,6599798156,6077978035,6599798005,6077978528,6599797809,6077978220,6599797644,1000427,1000428,1000429,1000623)
                                       )), --hat KEIN aktuelles Eintragsprodukt     
                dunning AS (select /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
                                   distinct ejj.join_nr -- company.x_complex_no            
                              FROM bsicrm.bsi_x_ext_receipt xrcp
                                   JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr  AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
                                   JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid
                             WHERE xrcp.overdue_level_uid IN (137663,137664,137665)         
                           )    
            SELECT /*+ ordered use_hash(kuba d legaladdr cy ap cyp pers tkam tlf tnc tne) full(kuba) full(d) full(legaladdr) full(cy) full(ap) full(cyp) full(pers) full(tkam) full(tlf) full(tnc) full(tne) */
                   DISTINCT ec.x_complex_no uk_lcm_x_complex_no__c,
                   ec.person_nr uk_LCM_PERSON_NR__c,       
                   ec.join_nos_nx LCM_NX_MergeIDs__c,   

                   DECODE(ec.language_uid, 246, 'German', 1303, 'English', 7770, 'French', 7771, 'Italian', '?') PreferedLanguage__c,       
                   CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
--                        WHEN dnng.join_nr IS NOT NULL THEN 'C'
						WHEN ec.x_is_locked = 1 THEN 'C'
                        ELSE NULL           
                        END clientrating__c,  

					EC.Communication_Channel__c
            FROM   exported_companies ec
            LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
            LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr     -- dnng.x_complex_no = C.x_complex_no
            LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
            LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
            LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
            LEFT JOIN bsicrm.bsi_city cyp on cyp.city_nr = ap.city_nr
            LEFT JOIN bsicrm.bsi_person pers on pers.person_nr = ec.person_nr
            LEFT JOIN bsicrm.bsi_uc_text tkam on tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tlf on tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tnc on tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tne on tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, Error Msg = ORA-00904: "EC"."JOIN_NOS_NX": ungültiger Bezeichner

!STACK 0
Error : 904, Position : 10348, Sql = WITH exported_companies AS (
                SELECT /*+ ordered use_hash(ejj ej company a sspa sspba cp_join) full(ejj) full(ej) full(company) full(a) full(sspa) full(sspba) full(cp_join) */
                       company.x_complex_no,  -- leads
                       TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
                       company.language_uid,
                       ejj.join_nr,
                       ej.ext_join_nr,
                       ej.ext_join_type_uid,
                       ej.interface_uid,
                       sadr.fone,
                       sadr.handy,
                       sadr.fax,
                       sadr.email,
                       sadr.www,
                       kam.kamtyp,
                       sspa.address_nr address_nr,
                       sspba.address_nr pobox_address_nr,
                       company.y_legal_status_uid,           
                       company.x_is_locked,
                       company.x_advisory_status_uid,
--                       dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx,
                       collection.join_nr coll_join_nr,
                       cp_join.person_nr,
                       kuba_data.kuba_join_nr,
                      COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
                      CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
                      		'Email'
                      WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
                      		'Letter'
                      WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
                             'n.a.'
                      END Communication_Channel__c

                FROM   bsicrm.bsi_x_ext_join_join ejj
                JOIN   bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
                LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
                JOIN   bsicrm.bsi_company company ON company.company_nr = ejj.join_nr and company.is_active = 1
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ejj2 ej2) full(ejj2) full(ej2) */
                                        MIN(ej2.kam_uid) kamtyp, ejj2.join_nr innerjnr
                                   FROM bsicrm.bsi_x_ext_join ej2
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                    
                                  WHERE ej2.kam_uid != 0
                                  GROUP BY ejj2.join_nr) kam ON kam.innerjnr = ejj.join_nr  
                LEFT JOIN (SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
                                  adr.item_key0_nr,
                                  MAX(CASE WHEN adr.channel_uid = 113638 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fone,
                                  MAX(CASE WHEN adr.channel_uid = 113640 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) handy,
                                  MAX(CASE WHEN adr.channel_uid = 113639 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fax,
                                  MAX(CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
                                  MAX(CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
                             FROM bsicrm.bsi_address adr
                                  JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
                                  JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr AND ej2.ACTIVE = 1
                            WHERE adr.is_default_address = 1
                              AND adr.item_type_id = 318594
                            GROUP BY adr.item_key0_nr) sadr
				ON sadr.item_key0_nr = company.company_nr
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa
                       ON  sspa.ext_join_nr = ejj.ext_join_nr
                       AND sspa.join_type_uid = 318594
                       AND sspa.type_uid = 2315 /* Hauptadresse */
                       AND sspa.channel_uid = 113688
                       AND sspa.join_nr = ejj.join_nr  
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba
                       ON  sspba.ext_join_nr = ejj.ext_join_nr
                       AND sspba.join_type_uid = 318594
                       AND sspba.type_uid = 108240 /* Postfach */
                       AND sspba.channel_uid = 113688
                       AND sspba.join_nr = ejj.join_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(cp_join P cpr) full(cp_join) full(P) full(cpr) */
                                        cp_join.company_nr, MAX(cp_join.person_nr) person_nr
                                   FROM bsicrm.bsi_company_person cp_join
                                        JOIN bsicrm.bsi_person P ON P.person_nr = cp_join.person_nr AND P.is_active = 1
                                        JOIN bsicrm.bsi_uc_company_person_role cpr ON cpr.company_person_role_uid = cp_join.role_uid AND cpr.is_use_for_display_name = 1
                                  GROUP BY cp_join.company_nr) cp_join ON cp_join.company_nr = company.company_nr 
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
                                        max(kd.join_nr) kuba_join_nr, ejj2.join_nr             
                                   FROM bsicrm.bsi_x_ext_kuba_data kd
                                        JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr  AND  ej2.ext_join_type_uid = kd.join_type_uid AND ej2.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
                                  WHERE kd.status_uid = 4800511372 --aktiv  
                                  GROUP BY ejj2.join_nr) KUBA_DATA ON kuba_data.join_nr = company.company_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
                                        ejj2.join_nr, RTRIM(XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
                                   FROM bsicrm.bsi_x_ext_join ej2
                                   JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ej2.ACTIVE = 1
                                  WHERE ej2.active = 1
                                    AND ejj2.ext_join_type_uid = 108224
                                    AND ej2.interface_uid = 108205
                                  GROUP BY ejj2.join_nr) comp_nx ON comp_nx.join_nr = company.company_nr      
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
                                        DISTINCT ejjinner.join_nr
                                   FROM bsicrm.bsi_x_collection coll 
                                        JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr AND ejinner.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
                                  WHERE coll.status_uid <> 137824) collection ON collection.join_nr = company.company_nr    
                WHERE  ejj.is_master = 1
                AND    ejj.ext_join_type_uid = 108224
                AND    ej.active = 1
                AND    ej.interface_uid  = 108205 --nx   
                AND company.company_nr NOT IN (SELECT cc.company_nr     --nicht = Konzern, Unternehmen, Filiale 
                                                 FROM bsicrm.bsi_company_company cc
                                               UNION  
                                               SELECT cc.group_company_nr
                                                 FROM bsicrm.bsi_company_company cc) 
               AND ejj.join_nr NOT IN (SELECT /*+ ordered use_hash(prod ejj2) full(prod) full(ejj2) */
                                               DISTINCT ejj2.join_nr 
                                          FROM bsicrm.bsi_x_ext_product prod 
                                          JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = prod.join_nr
                                         WHERE prod.status_uid = 109307 --aktuell
                                           AND prod.type_uid IN (1000408,1000409,1923083777,1923083778,1923083779,5684031909,6077978250,6077978180,6077978542,6077978285,1000415,1000419,1923083780,1923083781,1923083782,1923083783,1923083784,1923083785,5684031938,5684031911,6077978344,6599798156,6077978035,6599798005,6077978528,6599797809,6077978220,6599797644,1000427,1000428,1000429,1000623)
                                       )), --hat KEIN aktuelles Eintragsprodukt     
                dunning AS (select /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
                                   distinct ejj.join_nr -- company.x_complex_no            
                              FROM bsicrm.bsi_x_ext_receipt xrcp
                                   JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr  AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
                                   JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid
                             WHERE xrcp.overdue_level_uid IN (137663,137664,137665)         
                           )    
            SELECT /*+ ordered use_hash(kuba d legaladdr cy ap cyp pers tkam tlf tnc tne) full(kuba) full(d) full(legaladdr) full(cy) full(ap) full(cyp) full(pers) full(tkam) full(tlf) full(tnc) full(tne) */
                   DISTINCT ec.x_complex_no uk_lcm_x_complex_no__c,
                   ec.person_nr uk_LCM_PERSON_NR__c,       
                   ec.join_nos_nx LCM_NX_MergeIDs__c,   

                   DECODE(ec.language_uid, 246, 'German', 1303, 'English', 7770, 'French', 7771, 'Italian', '?') PreferedLanguage__c,       
                   CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
--                        WHEN dnng.join_nr IS NOT NULL THEN 'C'
						WHEN ec.x_is_locked = 1 THEN 'C'
                        ELSE NULL           
                        END clientrating__c,  

					EC.Communication_Channel__c
            FROM   exported_companies ec
            LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
            LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr     -- dnng.x_complex_no = C.x_complex_no
            LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
            LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
            LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
            LEFT JOIN bsicrm.bsi_city cyp on cyp.city_nr = ap.city_nr
            LEFT JOIN bsicrm.bsi_person pers on pers.person_nr = ec.person_nr
            LEFT JOIN bsicrm.bsi_uc_text tkam on tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tlf on tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tnc on tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tne on tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, OriginalSql = WITH exported_companies AS (
                SELECT /*+ ordered use_hash(ejj ej company a sspa sspba cp_join) full(ejj) full(ej) full(company) full(a) full(sspa) full(sspba) full(cp_join) */
                       company.x_complex_no,  -- leads
                       TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
                       company.language_uid,
                       ejj.join_nr,
                       ej.ext_join_nr,
                       ej.ext_join_type_uid,
                       ej.interface_uid,
                       sadr.fone,
                       sadr.handy,
                       sadr.fax,
                       sadr.email,
                       sadr.www,
                       kam.kamtyp,
                       sspa.address_nr address_nr,
                       sspba.address_nr pobox_address_nr,
                       company.y_legal_status_uid,           
                       company.x_is_locked,
                       company.x_advisory_status_uid,
--                       dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx,
                       collection.join_nr coll_join_nr,
                       cp_join.person_nr,
                       kuba_data.kuba_join_nr,
                      COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
                      CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
                      		'Email'
                      WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
                      		'Letter'
                      WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
                             'n.a.'
                      END Communication_Channel__c

                FROM   bsicrm.bsi_x_ext_join_join ejj
                JOIN   bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
                LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
                JOIN   bsicrm.bsi_company company ON company.company_nr = ejj.join_nr and company.is_active = 1
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ejj2 ej2) full(ejj2) full(ej2) */
                                        MIN(ej2.kam_uid) kamtyp, ejj2.join_nr innerjnr
                                   FROM bsicrm.bsi_x_ext_join ej2
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                    
                                  WHERE ej2.kam_uid != 0
                                  GROUP BY ejj2.join_nr) kam ON kam.innerjnr = ejj.join_nr  
                LEFT JOIN (SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
                                  adr.item_key0_nr,
                                  MAX(CASE WHEN adr.channel_uid = 113638 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fone,
                                  MAX(CASE WHEN adr.channel_uid = 113640 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) handy,
                                  MAX(CASE WHEN adr.channel_uid = 113639 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fax,
                                  MAX(CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
                                  MAX(CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
                             FROM bsicrm.bsi_address adr
                                  JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
                                  JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr AND ej2.ACTIVE = 1
                            WHERE adr.is_default_address = 1
                              AND adr.item_type_id = 318594
                            GROUP BY adr.item_key0_nr) sadr
				ON sadr.item_key0_nr = company.company_nr
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa
                       ON  sspa.ext_join_nr = ejj.ext_join_nr
                       AND sspa.join_type_uid = 318594
                       AND sspa.type_uid = 2315 /* Hauptadresse */
                       AND sspa.channel_uid = 113688
                       AND sspa.join_nr = ejj.join_nr  
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba
                       ON  sspba.ext_join_nr = ejj.ext_join_nr
                       AND sspba.join_type_uid = 318594
                       AND sspba.type_uid = 108240 /* Postfach */
                       AND sspba.channel_uid = 113688
                       AND sspba.join_nr = ejj.join_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(cp_join P cpr) full(cp_join) full(P) full(cpr) */
                                        cp_join.company_nr, MAX(cp_join.person_nr) person_nr
                                   FROM bsicrm.bsi_company_person cp_join
                                        JOIN bsicrm.bsi_person P ON P.person_nr = cp_join.person_nr AND P.is_active = 1
                                        JOIN bsicrm.bsi_uc_company_person_role cpr ON cpr.company_person_role_uid = cp_join.role_uid AND cpr.is_use_for_display_name = 1
                                  GROUP BY cp_join.company_nr) cp_join ON cp_join.company_nr = company.company_nr 
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
                                        max(kd.join_nr) kuba_join_nr, ejj2.join_nr             
                                   FROM bsicrm.bsi_x_ext_kuba_data kd
                                        JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr  AND  ej2.ext_join_type_uid = kd.join_type_uid AND ej2.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
                                  WHERE kd.status_uid = 4800511372 --aktiv  
                                  GROUP BY ejj2.join_nr) KUBA_DATA ON kuba_data.join_nr = company.company_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
                                        ejj2.join_nr, RTRIM(XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
                                   FROM bsicrm.bsi_x_ext_join ej2
                                   JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ej2.ACTIVE = 1
                                  WHERE ej2.active = 1
                                    AND ejj2.ext_join_type_uid = 108224
                                    AND ej2.interface_uid = 108205
                                  GROUP BY ejj2.join_nr) comp_nx ON comp_nx.join_nr = company.company_nr      
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
                                        DISTINCT ejjinner.join_nr
                                   FROM bsicrm.bsi_x_collection coll 
                                        JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr AND ejinner.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
                                  WHERE coll.status_uid <> 137824) collection ON collection.join_nr = company.company_nr    
                WHERE  ejj.is_master = 1
                AND    ejj.ext_join_type_uid = 108224
                AND    ej.active = 1
                AND    ej.interface_uid  = 108205 --nx   
                AND company.company_nr NOT IN (SELECT cc.company_nr     --nicht = Konzern, Unternehmen, Filiale 
                                                 FROM bsicrm.bsi_company_company cc
                                               UNION  
                                               SELECT cc.group_company_nr
                                                 FROM bsicrm.bsi_company_company cc) 
               AND ejj.join_nr NOT IN (SELECT /*+ ordered use_hash(prod ejj2) full(prod) full(ejj2) */
                                               DISTINCT ejj2.join_nr 
                                          FROM bsicrm.bsi_x_ext_product prod 
                                          JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = prod.join_nr
                                         WHERE prod.status_uid = 109307 --aktuell
                                           AND prod.type_uid IN (1000408,1000409,1923083777,1923083778,1923083779,5684031909,6077978250,6077978180,6077978542,6077978285,1000415,1000419,1923083780,1923083781,1923083782,1923083783,1923083784,1923083785,5684031938,5684031911,6077978344,6599798156,6077978035,6599798005,6077978528,6599797809,6077978220,6599797644,1000427,1000428,1000429,1000623)
                                       )), --hat KEIN aktuelles Eintragsprodukt     
                dunning AS (select /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
                                   distinct ejj.join_nr -- company.x_complex_no            
                              FROM bsicrm.bsi_x_ext_receipt xrcp
                                   JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr  AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
                                   JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid
                             WHERE xrcp.overdue_level_uid IN (137663,137664,137665)         
                           )    
            SELECT /*+ ordered use_hash(kuba d legaladdr cy ap cyp pers tkam tlf tnc tne) full(kuba) full(d) full(legaladdr) full(cy) full(ap) full(cyp) full(pers) full(tkam) full(tlf) full(tnc) full(tne) */
                   DISTINCT ec.x_complex_no uk_lcm_x_complex_no__c,
                   ec.person_nr uk_LCM_PERSON_NR__c,       
                   ec.join_nos_nx LCM_NX_MergeIDs__c,   

                   DECODE(ec.language_uid, 246, 'German', 1303, 'English', 7770, 'French', 7771, 'Italian', '?') PreferedLanguage__c,       
                   CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
--                        WHEN dnng.join_nr IS NOT NULL THEN 'C'
						WHEN ec.x_is_locked = 1 THEN 'C'
                        ELSE NULL           
                        END clientrating__c,  

					EC.Communication_Channel__c
            FROM   exported_companies ec
            LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
            LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr     -- dnng.x_complex_no = C.x_complex_no
            LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
            LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
            LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
            LEFT JOIN bsicrm.bsi_city cyp on cyp.city_nr = ap.city_nr
            LEFT JOIN bsicrm.bsi_person pers on pers.person_nr = ec.person_nr
            LEFT JOIN bsicrm.bsi_uc_text tkam on tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tlf on tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tnc on tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tne on tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, Error Msg = ORA-00904: "EC"."JOIN_NOS_NX": ungültiger Bezeichner

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 13:52:16.198
!MESSAGE SQL-Fehler [1013] [72000]: ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert
ORA-06512: in "SYS.XMLTYPE", Zeile 138

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 13:52:16.198
!MESSAGE Error : 1013, Position : 6535, Sql = WITH exported_companies AS (
                SELECT /*+ ordered use_hash(ejj ej company a sspa sspba cp_join) full(ejj) full(ej) full(company) full(a) full(sspa) full(sspba) full(cp_join) */
                       company.x_complex_no,  -- leads
                       TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
                       company.language_uid,
                       ejj.join_nr,
                       ej.ext_join_nr,
                       ej.ext_join_type_uid,
                       ej.interface_uid,
                       sadr.fone,
                       sadr.handy,
                       sadr.fax,
                       sadr.email,
                       sadr.www,
                       kam.kamtyp,
                       sspa.address_nr address_nr,
                       sspba.address_nr pobox_address_nr,
                       company.y_legal_status_uid,           
                       company.x_is_locked,
                       company.x_advisory_status_uid,
                       dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx,
                       collection.join_nr coll_join_nr,
                       cp_join.person_nr,
                       kuba_data.kuba_join_nr,
                      COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
                      CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
                      		'Email'
                      WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
                      		'Letter'
                      WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
                             'n.a.'
                      END Communication_Channel__c

                FROM   bsicrm.bsi_x_ext_join_join ejj
                JOIN   bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
                LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
                JOIN   bsicrm.bsi_company company ON company.company_nr = ejj.join_nr and company.is_active = 1
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ejj2 ej2) full(ejj2) full(ej2) */
                                        MIN(ej2.kam_uid) kamtyp, ejj2.join_nr innerjnr
                                   FROM bsicrm.bsi_x_ext_join ej2
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                    
                                  WHERE ej2.kam_uid != 0
                                  GROUP BY ejj2.join_nr) kam ON kam.innerjnr = ejj.join_nr  
                LEFT JOIN (SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
                                  adr.item_key0_nr,
                                  MAX(CASE WHEN adr.channel_uid = 113638 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fone,
                                  MAX(CASE WHEN adr.channel_uid = 113640 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) handy,
                                  MAX(CASE WHEN adr.channel_uid = 113639 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fax,
                                  MAX(CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
                                  MAX(CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
                             FROM bsicrm.bsi_address adr
                                  JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
                                  JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr AND ej2.ACTIVE = 1
                            WHERE adr.is_default_address = 1
                              AND adr.item_type_id = 318594
                            GROUP BY adr.item_key0_nr) sadr
				ON sadr.item_key0_nr = company.company_nr
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa
                       ON  sspa.ext_join_nr = ejj.ext_join_nr
                       AND sspa.join_type_uid = 318594
                       AND sspa.type_uid = 2315 /* Hauptadresse */
                       AND sspa.channel_uid = 113688
                       AND sspa.join_nr = ejj.join_nr  
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba
                       ON  sspba.ext_join_nr = ejj.ext_join_nr
                       AND sspba.join_type_uid = 318594
                       AND sspba.type_uid = 108240 /* Postfach */
                       AND sspba.channel_uid = 113688
                       AND sspba.join_nr = ejj.join_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(cp_join P cpr) full(cp_join) full(P) full(cpr) */
                                        cp_join.company_nr, MAX(cp_join.person_nr) person_nr
                                   FROM bsicrm.bsi_company_person cp_join
                                        JOIN bsicrm.bsi_person P ON P.person_nr = cp_join.person_nr AND P.is_active = 1
                                        JOIN bsicrm.bsi_uc_company_person_role cpr ON cpr.company_person_role_uid = cp_join.role_uid AND cpr.is_use_for_display_name = 1
                                  GROUP BY cp_join.company_nr) cp_join ON cp_join.company_nr = company.company_nr 
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
                                        max(kd.join_nr) kuba_join_nr, ejj2.join_nr             
                                   FROM bsicrm.bsi_x_ext_kuba_data kd
                                        JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr  AND  ej2.ext_join_type_uid = kd.join_type_uid AND ej2.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
                                  WHERE kd.status_uid = 4800511372 --aktiv  
                                  GROUP BY ejj2.join_nr) KUBA_DATA ON kuba_data.join_nr = company.company_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
                                        ejj2.join_nr, RTRIM(XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
                                   FROM bsicrm.bsi_x_ext_join ej2
                                   JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ej2.ACTIVE = 1
                                  WHERE ej2.active = 1
                                    AND ejj2.ext_join_type_uid = 108224
                                    AND ej2.interface_uid = 108205
                                  GROUP BY ejj2.join_nr) comp_nx ON comp_nx.join_nr = company.company_nr      
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
                                        DISTINCT ejjinner.join_nr
                                   FROM bsicrm.bsi_x_collection coll 
                                        JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr AND ejinner.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
                                  WHERE coll.status_uid <> 137824) collection ON collection.join_nr = company.company_nr    
                WHERE  ejj.is_master = 1
                AND    ejj.ext_join_type_uid = 108224
                AND    ej.active = 1
                AND    ej.interface_uid  = 108205 --nx   
                AND company.company_nr NOT IN (SELECT cc.company_nr     --nicht = Konzern, Unternehmen, Filiale 
                                                 FROM bsicrm.bsi_company_company cc
                                               UNION  
                                               SELECT cc.group_company_nr
                                                 FROM bsicrm.bsi_company_company cc) 
               AND ejj.join_nr NOT IN (SELECT /*+ ordered use_hash(prod ejj2) full(prod) full(ejj2) */
                                               DISTINCT ejj2.join_nr 
                                          FROM bsicrm.bsi_x_ext_product prod 
                                          JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = prod.join_nr
                                         WHERE prod.status_uid = 109307 --aktuell
                                           AND prod.type_uid IN (1000408,1000409,1923083777,1923083778,1923083779,5684031909,6077978250,6077978180,6077978542,6077978285,1000415,1000419,1923083780,1923083781,1923083782,1923083783,1923083784,1923083785,5684031938,5684031911,6077978344,6599798156,6077978035,6599798005,6077978528,6599797809,6077978220,6599797644,1000427,1000428,1000429,1000623)
                                       )), --hat KEIN aktuelles Eintragsprodukt     
                dunning AS (select /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
                                   distinct ejj.join_nr -- company.x_complex_no            
                              FROM bsicrm.bsi_x_ext_receipt xrcp
                                   JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr  AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
                                   JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid
                             WHERE xrcp.overdue_level_uid IN (137663,137664,137665)         
                           )    
            SELECT /*+ ordered use_hash(kuba d legaladdr cy ap cyp pers tkam tlf tnc tne) full(kuba) full(d) full(legaladdr) full(cy) full(ap) full(cyp) full(pers) full(tkam) full(tlf) full(tnc) full(tne) */
                   DISTINCT ec.x_complex_no uk_lcm_x_complex_no__c,
                   ec.person_nr uk_LCM_PERSON_NR__c,       
                   ec.join_nos_nx LCM_NX_MergeIDs__c,   

                   DECODE(ec.language_uid, 246, 'German', 1303, 'English', 7770, 'French', 7771, 'Italian', '?') PreferedLanguage__c,       
                   CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
--                        WHEN dnng.join_nr IS NOT NULL THEN 'C'
						WHEN ec.x_is_locked = 1 THEN 'C'
                        ELSE NULL           
                        END clientrating__c,  

					EC.Communication_Channel__c
            FROM   exported_companies ec
            LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
            LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr     -- dnng.x_complex_no = C.x_complex_no
            LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
            LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
            LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
            LEFT JOIN bsicrm.bsi_city cyp on cyp.city_nr = ap.city_nr
            LEFT JOIN bsicrm.bsi_person pers on pers.person_nr = ec.person_nr
            LEFT JOIN bsicrm.bsi_uc_text tkam on tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tlf on tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tnc on tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tne on tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, OriginalSql = WITH exported_companies AS (
                SELECT /*+ ordered use_hash(ejj ej company a sspa sspba cp_join) full(ejj) full(ej) full(company) full(a) full(sspa) full(sspba) full(cp_join) */
                       company.x_complex_no,  -- leads
                       TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
                       company.language_uid,
                       ejj.join_nr,
                       ej.ext_join_nr,
                       ej.ext_join_type_uid,
                       ej.interface_uid,
                       sadr.fone,
                       sadr.handy,
                       sadr.fax,
                       sadr.email,
                       sadr.www,
                       kam.kamtyp,
                       sspa.address_nr address_nr,
                       sspba.address_nr pobox_address_nr,
                       company.y_legal_status_uid,           
                       company.x_is_locked,
                       company.x_advisory_status_uid,
                       dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx,
                       collection.join_nr coll_join_nr,
                       cp_join.person_nr,
                       kuba_data.kuba_join_nr,
                      COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
                      CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
                      		'Email'
                      WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
                      		'Letter'
                      WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
                             'n.a.'
                      END Communication_Channel__c

                FROM   bsicrm.bsi_x_ext_join_join ejj
                JOIN   bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
                LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
                JOIN   bsicrm.bsi_company company ON company.company_nr = ejj.join_nr and company.is_active = 1
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ejj2 ej2) full(ejj2) full(ej2) */
                                        MIN(ej2.kam_uid) kamtyp, ejj2.join_nr innerjnr
                                   FROM bsicrm.bsi_x_ext_join ej2
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                    
                                  WHERE ej2.kam_uid != 0
                                  GROUP BY ejj2.join_nr) kam ON kam.innerjnr = ejj.join_nr  
                LEFT JOIN (SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
                                  adr.item_key0_nr,
                                  MAX(CASE WHEN adr.channel_uid = 113638 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fone,
                                  MAX(CASE WHEN adr.channel_uid = 113640 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) handy,
                                  MAX(CASE WHEN adr.channel_uid = 113639 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fax,
                                  MAX(CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
                                  MAX(CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
                             FROM bsicrm.bsi_address adr
                                  JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
                                  JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr AND ej2.ACTIVE = 1
                            WHERE adr.is_default_address = 1
                              AND adr.item_type_id = 318594
                            GROUP BY adr.item_key0_nr) sadr
				ON sadr.item_key0_nr = company.company_nr
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa
                       ON  sspa.ext_join_nr = ejj.ext_join_nr
                       AND sspa.join_type_uid = 318594
                       AND sspa.type_uid = 2315 /* Hauptadresse */
                       AND sspa.channel_uid = 113688
                       AND sspa.join_nr = ejj.join_nr  
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba
                       ON  sspba.ext_join_nr = ejj.ext_join_nr
                       AND sspba.join_type_uid = 318594
                       AND sspba.type_uid = 108240 /* Postfach */
                       AND sspba.channel_uid = 113688
                       AND sspba.join_nr = ejj.join_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(cp_join P cpr) full(cp_join) full(P) full(cpr) */
                                        cp_join.company_nr, MAX(cp_join.person_nr) person_nr
                                   FROM bsicrm.bsi_company_person cp_join
                                        JOIN bsicrm.bsi_person P ON P.person_nr = cp_join.person_nr AND P.is_active = 1
                                        JOIN bsicrm.bsi_uc_company_person_role cpr ON cpr.company_person_role_uid = cp_join.role_uid AND cpr.is_use_for_display_name = 1
                                  GROUP BY cp_join.company_nr) cp_join ON cp_join.company_nr = company.company_nr 
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
                                        max(kd.join_nr) kuba_join_nr, ejj2.join_nr             
                                   FROM bsicrm.bsi_x_ext_kuba_data kd
                                        JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr  AND  ej2.ext_join_type_uid = kd.join_type_uid AND ej2.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
                                  WHERE kd.status_uid = 4800511372 --aktiv  
                                  GROUP BY ejj2.join_nr) KUBA_DATA ON kuba_data.join_nr = company.company_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
                                        ejj2.join_nr, RTRIM(XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
                                   FROM bsicrm.bsi_x_ext_join ej2
                                   JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ej2.ACTIVE = 1
                                  WHERE ej2.active = 1
                                    AND ejj2.ext_join_type_uid = 108224
                                    AND ej2.interface_uid = 108205
                                  GROUP BY ejj2.join_nr) comp_nx ON comp_nx.join_nr = company.company_nr      
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
                                        DISTINCT ejjinner.join_nr
                                   FROM bsicrm.bsi_x_collection coll 
                                        JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr AND ejinner.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
                                  WHERE coll.status_uid <> 137824) collection ON collection.join_nr = company.company_nr    
                WHERE  ejj.is_master = 1
                AND    ejj.ext_join_type_uid = 108224
                AND    ej.active = 1
                AND    ej.interface_uid  = 108205 --nx   
                AND company.company_nr NOT IN (SELECT cc.company_nr     --nicht = Konzern, Unternehmen, Filiale 
                                                 FROM bsicrm.bsi_company_company cc
                                               UNION  
                                               SELECT cc.group_company_nr
                                                 FROM bsicrm.bsi_company_company cc) 
               AND ejj.join_nr NOT IN (SELECT /*+ ordered use_hash(prod ejj2) full(prod) full(ejj2) */
                                               DISTINCT ejj2.join_nr 
                                          FROM bsicrm.bsi_x_ext_product prod 
                                          JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = prod.join_nr
                                         WHERE prod.status_uid = 109307 --aktuell
                                           AND prod.type_uid IN (1000408,1000409,1923083777,1923083778,1923083779,5684031909,6077978250,6077978180,6077978542,6077978285,1000415,1000419,1923083780,1923083781,1923083782,1923083783,1923083784,1923083785,5684031938,5684031911,6077978344,6599798156,6077978035,6599798005,6077978528,6599797809,6077978220,6599797644,1000427,1000428,1000429,1000623)
                                       )), --hat KEIN aktuelles Eintragsprodukt     
                dunning AS (select /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
                                   distinct ejj.join_nr -- company.x_complex_no            
                              FROM bsicrm.bsi_x_ext_receipt xrcp
                                   JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr  AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
                                   JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid
                             WHERE xrcp.overdue_level_uid IN (137663,137664,137665)         
                           )    
            SELECT /*+ ordered use_hash(kuba d legaladdr cy ap cyp pers tkam tlf tnc tne) full(kuba) full(d) full(legaladdr) full(cy) full(ap) full(cyp) full(pers) full(tkam) full(tlf) full(tnc) full(tne) */
                   DISTINCT ec.x_complex_no uk_lcm_x_complex_no__c,
                   ec.person_nr uk_LCM_PERSON_NR__c,       
                   ec.join_nos_nx LCM_NX_MergeIDs__c,   

                   DECODE(ec.language_uid, 246, 'German', 1303, 'English', 7770, 'French', 7771, 'Italian', '?') PreferedLanguage__c,       
                   CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
--                        WHEN dnng.join_nr IS NOT NULL THEN 'C'
						WHEN ec.x_is_locked = 1 THEN 'C'
                        ELSE NULL           
                        END clientrating__c,  

					EC.Communication_Channel__c
            FROM   exported_companies ec
            LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
            LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr     -- dnng.x_complex_no = C.x_complex_no
            LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
            LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
            LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
            LEFT JOIN bsicrm.bsi_city cyp on cyp.city_nr = ap.city_nr
            LEFT JOIN bsicrm.bsi_person pers on pers.person_nr = ec.person_nr
            LEFT JOIN bsicrm.bsi_uc_text tkam on tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tlf on tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tnc on tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tne on tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, Error Msg = ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert
ORA-06512: in "SYS.XMLTYPE", Zeile 138

!STACK 0
Error : 1013, Position : 6535, Sql = WITH exported_companies AS (
                SELECT /*+ ordered use_hash(ejj ej company a sspa sspba cp_join) full(ejj) full(ej) full(company) full(a) full(sspa) full(sspba) full(cp_join) */
                       company.x_complex_no,  -- leads
                       TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
                       company.language_uid,
                       ejj.join_nr,
                       ej.ext_join_nr,
                       ej.ext_join_type_uid,
                       ej.interface_uid,
                       sadr.fone,
                       sadr.handy,
                       sadr.fax,
                       sadr.email,
                       sadr.www,
                       kam.kamtyp,
                       sspa.address_nr address_nr,
                       sspba.address_nr pobox_address_nr,
                       company.y_legal_status_uid,           
                       company.x_is_locked,
                       company.x_advisory_status_uid,
                       dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx,
                       collection.join_nr coll_join_nr,
                       cp_join.person_nr,
                       kuba_data.kuba_join_nr,
                      COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
                      CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
                      		'Email'
                      WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
                      		'Letter'
                      WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
                             'n.a.'
                      END Communication_Channel__c

                FROM   bsicrm.bsi_x_ext_join_join ejj
                JOIN   bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
                LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
                JOIN   bsicrm.bsi_company company ON company.company_nr = ejj.join_nr and company.is_active = 1
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ejj2 ej2) full(ejj2) full(ej2) */
                                        MIN(ej2.kam_uid) kamtyp, ejj2.join_nr innerjnr
                                   FROM bsicrm.bsi_x_ext_join ej2
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                    
                                  WHERE ej2.kam_uid != 0
                                  GROUP BY ejj2.join_nr) kam ON kam.innerjnr = ejj.join_nr  
                LEFT JOIN (SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
                                  adr.item_key0_nr,
                                  MAX(CASE WHEN adr.channel_uid = 113638 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fone,
                                  MAX(CASE WHEN adr.channel_uid = 113640 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) handy,
                                  MAX(CASE WHEN adr.channel_uid = 113639 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fax,
                                  MAX(CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
                                  MAX(CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
                             FROM bsicrm.bsi_address adr
                                  JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
                                  JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr AND ej2.ACTIVE = 1
                            WHERE adr.is_default_address = 1
                              AND adr.item_type_id = 318594
                            GROUP BY adr.item_key0_nr) sadr
				ON sadr.item_key0_nr = company.company_nr
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa
                       ON  sspa.ext_join_nr = ejj.ext_join_nr
                       AND sspa.join_type_uid = 318594
                       AND sspa.type_uid = 2315 /* Hauptadresse */
                       AND sspa.channel_uid = 113688
                       AND sspa.join_nr = ejj.join_nr  
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba
                       ON  sspba.ext_join_nr = ejj.ext_join_nr
                       AND sspba.join_type_uid = 318594
                       AND sspba.type_uid = 108240 /* Postfach */
                       AND sspba.channel_uid = 113688
                       AND sspba.join_nr = ejj.join_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(cp_join P cpr) full(cp_join) full(P) full(cpr) */
                                        cp_join.company_nr, MAX(cp_join.person_nr) person_nr
                                   FROM bsicrm.bsi_company_person cp_join
                                        JOIN bsicrm.bsi_person P ON P.person_nr = cp_join.person_nr AND P.is_active = 1
                                        JOIN bsicrm.bsi_uc_company_person_role cpr ON cpr.company_person_role_uid = cp_join.role_uid AND cpr.is_use_for_display_name = 1
                                  GROUP BY cp_join.company_nr) cp_join ON cp_join.company_nr = company.company_nr 
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
                                        max(kd.join_nr) kuba_join_nr, ejj2.join_nr             
                                   FROM bsicrm.bsi_x_ext_kuba_data kd
                                        JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr  AND  ej2.ext_join_type_uid = kd.join_type_uid AND ej2.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
                                  WHERE kd.status_uid = 4800511372 --aktiv  
                                  GROUP BY ejj2.join_nr) KUBA_DATA ON kuba_data.join_nr = company.company_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
                                        ejj2.join_nr, RTRIM(XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
                                   FROM bsicrm.bsi_x_ext_join ej2
                                   JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ej2.ACTIVE = 1
                                  WHERE ej2.active = 1
                                    AND ejj2.ext_join_type_uid = 108224
                                    AND ej2.interface_uid = 108205
                                  GROUP BY ejj2.join_nr) comp_nx ON comp_nx.join_nr = company.company_nr      
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
                                        DISTINCT ejjinner.join_nr
                                   FROM bsicrm.bsi_x_collection coll 
                                        JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr AND ejinner.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
                                  WHERE coll.status_uid <> 137824) collection ON collection.join_nr = company.company_nr    
                WHERE  ejj.is_master = 1
                AND    ejj.ext_join_type_uid = 108224
                AND    ej.active = 1
                AND    ej.interface_uid  = 108205 --nx   
                AND company.company_nr NOT IN (SELECT cc.company_nr     --nicht = Konzern, Unternehmen, Filiale 
                                                 FROM bsicrm.bsi_company_company cc
                                               UNION  
                                               SELECT cc.group_company_nr
                                                 FROM bsicrm.bsi_company_company cc) 
               AND ejj.join_nr NOT IN (SELECT /*+ ordered use_hash(prod ejj2) full(prod) full(ejj2) */
                                               DISTINCT ejj2.join_nr 
                                          FROM bsicrm.bsi_x_ext_product prod 
                                          JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = prod.join_nr
                                         WHERE prod.status_uid = 109307 --aktuell
                                           AND prod.type_uid IN (1000408,1000409,1923083777,1923083778,1923083779,5684031909,6077978250,6077978180,6077978542,6077978285,1000415,1000419,1923083780,1923083781,1923083782,1923083783,1923083784,1923083785,5684031938,5684031911,6077978344,6599798156,6077978035,6599798005,6077978528,6599797809,6077978220,6599797644,1000427,1000428,1000429,1000623)
                                       )), --hat KEIN aktuelles Eintragsprodukt     
                dunning AS (select /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
                                   distinct ejj.join_nr -- company.x_complex_no            
                              FROM bsicrm.bsi_x_ext_receipt xrcp
                                   JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr  AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
                                   JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid
                             WHERE xrcp.overdue_level_uid IN (137663,137664,137665)         
                           )    
            SELECT /*+ ordered use_hash(kuba d legaladdr cy ap cyp pers tkam tlf tnc tne) full(kuba) full(d) full(legaladdr) full(cy) full(ap) full(cyp) full(pers) full(tkam) full(tlf) full(tnc) full(tne) */
                   DISTINCT ec.x_complex_no uk_lcm_x_complex_no__c,
                   ec.person_nr uk_LCM_PERSON_NR__c,       
                   ec.join_nos_nx LCM_NX_MergeIDs__c,   

                   DECODE(ec.language_uid, 246, 'German', 1303, 'English', 7770, 'French', 7771, 'Italian', '?') PreferedLanguage__c,       
                   CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
--                        WHEN dnng.join_nr IS NOT NULL THEN 'C'
						WHEN ec.x_is_locked = 1 THEN 'C'
                        ELSE NULL           
                        END clientrating__c,  

					EC.Communication_Channel__c
            FROM   exported_companies ec
            LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
            LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr     -- dnng.x_complex_no = C.x_complex_no
            LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
            LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
            LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
            LEFT JOIN bsicrm.bsi_city cyp on cyp.city_nr = ap.city_nr
            LEFT JOIN bsicrm.bsi_person pers on pers.person_nr = ec.person_nr
            LEFT JOIN bsicrm.bsi_uc_text tkam on tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tlf on tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tnc on tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tne on tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, OriginalSql = WITH exported_companies AS (
                SELECT /*+ ordered use_hash(ejj ej company a sspa sspba cp_join) full(ejj) full(ej) full(company) full(a) full(sspa) full(sspba) full(cp_join) */
                       company.x_complex_no,  -- leads
                       TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
                       company.language_uid,
                       ejj.join_nr,
                       ej.ext_join_nr,
                       ej.ext_join_type_uid,
                       ej.interface_uid,
                       sadr.fone,
                       sadr.handy,
                       sadr.fax,
                       sadr.email,
                       sadr.www,
                       kam.kamtyp,
                       sspa.address_nr address_nr,
                       sspba.address_nr pobox_address_nr,
                       company.y_legal_status_uid,           
                       company.x_is_locked,
                       company.x_advisory_status_uid,
                       dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx,
                       collection.join_nr coll_join_nr,
                       cp_join.person_nr,
                       kuba_data.kuba_join_nr,
                      COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
                      CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
                      		'Email'
                      WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
                      		'Letter'
                      WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
                             'n.a.'
                      END Communication_Channel__c

                FROM   bsicrm.bsi_x_ext_join_join ejj
                JOIN   bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
                LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
                JOIN   bsicrm.bsi_company company ON company.company_nr = ejj.join_nr and company.is_active = 1
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ejj2 ej2) full(ejj2) full(ej2) */
                                        MIN(ej2.kam_uid) kamtyp, ejj2.join_nr innerjnr
                                   FROM bsicrm.bsi_x_ext_join ej2
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                    
                                  WHERE ej2.kam_uid != 0
                                  GROUP BY ejj2.join_nr) kam ON kam.innerjnr = ejj.join_nr  
                LEFT JOIN (SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
                                  adr.item_key0_nr,
                                  MAX(CASE WHEN adr.channel_uid = 113638 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fone,
                                  MAX(CASE WHEN adr.channel_uid = 113640 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) handy,
                                  MAX(CASE WHEN adr.channel_uid = 113639 AND adr.channel_value <> '+41999999999' THEN adr.channel_value ELSE NULL END) fax,
                                  MAX(CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
                                  MAX(CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
                             FROM bsicrm.bsi_address adr
                                  JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
                                  JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr AND ej2.ACTIVE = 1
                            WHERE adr.is_default_address = 1
                              AND adr.item_type_id = 318594
                            GROUP BY adr.item_key0_nr) sadr
				ON sadr.item_key0_nr = company.company_nr
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa
                       ON  sspa.ext_join_nr = ejj.ext_join_nr
                       AND sspa.join_type_uid = 318594
                       AND sspa.type_uid = 2315 /* Hauptadresse */
                       AND sspa.channel_uid = 113688
                       AND sspa.join_nr = ejj.join_nr  
                LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba
                       ON  sspba.ext_join_nr = ejj.ext_join_nr
                       AND sspba.join_type_uid = 318594
                       AND sspba.type_uid = 108240 /* Postfach */
                       AND sspba.channel_uid = 113688
                       AND sspba.join_nr = ejj.join_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(cp_join P cpr) full(cp_join) full(P) full(cpr) */
                                        cp_join.company_nr, MAX(cp_join.person_nr) person_nr
                                   FROM bsicrm.bsi_company_person cp_join
                                        JOIN bsicrm.bsi_person P ON P.person_nr = cp_join.person_nr AND P.is_active = 1
                                        JOIN bsicrm.bsi_uc_company_person_role cpr ON cpr.company_person_role_uid = cp_join.role_uid AND cpr.is_use_for_display_name = 1
                                  GROUP BY cp_join.company_nr) cp_join ON cp_join.company_nr = company.company_nr 
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
                                        max(kd.join_nr) kuba_join_nr, ejj2.join_nr             
                                   FROM bsicrm.bsi_x_ext_kuba_data kd
                                        JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr  AND  ej2.ext_join_type_uid = kd.join_type_uid AND ej2.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
                                  WHERE kd.status_uid = 4800511372 --aktiv  
                                  GROUP BY ejj2.join_nr) KUBA_DATA ON kuba_data.join_nr = company.company_nr
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
                                        ejj2.join_nr, RTRIM(XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
                                   FROM bsicrm.bsi_x_ext_join ej2
                                   JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr AND ej2.ACTIVE = 1
                                  WHERE ej2.active = 1
                                    AND ejj2.ext_join_type_uid = 108224
                                    AND ej2.interface_uid = 108205
                                  GROUP BY ejj2.join_nr) comp_nx ON comp_nx.join_nr = company.company_nr      
                LEFT OUTER JOIN (SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
                                        DISTINCT ejjinner.join_nr
                                   FROM bsicrm.bsi_x_collection coll 
                                        JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr AND ejinner.ACTIVE = 1
                                        JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
                                  WHERE coll.status_uid <> 137824) collection ON collection.join_nr = company.company_nr    
                WHERE  ejj.is_master = 1
                AND    ejj.ext_join_type_uid = 108224
                AND    ej.active = 1
                AND    ej.interface_uid  = 108205 --nx   
                AND company.company_nr NOT IN (SELECT cc.company_nr     --nicht = Konzern, Unternehmen, Filiale 
                                                 FROM bsicrm.bsi_company_company cc
                                               UNION  
                                               SELECT cc.group_company_nr
                                                 FROM bsicrm.bsi_company_company cc) 
               AND ejj.join_nr NOT IN (SELECT /*+ ordered use_hash(prod ejj2) full(prod) full(ejj2) */
                                               DISTINCT ejj2.join_nr 
                                          FROM bsicrm.bsi_x_ext_product prod 
                                          JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = prod.join_nr
                                         WHERE prod.status_uid = 109307 --aktuell
                                           AND prod.type_uid IN (1000408,1000409,1923083777,1923083778,1923083779,5684031909,6077978250,6077978180,6077978542,6077978285,1000415,1000419,1923083780,1923083781,1923083782,1923083783,1923083784,1923083785,5684031938,5684031911,6077978344,6599798156,6077978035,6599798005,6077978528,6599797809,6077978220,6599797644,1000427,1000428,1000429,1000623)
                                       )), --hat KEIN aktuelles Eintragsprodukt     
                dunning AS (select /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
                                   distinct ejj.join_nr -- company.x_complex_no            
                              FROM bsicrm.bsi_x_ext_receipt xrcp
                                   JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr  AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
                                   JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr AND ejj.ext_join_type_uid = ej.ext_join_type_uid
                             WHERE xrcp.overdue_level_uid IN (137663,137664,137665)         
                           )    
            SELECT /*+ ordered use_hash(kuba d legaladdr cy ap cyp pers tkam tlf tnc tne) full(kuba) full(d) full(legaladdr) full(cy) full(ap) full(cyp) full(pers) full(tkam) full(tlf) full(tnc) full(tne) */
                   DISTINCT ec.x_complex_no uk_lcm_x_complex_no__c,
                   ec.person_nr uk_LCM_PERSON_NR__c,       
                   ec.join_nos_nx LCM_NX_MergeIDs__c,   

                   DECODE(ec.language_uid, 246, 'German', 1303, 'English', 7770, 'French', 7771, 'Italian', '?') PreferedLanguage__c,       
                   CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
--                        WHEN dnng.join_nr IS NOT NULL THEN 'C'
						WHEN ec.x_is_locked = 1 THEN 'C'
                        ELSE NULL           
                        END clientrating__c,  

					EC.Communication_Channel__c
            FROM   exported_companies ec
            LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
            LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr     -- dnng.x_complex_no = C.x_complex_no
            LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
            LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
            LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
            LEFT JOIN bsicrm.bsi_city cyp on cyp.city_nr = ap.city_nr
            LEFT JOIN bsicrm.bsi_person pers on pers.person_nr = ec.person_nr
            LEFT JOIN bsicrm.bsi_uc_text tkam on tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tlf on tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tnc on tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
            LEFT JOIN bsicrm.bsi_uc_text tne on tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, Error Msg = ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert
ORA-06512: in "SYS.XMLTYPE", Zeile 138

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 14:59:47.990
!MESSAGE SQL-Fehler [936] [42000]: ORA-00936: Ausdruck fehlt

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 14:59:47.990
!MESSAGE Error : 936, Position : 7, Sql = SELECT FROM BSI_COMPANY WHERE COMPANY_NR = 10585312
, OriginalSql = SELECT FROM BSI_COMPANY WHERE COMPANY_NR = 10585312
, Error Msg = ORA-00936: Ausdruck fehlt

!STACK 0
Error : 936, Position : 7, Sql = SELECT FROM BSI_COMPANY WHERE COMPANY_NR = 10585312
, OriginalSql = SELECT FROM BSI_COMPANY WHERE COMPANY_NR = 10585312
, Error Msg = ORA-00936: Ausdruck fehlt

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 15:01:34.438
!MESSAGE SQL-Fehler [936] [42000]: ORA-00936: Ausdruck fehlt

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 15:01:34.438
!MESSAGE Error : 936, Position : 7, Sql = SELECT FROM BSI_X_EXT_RECEIPT WHERE JOIN_NR = 10585312
, OriginalSql = SELECT FROM BSI_X_EXT_RECEIPT WHERE JOIN_NR = 10585312
, Error Msg = ORA-00936: Ausdruck fehlt

!STACK 0
Error : 936, Position : 7, Sql = SELECT FROM BSI_X_EXT_RECEIPT WHERE JOIN_NR = 10585312
, OriginalSql = SELECT FROM BSI_X_EXT_RECEIPT WHERE JOIN_NR = 10585312
, Error Msg = ORA-00936: Ausdruck fehlt

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.eclipse.core.expressions 4 201 2019-10-31 15:46:41.041
!MESSAGE No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource
!STACK 1
org.eclipse.core.runtime.CoreException: No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource
	at org.eclipse.core.internal.expressions.TypeExtensionManager.getProperty(TypeExtensionManager.java:130)
	at org.eclipse.core.internal.expressions.TestExpression.evaluate(TestExpression.java:100)
	at org.eclipse.core.internal.expressions.CompositeExpression.evaluateAnd(CompositeExpression.java:55)
	at org.eclipse.core.internal.expressions.AndExpression.evaluate(AndExpression.java:34)
	at org.eclipse.ui.internal.dialogs.RegistryPageContributor.failsEnablement(RegistryPageContributor.java:309)
	at org.eclipse.ui.internal.dialogs.RegistryPageContributor.isApplicableTo(RegistryPageContributor.java:251)
	at org.eclipse.ui.internal.dialogs.PropertyPageContributorManager.getApplicableContributors(PropertyPageContributorManager.java:218)
	at org.eclipse.ui.dialogs.PreferencesUtil.hasPropertiesContributors(PreferencesUtil.java:305)
	at org.jkiss.dbeaver.ui.navigator.NavigatorUtils.lambda$0(NavigatorUtils.java:223)
	at org.eclipse.jface.action.MenuManager.fireAboutToShow(MenuManager.java:342)
	at org.eclipse.jface.action.MenuManager.handleAboutToShow(MenuManager.java:473)
	at org.eclipse.jface.action.MenuManager.access$1(MenuManager.java:468)
	at org.eclipse.jface.action.MenuManager$2.menuShown(MenuManager.java:500)
	at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:259)
	at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:89)
	at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4145)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1055)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1079)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1060)
	at org.eclipse.swt.widgets.Control.WM_INITMENUPOPUP(Control.java:5148)
	at org.eclipse.swt.widgets.Control.windowProc(Control.java:4797)
	at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:348)
	at org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1502)
	at org.eclipse.swt.widgets.Shell.windowProc(Shell.java:2162)
	at org.eclipse.swt.widgets.Display.windowProc(Display.java:4784)
	at org.eclipse.swt.internal.win32.OS.TrackPopupMenu(Native Method)
	at org.eclipse.swt.widgets.Menu._setVisible(Menu.java:253)
	at org.eclipse.swt.widgets.Display.runPopups(Display.java:3999)
	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3555)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$5.run(PartRenderingEngine.java:1173)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1062)
	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156)
	at org.eclipse.ui.internal.Workbench.lambda$3(Workbench.java:628)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:563)
	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:151)
	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:155)
	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:199)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:137)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:107)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:391)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:246)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:659)
	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:595)
	at org.eclipse.equinox.launcher.Main.run(Main.java:1501)
	at org.eclipse.equinox.launcher.Main.main(Main.java:1474)
!SUBENTRY 1 org.eclipse.core.expressions 4 201 2019-10-31 15:46:41.042
!MESSAGE No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource

!ENTRY org.eclipse.ui 4 0 2019-10-31 15:46:51.135
!MESSAGE Unhandled event loop exception
!STACK 0
java.lang.NullPointerException
	at org.eclipse.ui.texteditor.AbstractTextEditor$TextEditorSavable.isDirty(AbstractTextEditor.java:7119)
	at org.eclipse.ui.internal.SaveableHelper.waitForBackgroundSaveJobs(SaveableHelper.java:461)
	at org.eclipse.ui.internal.SaveablesList.promptForSaving(SaveablesList.java:605)
	at org.eclipse.ui.internal.SaveablesList.promptForSavingIfNecessary(SaveablesList.java:572)
	at org.eclipse.ui.internal.SaveablesList.preCloseParts(SaveablesList.java:528)
	at org.eclipse.ui.internal.SaveablesList.preCloseParts(SaveablesList.java:480)
	at org.eclipse.ui.internal.SaveablesList.preCloseParts(SaveablesList.java:475)
	at org.eclipse.ui.internal.WorkbenchWindow$5.save(WorkbenchWindow.java:600)
	at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.savePart(PartServiceImpl.java:1425)
	at org.eclipse.e4.ui.workbench.renderers.swt.StackRenderer.closePart(StackRenderer.java:1268)
	at org.eclipse.e4.ui.workbench.renderers.swt.StackRenderer.access$0(StackRenderer.java:1255)
	at org.eclipse.e4.ui.workbench.renderers.swt.StackRenderer$3.close(StackRenderer.java:1123)
	at org.eclipse.swt.custom.CTabFolder.onMouse(CTabFolder.java:1961)
	at org.eclipse.swt.custom.CTabFolder.lambda$0(CTabFolder.java:336)
	at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:89)
	at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4145)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1055)
	at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3958)
	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3561)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$5.run(PartRenderingEngine.java:1173)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1062)
	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156)
	at org.eclipse.ui.internal.Workbench.lambda$3(Workbench.java:628)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:563)
	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:151)
	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:155)
	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:199)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:137)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:107)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:391)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:246)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:659)
	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:595)
	at org.eclipse.equinox.launcher.Main.run(Main.java:1501)
	at org.eclipse.equinox.launcher.Main.main(Main.java:1474)

!ENTRY org.eclipse.core.expressions 4 201 2019-10-31 15:47:22.333
!MESSAGE No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource
!STACK 1
org.eclipse.core.runtime.CoreException: No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource
	at org.eclipse.core.internal.expressions.TypeExtensionManager.getProperty(TypeExtensionManager.java:130)
	at org.eclipse.core.internal.expressions.TestExpression.evaluate(TestExpression.java:100)
	at org.eclipse.core.internal.expressions.CompositeExpression.evaluateAnd(CompositeExpression.java:55)
	at org.eclipse.core.internal.expressions.AndExpression.evaluate(AndExpression.java:34)
	at org.eclipse.ui.internal.dialogs.RegistryPageContributor.failsEnablement(RegistryPageContributor.java:309)
	at org.eclipse.ui.internal.dialogs.RegistryPageContributor.isApplicableTo(RegistryPageContributor.java:251)
	at org.eclipse.ui.internal.dialogs.PropertyPageContributorManager.getApplicableContributors(PropertyPageContributorManager.java:218)
	at org.eclipse.ui.dialogs.PreferencesUtil.hasPropertiesContributors(PreferencesUtil.java:305)
	at org.jkiss.dbeaver.ui.navigator.NavigatorUtils.lambda$0(NavigatorUtils.java:223)
	at org.eclipse.jface.action.MenuManager.fireAboutToShow(MenuManager.java:342)
	at org.eclipse.jface.action.MenuManager.handleAboutToShow(MenuManager.java:473)
	at org.eclipse.jface.action.MenuManager.access$1(MenuManager.java:468)
	at org.eclipse.jface.action.MenuManager$2.menuShown(MenuManager.java:500)
	at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:259)
	at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:89)
	at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4145)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1055)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1079)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1060)
	at org.eclipse.swt.widgets.Control.WM_INITMENUPOPUP(Control.java:5148)
	at org.eclipse.swt.widgets.Control.windowProc(Control.java:4797)
	at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:348)
	at org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1502)
	at org.eclipse.swt.widgets.Shell.windowProc(Shell.java:2162)
	at org.eclipse.swt.widgets.Display.windowProc(Display.java:4784)
	at org.eclipse.swt.internal.win32.OS.TrackPopupMenu(Native Method)
	at org.eclipse.swt.widgets.Menu._setVisible(Menu.java:253)
	at org.eclipse.swt.widgets.Display.runPopups(Display.java:3999)
	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3555)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$5.run(PartRenderingEngine.java:1173)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1062)
	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156)
	at org.eclipse.ui.internal.Workbench.lambda$3(Workbench.java:628)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:563)
	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:151)
	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:155)
	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:199)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:137)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:107)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:391)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:246)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:659)
	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:595)
	at org.eclipse.equinox.launcher.Main.run(Main.java:1501)
	at org.eclipse.equinox.launcher.Main.main(Main.java:1474)
!SUBENTRY 1 org.eclipse.core.expressions 4 201 2019-10-31 15:47:22.333
!MESSAGE No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 17:39:41.262
!MESSAGE SQL-Fehler [904] [42000]: ORA-00904: "EC"."X_IS_LOCKED": ungültiger Bezeichner

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 17:39:41.262
!MESSAGE Error : 904, Position : 10829, Sql = WITH exported_companies AS (
				SELECT /*+ ordered use_hash(ejj ej company cc cc2 a sspa sspba) full(ejj) full(ej) full(company) full(cc) full(cc2) full(a) full(sspa) full(sspba) */
					company.x_complex_no,  -- accounts_samba
					TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
					company.language_uid,
					ejj.join_nr,
					dbms_lob.substr(comp_samba.join_nos_samba, 4000, 1 ) join_nos_samba,
					dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx, 
					sadr.fone,
					sadr.handy,
					sadr.fax,
					sadr.email,
					sadr.www,
					kam.kamtyp,
					CASE 
						WHEN cc2.relation_uid = 300 THEN 'Group'
						WHEN cc2.relation_uid = 109876 THEN 'Company' 
						WHEN cc.relation_uid  = 300 THEN 'Company'
						WHEN cc.relation_uid  = 109876 THEN 'Branch'
						ELSE 'Single Company' 
					END structure__c, 
					sspa.address_nr address_nr,
					sspba.address_nr pobox_address_nr,
					ship_a.ship_anr  ship_address_nr,
					ship_ap.ship_apnr ship_apo_nr,
					company.y_legal_status_uid, 
					company.x_advisory_status_uid,  
					collection.join_nr coll_join_nr,
					kuba_data.kuba_join_nr,
					COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
					CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
						'Email'
					WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
						'Letter'
					WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
						'n.a.'
					END Communication_Channel__c
				FROM bsicrm.bsi_x_ext_join_join ejj
					JOIN bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
						AND ej.active = 1
					JOIN bsicrm.bsi_company company ON company.company_nr = ejj.join_nr 
						AND company.is_active = 1
					LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
					LEFT JOIN bsicrm.bsi_company_company cc ON cc.company_nr = ejj.join_nr
					LEFT JOIN (
						SELECT 
							cc2.group_company_nr, 
							MIN(cc2.relation_uid) relation_uid
						FROM bsicrm.bsi_company_company cc2 
						GROUP BY cc2.group_company_nr
					) cc2 ON cc2.group_company_nr = ejj.join_nr     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							MIN(ej2.kam_uid) kamtyp, 
							ejj2.join_nr innerjnr
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                     
						WHERE ej2.active = 1
						AND ej2.kam_uid != 0
						GROUP BY ejj2.join_nr
					) kam ON kam.innerjnr = ejj.join_nr  
					LEFT JOIN (
						SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
							adr.item_key0_nr,
							max (CASE WHEN adr.channel_uid = 113638 THEN adr.channel_value ELSE NULL END) fone,
							max (CASE WHEN adr.channel_uid = 113640 THEN adr.channel_value ELSE NULL END) handy,
							max (CASE WHEN adr.channel_uid = 113639 THEN adr.channel_value ELSE NULL END) fax,
							max (CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
							max (CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
						FROM bsicrm.bsi_address adr
							JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
							JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr and ej2.active = 1 AND ej2.interface_uid IN (108187,108205)
						WHERE adr.is_default_address = 1
							AND adr.item_type_id = 318594
						GROUP BY adr.item_key0_nr
					) sadr ON sadr.item_key0_nr = company.company_nr
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa ON  sspa.ext_join_nr = ejj.ext_join_nr
						AND sspa.join_type_uid = 318594
						AND sspa.type_uid = 2315 /* Hauptadresse */
						AND sspa.channel_uid = 113688
						AND sspa.join_nr = ejj.join_nr             
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba ON  sspba.ext_join_nr = ejj.ext_join_nr
						AND sspba.join_type_uid = 318594
						AND sspba.type_uid = 108240 /* Postfach */
						AND sspba.channel_uid = 113688
						AND sspba.join_nr = ejj.join_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_a au) full(ship_a) full(au) */
							ship_a.join_nr, 
							max (ship_a.address_nr )ship_aNr
						FROM bsicrm.bsi_x_address_mapping ship_a
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_a.address_nr
							AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_a.join_type_uid = 318594
							AND ship_a.channel_uid = 113688
							-- 2315:	Hauptadresse
							-- 108363:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedCode
							AND (ship_a.type_uid = 2315 OR  ship_a.type_uid = 108363)
						GROUP BY ship_a.join_nr
					) ship_a ON ship_a.join_nr = ejj.join_nr                     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_ap au) full(ship_ap) full(au) */
							ship_ap.join_nr, 
							max (ship_ap.address_nr ) ship_apnr
						FROM bsicrm.bsi_x_address_mapping ship_ap
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_ap.address_nr
								AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_ap.join_type_uid = 318594
							AND ship_ap.channel_uid = 113688
							-- 108240:	Postfach
							-- 108364:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedPoBoxCode
							AND (ship_ap.type_uid = 108240 OR  ship_ap.type_uid = 108364)
						GROUP BY ship_ap.join_nr
					) ship_ap ON  ship_ap.join_nr = ejj.join_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
							max (kd.join_nr) kuba_join_nr, 
							ejj2.join_nr             
						FROM bsicrm.bsi_x_ext_kuba_data kd
						JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr 
							AND ej2.ext_join_type_uid = kd.join_type_uid AND ej2.active = 1
						JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr 
							AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
						WHERE kd.status_uid = 4800511372 --aktiv  
						GROUP BY ejj2.join_nr
					) kuba_data ON kuba_data.join_nr = company.company_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
							DISTINCT ejjinner.join_nr 
						FROM bsicrm.bsi_x_collection coll 
							JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr 
								AND ejinner.active = 1
							JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
						WHERE coll.status_uid <> 137824
					) collection ON collection.join_nr = company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_samba
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108187
						GROUP BY ejj2.join_nr
					) comp_samba ON comp_samba.join_nr =  company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108205
						GROUP BY ejj2.join_nr
					) comp_nx ON comp_nx.join_nr =  company.company_nr  
				WHERE  ejj.is_master = 1
					AND    ejj.ext_join_type_uid = 108224
					AND    ej.interface_uid  = 108187 --samba      
			),
			dunning AS (
				SELECT /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
					distinct ejj.join_nr -- company.x_complex_no                    
				FROM bsicrm.bsi_x_ext_receipt xrcp
					JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr
						AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
					JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid
				WHERE xrcp.overdue_level_uid IN (137663,137664,137665) 
			)  
			SELECT /*+ ordered use_hash(kuba dnng legaladdr cy ap gt cyp shipping_addr shipping_apo cy_sh_po gt_sh_po cy_shipping tkam tlf tnc tne) 
                   full(kuba) full(dnng) full(legaladdr) full(cy) full(ap) full(gt) full(cyp) full(shipping_addr) full(shipping_apo) full(cy_sh_po) full(gt_sh_po) full(cy_shipping) full(tkam) full(tlf) full(tnc) full(tne) */
				distinct ec.x_complex_no uk_LCM_X_COMPLEX_NO__c,
				ec.NAME,
				ec.join_nos_samba LCM_Samba_MergeIDs__c,
				ec.join_nos_nx LCM_NX_MergeIDs__c,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%'  
				THEN  NULL
				ELSE ec.fone           
				END Phone,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%' 
				THEN  ec.fone
				ELSE ec.handy           
				END MobilePhone, 
				ec.fax fax, 
				CASE WHEN ec.email LIKE 'etv@%' THEN  NULL
				ELSE ec.email           
				END email__c,
				ec.www website,
				NVL(RTRIM (legaladdr.x_street_name||' '||legaladdr.x_street_house_no), legaladdr.postal_display_street) legalstreet, 
				cy.zip_code LegalPostalCode,
				cy.city legalcity,
				CASE WHEN cy.state IS NULL THEN 
					cyp.state
				ELSE 
					cy.state 
				END LegalState,  
				CASE WHEN cy.country_uid IS NULL THEN 
					DECODE (cyp.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein')
				else 
					DECODE (cy.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein') 
				END legalcountry, 
				gt.text P_O_Box__c,
				cyp.zip_code P_O_BoxPostalCode__c,
				cyp.city p_o_boxcity__c, 
				DECODE (ec.language_uid, 
					246, 'German', 
					1303, 'English', 
					7770, 'French', 
					7771, 'Italian', '?'
				) PreferedLanguage__c,
				ec.structure__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,  
				regexp_replace(
					coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), '^([^0-9]*) (\d+[a-zA-Z]{0,3})?$', '\1') 
					||  ' ' 
					|| nvl(shipping_addr.x_street_house_no, 
						ltrim(regexp_substr(
							coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), ' (\d+[a-zA-Z]{0,3})?$')
						)
				)  Shippingstreet, 
				cy_shipping.zip_code Shippingpostalcode,
				cy_shipping.city shippingcity, 
				cy_shipping.state ShippingState,
				DECODE (cy_shipping.country_uid, 
					1001148, 'Schweiz', 
					1001161, 'Deutschland', 
					1001179, 'Frankreich', 
					1001215, 'Italien', 
					1001234, 'Liechtenstein'
				) ShippingCountry,
				gt_sh_po.text ShippingP_O_Box__c,
				cy_sh_po.zip_code ShippingP_O_Box_PostalCode__c, 
				cy_sh_po.city ShippingP_O_BoxCity__c,
				DECODE (ec.x_advisory_status_uid, 
					117411, 'Fieldsales', 
					117413, 'KAM-Fieldsales'
				) SalesChannel__c,
				tkam.text KAMType__c, 
				CASE 
					WHEN kuba.legal_form_uid IS NOT NULL THEN
						REPLACE (tlf.text, 'K' || chr(50108) || 'Ba: ', '') 
					WHEN ec.y_legal_status_uid  <> 0 THEN 
						DECODE (ec.y_legal_status_uid, 
							875976469, 'AG', 
							875976471, 'Einzelunternehmen', 
							875976476, 'Genossenschaft', 
							875976472, 'GmbH', 
							875976474, 'Kollektivgesellschaft', 
							5714572491, 'Kommanditgesellschaft', 
							875976464, 'Stiftung', 
							875976459, 'Verein', 
							null
						)  
				END legalentity__c, 
				kuba.federal_company_id UID__c,
				tnc.text noga1__c,
				CASE WHEN kuba.founding_year = 0 THEN NULL
				ELSE kuba.founding_year
				END  CompanySince__c,
				CASE 
					WHEN kuba.turnover BETWEEN 2000001 AND 99999999 THEN  'A'
					WHEN kuba.turnover BETWEEN 1000001 AND 2000000 THEN  'B'
					WHEN kuba.turnover BETWEEN 200001 AND 1000000 THEN  'C'           
					WHEN kuba.turnover BETWEEN 5001 AND 200000 THEN  'D'             
				END TurnoverClass__c,
				tne.text NumberOfEmployees,
				EC.Allowed_comm_channel__c,
				EC.Communication_Channel__c
			FROM exported_companies ec
				LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
				LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr
				LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
				LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
				LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
				LEFT JOIN bsicrm.bsi_global_text gt ON gt.global_text_nr = AP.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cyp ON cyp.city_nr = AP.city_nr
				LEFT JOIN bsicrm.bsi_address shipping_addr ON shipping_addr.address_nr = ec.ship_address_nr
				LEFT JOIN bsicrm.bsi_address shipping_apo ON shipping_apo.address_nr = ec.ship_apo_nr
				LEFT JOIN bsicrm.bsi_city cy_sh_po ON cy_sh_po.city_nr = shipping_apo.city_nr
				LEFT JOIN bsicrm.bsi_global_text gt_sh_po ON gt_sh_po.global_text_nr = shipping_apo.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cy_shipping ON cy_shipping.city_nr = shipping_addr.city_nr
				LEFT JOIN bsicrm.bsi_uc_text tkam ON tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tlf ON tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tnc ON tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tne ON tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, OriginalSql = WITH exported_companies AS (
				SELECT /*+ ordered use_hash(ejj ej company cc cc2 a sspa sspba) full(ejj) full(ej) full(company) full(cc) full(cc2) full(a) full(sspa) full(sspba) */
					company.x_complex_no,  -- accounts_samba
					TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
					company.language_uid,
					ejj.join_nr,
					dbms_lob.substr(comp_samba.join_nos_samba, 4000, 1 ) join_nos_samba,
					dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx, 
					sadr.fone,
					sadr.handy,
					sadr.fax,
					sadr.email,
					sadr.www,
					kam.kamtyp,
					CASE 
						WHEN cc2.relation_uid = 300 THEN 'Group'
						WHEN cc2.relation_uid = 109876 THEN 'Company' 
						WHEN cc.relation_uid  = 300 THEN 'Company'
						WHEN cc.relation_uid  = 109876 THEN 'Branch'
						ELSE 'Single Company' 
					END structure__c, 
					sspa.address_nr address_nr,
					sspba.address_nr pobox_address_nr,
					ship_a.ship_anr  ship_address_nr,
					ship_ap.ship_apnr ship_apo_nr,
					company.y_legal_status_uid, 
					company.x_advisory_status_uid,  
					collection.join_nr coll_join_nr,
					kuba_data.kuba_join_nr,
					COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
					CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
						'Email'
					WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
						'Letter'
					WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
						'n.a.'
					END Communication_Channel__c
				FROM bsicrm.bsi_x_ext_join_join ejj
					JOIN bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
						AND ej.active = 1
					JOIN bsicrm.bsi_company company ON company.company_nr = ejj.join_nr 
						AND company.is_active = 1
					LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
					LEFT JOIN bsicrm.bsi_company_company cc ON cc.company_nr = ejj.join_nr
					LEFT JOIN (
						SELECT 
							cc2.group_company_nr, 
							MIN(cc2.relation_uid) relation_uid
						FROM bsicrm.bsi_company_company cc2 
						GROUP BY cc2.group_company_nr
					) cc2 ON cc2.group_company_nr = ejj.join_nr     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							MIN(ej2.kam_uid) kamtyp, 
							ejj2.join_nr innerjnr
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                     
						WHERE ej2.active = 1
						AND ej2.kam_uid != 0
						GROUP BY ejj2.join_nr
					) kam ON kam.innerjnr = ejj.join_nr  
					LEFT JOIN (
						SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
							adr.item_key0_nr,
							max (CASE WHEN adr.channel_uid = 113638 THEN adr.channel_value ELSE NULL END) fone,
							max (CASE WHEN adr.channel_uid = 113640 THEN adr.channel_value ELSE NULL END) handy,
							max (CASE WHEN adr.channel_uid = 113639 THEN adr.channel_value ELSE NULL END) fax,
							max (CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
							max (CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
						FROM bsicrm.bsi_address adr
							JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
							JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr and ej2.active = 1 AND ej2.interface_uid IN (108187,108205)
						WHERE adr.is_default_address = 1
							AND adr.item_type_id = 318594
						GROUP BY adr.item_key0_nr
					) sadr ON sadr.item_key0_nr = company.company_nr
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa ON  sspa.ext_join_nr = ejj.ext_join_nr
						AND sspa.join_type_uid = 318594
						AND sspa.type_uid = 2315 /* Hauptadresse */
						AND sspa.channel_uid = 113688
						AND sspa.join_nr = ejj.join_nr             
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba ON  sspba.ext_join_nr = ejj.ext_join_nr
						AND sspba.join_type_uid = 318594
						AND sspba.type_uid = 108240 /* Postfach */
						AND sspba.channel_uid = 113688
						AND sspba.join_nr = ejj.join_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_a au) full(ship_a) full(au) */
							ship_a.join_nr, 
							max (ship_a.address_nr )ship_aNr
						FROM bsicrm.bsi_x_address_mapping ship_a
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_a.address_nr
							AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_a.join_type_uid = 318594
							AND ship_a.channel_uid = 113688
							-- 2315:	Hauptadresse
							-- 108363:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedCode
							AND (ship_a.type_uid = 2315 OR  ship_a.type_uid = 108363)
						GROUP BY ship_a.join_nr
					) ship_a ON ship_a.join_nr = ejj.join_nr                     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_ap au) full(ship_ap) full(au) */
							ship_ap.join_nr, 
							max (ship_ap.address_nr ) ship_apnr
						FROM bsicrm.bsi_x_address_mapping ship_ap
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_ap.address_nr
								AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_ap.join_type_uid = 318594
							AND ship_ap.channel_uid = 113688
							-- 108240:	Postfach
							-- 108364:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedPoBoxCode
							AND (ship_ap.type_uid = 108240 OR  ship_ap.type_uid = 108364)
						GROUP BY ship_ap.join_nr
					) ship_ap ON  ship_ap.join_nr = ejj.join_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
							max (kd.join_nr) kuba_join_nr, 
							ejj2.join_nr             
						FROM bsicrm.bsi_x_ext_kuba_data kd
						JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr 
							AND ej2.ext_join_type_uid = kd.join_type_uid AND ej2.active = 1
						JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr 
							AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
						WHERE kd.status_uid = 4800511372 --aktiv  
						GROUP BY ejj2.join_nr
					) kuba_data ON kuba_data.join_nr = company.company_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
							DISTINCT ejjinner.join_nr 
						FROM bsicrm.bsi_x_collection coll 
							JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr 
								AND ejinner.active = 1
							JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
						WHERE coll.status_uid <> 137824
					) collection ON collection.join_nr = company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_samba
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108187
						GROUP BY ejj2.join_nr
					) comp_samba ON comp_samba.join_nr =  company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108205
						GROUP BY ejj2.join_nr
					) comp_nx ON comp_nx.join_nr =  company.company_nr  
				WHERE  ejj.is_master = 1
					AND    ejj.ext_join_type_uid = 108224
					AND    ej.interface_uid  = 108187 --samba      
			),
			dunning AS (
				SELECT /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
					distinct ejj.join_nr -- company.x_complex_no                    
				FROM bsicrm.bsi_x_ext_receipt xrcp
					JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr
						AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
					JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid
				WHERE xrcp.overdue_level_uid IN (137663,137664,137665) 
			)  
			SELECT /*+ ordered use_hash(kuba dnng legaladdr cy ap gt cyp shipping_addr shipping_apo cy_sh_po gt_sh_po cy_shipping tkam tlf tnc tne) 
                   full(kuba) full(dnng) full(legaladdr) full(cy) full(ap) full(gt) full(cyp) full(shipping_addr) full(shipping_apo) full(cy_sh_po) full(gt_sh_po) full(cy_shipping) full(tkam) full(tlf) full(tnc) full(tne) */
				distinct ec.x_complex_no uk_LCM_X_COMPLEX_NO__c,
				ec.NAME,
				ec.join_nos_samba LCM_Samba_MergeIDs__c,
				ec.join_nos_nx LCM_NX_MergeIDs__c,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%'  
				THEN  NULL
				ELSE ec.fone           
				END Phone,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%' 
				THEN  ec.fone
				ELSE ec.handy           
				END MobilePhone, 
				ec.fax fax, 
				CASE WHEN ec.email LIKE 'etv@%' THEN  NULL
				ELSE ec.email           
				END email__c,
				ec.www website,
				NVL(RTRIM (legaladdr.x_street_name||' '||legaladdr.x_street_house_no), legaladdr.postal_display_street) legalstreet, 
				cy.zip_code LegalPostalCode,
				cy.city legalcity,
				CASE WHEN cy.state IS NULL THEN 
					cyp.state
				ELSE 
					cy.state 
				END LegalState,  
				CASE WHEN cy.country_uid IS NULL THEN 
					DECODE (cyp.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein')
				else 
					DECODE (cy.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein') 
				END legalcountry, 
				gt.text P_O_Box__c,
				cyp.zip_code P_O_BoxPostalCode__c,
				cyp.city p_o_boxcity__c, 
				DECODE (ec.language_uid, 
					246, 'German', 
					1303, 'English', 
					7770, 'French', 
					7771, 'Italian', '?'
				) PreferedLanguage__c,
				ec.structure__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,  
				regexp_replace(
					coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), '^([^0-9]*) (\d+[a-zA-Z]{0,3})?$', '\1') 
					||  ' ' 
					|| nvl(shipping_addr.x_street_house_no, 
						ltrim(regexp_substr(
							coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), ' (\d+[a-zA-Z]{0,3})?$')
						)
				)  Shippingstreet, 
				cy_shipping.zip_code Shippingpostalcode,
				cy_shipping.city shippingcity, 
				cy_shipping.state ShippingState,
				DECODE (cy_shipping.country_uid, 
					1001148, 'Schweiz', 
					1001161, 'Deutschland', 
					1001179, 'Frankreich', 
					1001215, 'Italien', 
					1001234, 'Liechtenstein'
				) ShippingCountry,
				gt_sh_po.text ShippingP_O_Box__c,
				cy_sh_po.zip_code ShippingP_O_Box_PostalCode__c, 
				cy_sh_po.city ShippingP_O_BoxCity__c,
				DECODE (ec.x_advisory_status_uid, 
					117411, 'Fieldsales', 
					117413, 'KAM-Fieldsales'
				) SalesChannel__c,
				tkam.text KAMType__c, 
				CASE 
					WHEN kuba.legal_form_uid IS NOT NULL THEN
						REPLACE (tlf.text, 'K' || chr(50108) || 'Ba: ', '') 
					WHEN ec.y_legal_status_uid  <> 0 THEN 
						DECODE (ec.y_legal_status_uid, 
							875976469, 'AG', 
							875976471, 'Einzelunternehmen', 
							875976476, 'Genossenschaft', 
							875976472, 'GmbH', 
							875976474, 'Kollektivgesellschaft', 
							5714572491, 'Kommanditgesellschaft', 
							875976464, 'Stiftung', 
							875976459, 'Verein', 
							null
						)  
				END legalentity__c, 
				kuba.federal_company_id UID__c,
				tnc.text noga1__c,
				CASE WHEN kuba.founding_year = 0 THEN NULL
				ELSE kuba.founding_year
				END  CompanySince__c,
				CASE 
					WHEN kuba.turnover BETWEEN 2000001 AND 99999999 THEN  'A'
					WHEN kuba.turnover BETWEEN 1000001 AND 2000000 THEN  'B'
					WHEN kuba.turnover BETWEEN 200001 AND 1000000 THEN  'C'           
					WHEN kuba.turnover BETWEEN 5001 AND 200000 THEN  'D'             
				END TurnoverClass__c,
				tne.text NumberOfEmployees,
				EC.Allowed_comm_channel__c,
				EC.Communication_Channel__c
			FROM exported_companies ec
				LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
				LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr
				LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
				LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
				LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
				LEFT JOIN bsicrm.bsi_global_text gt ON gt.global_text_nr = AP.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cyp ON cyp.city_nr = AP.city_nr
				LEFT JOIN bsicrm.bsi_address shipping_addr ON shipping_addr.address_nr = ec.ship_address_nr
				LEFT JOIN bsicrm.bsi_address shipping_apo ON shipping_apo.address_nr = ec.ship_apo_nr
				LEFT JOIN bsicrm.bsi_city cy_sh_po ON cy_sh_po.city_nr = shipping_apo.city_nr
				LEFT JOIN bsicrm.bsi_global_text gt_sh_po ON gt_sh_po.global_text_nr = shipping_apo.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cy_shipping ON cy_shipping.city_nr = shipping_addr.city_nr
				LEFT JOIN bsicrm.bsi_uc_text tkam ON tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tlf ON tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tnc ON tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tne ON tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, Error Msg = ORA-00904: "EC"."X_IS_LOCKED": ungültiger Bezeichner

!STACK 0
Error : 904, Position : 10829, Sql = WITH exported_companies AS (
				SELECT /*+ ordered use_hash(ejj ej company cc cc2 a sspa sspba) full(ejj) full(ej) full(company) full(cc) full(cc2) full(a) full(sspa) full(sspba) */
					company.x_complex_no,  -- accounts_samba
					TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
					company.language_uid,
					ejj.join_nr,
					dbms_lob.substr(comp_samba.join_nos_samba, 4000, 1 ) join_nos_samba,
					dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx, 
					sadr.fone,
					sadr.handy,
					sadr.fax,
					sadr.email,
					sadr.www,
					kam.kamtyp,
					CASE 
						WHEN cc2.relation_uid = 300 THEN 'Group'
						WHEN cc2.relation_uid = 109876 THEN 'Company' 
						WHEN cc.relation_uid  = 300 THEN 'Company'
						WHEN cc.relation_uid  = 109876 THEN 'Branch'
						ELSE 'Single Company' 
					END structure__c, 
					sspa.address_nr address_nr,
					sspba.address_nr pobox_address_nr,
					ship_a.ship_anr  ship_address_nr,
					ship_ap.ship_apnr ship_apo_nr,
					company.y_legal_status_uid, 
					company.x_advisory_status_uid,  
					collection.join_nr coll_join_nr,
					kuba_data.kuba_join_nr,
					COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
					CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
						'Email'
					WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
						'Letter'
					WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
						'n.a.'
					END Communication_Channel__c
				FROM bsicrm.bsi_x_ext_join_join ejj
					JOIN bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
						AND ej.active = 1
					JOIN bsicrm.bsi_company company ON company.company_nr = ejj.join_nr 
						AND company.is_active = 1
					LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
					LEFT JOIN bsicrm.bsi_company_company cc ON cc.company_nr = ejj.join_nr
					LEFT JOIN (
						SELECT 
							cc2.group_company_nr, 
							MIN(cc2.relation_uid) relation_uid
						FROM bsicrm.bsi_company_company cc2 
						GROUP BY cc2.group_company_nr
					) cc2 ON cc2.group_company_nr = ejj.join_nr     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							MIN(ej2.kam_uid) kamtyp, 
							ejj2.join_nr innerjnr
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                     
						WHERE ej2.active = 1
						AND ej2.kam_uid != 0
						GROUP BY ejj2.join_nr
					) kam ON kam.innerjnr = ejj.join_nr  
					LEFT JOIN (
						SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
							adr.item_key0_nr,
							max (CASE WHEN adr.channel_uid = 113638 THEN adr.channel_value ELSE NULL END) fone,
							max (CASE WHEN adr.channel_uid = 113640 THEN adr.channel_value ELSE NULL END) handy,
							max (CASE WHEN adr.channel_uid = 113639 THEN adr.channel_value ELSE NULL END) fax,
							max (CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
							max (CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
						FROM bsicrm.bsi_address adr
							JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
							JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr and ej2.active = 1 AND ej2.interface_uid IN (108187,108205)
						WHERE adr.is_default_address = 1
							AND adr.item_type_id = 318594
						GROUP BY adr.item_key0_nr
					) sadr ON sadr.item_key0_nr = company.company_nr
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa ON  sspa.ext_join_nr = ejj.ext_join_nr
						AND sspa.join_type_uid = 318594
						AND sspa.type_uid = 2315 /* Hauptadresse */
						AND sspa.channel_uid = 113688
						AND sspa.join_nr = ejj.join_nr             
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba ON  sspba.ext_join_nr = ejj.ext_join_nr
						AND sspba.join_type_uid = 318594
						AND sspba.type_uid = 108240 /* Postfach */
						AND sspba.channel_uid = 113688
						AND sspba.join_nr = ejj.join_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_a au) full(ship_a) full(au) */
							ship_a.join_nr, 
							max (ship_a.address_nr )ship_aNr
						FROM bsicrm.bsi_x_address_mapping ship_a
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_a.address_nr
							AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_a.join_type_uid = 318594
							AND ship_a.channel_uid = 113688
							-- 2315:	Hauptadresse
							-- 108363:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedCode
							AND (ship_a.type_uid = 2315 OR  ship_a.type_uid = 108363)
						GROUP BY ship_a.join_nr
					) ship_a ON ship_a.join_nr = ejj.join_nr                     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_ap au) full(ship_ap) full(au) */
							ship_ap.join_nr, 
							max (ship_ap.address_nr ) ship_apnr
						FROM bsicrm.bsi_x_address_mapping ship_ap
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_ap.address_nr
								AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_ap.join_type_uid = 318594
							AND ship_ap.channel_uid = 113688
							-- 108240:	Postfach
							-- 108364:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedPoBoxCode
							AND (ship_ap.type_uid = 108240 OR  ship_ap.type_uid = 108364)
						GROUP BY ship_ap.join_nr
					) ship_ap ON  ship_ap.join_nr = ejj.join_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
							max (kd.join_nr) kuba_join_nr, 
							ejj2.join_nr             
						FROM bsicrm.bsi_x_ext_kuba_data kd
						JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr 
							AND ej2.ext_join_type_uid = kd.join_type_uid AND ej2.active = 1
						JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr 
							AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
						WHERE kd.status_uid = 4800511372 --aktiv  
						GROUP BY ejj2.join_nr
					) kuba_data ON kuba_data.join_nr = company.company_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
							DISTINCT ejjinner.join_nr 
						FROM bsicrm.bsi_x_collection coll 
							JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr 
								AND ejinner.active = 1
							JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
						WHERE coll.status_uid <> 137824
					) collection ON collection.join_nr = company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_samba
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108187
						GROUP BY ejj2.join_nr
					) comp_samba ON comp_samba.join_nr =  company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108205
						GROUP BY ejj2.join_nr
					) comp_nx ON comp_nx.join_nr =  company.company_nr  
				WHERE  ejj.is_master = 1
					AND    ejj.ext_join_type_uid = 108224
					AND    ej.interface_uid  = 108187 --samba      
			),
			dunning AS (
				SELECT /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
					distinct ejj.join_nr -- company.x_complex_no                    
				FROM bsicrm.bsi_x_ext_receipt xrcp
					JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr
						AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
					JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid
				WHERE xrcp.overdue_level_uid IN (137663,137664,137665) 
			)  
			SELECT /*+ ordered use_hash(kuba dnng legaladdr cy ap gt cyp shipping_addr shipping_apo cy_sh_po gt_sh_po cy_shipping tkam tlf tnc tne) 
                   full(kuba) full(dnng) full(legaladdr) full(cy) full(ap) full(gt) full(cyp) full(shipping_addr) full(shipping_apo) full(cy_sh_po) full(gt_sh_po) full(cy_shipping) full(tkam) full(tlf) full(tnc) full(tne) */
				distinct ec.x_complex_no uk_LCM_X_COMPLEX_NO__c,
				ec.NAME,
				ec.join_nos_samba LCM_Samba_MergeIDs__c,
				ec.join_nos_nx LCM_NX_MergeIDs__c,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%'  
				THEN  NULL
				ELSE ec.fone           
				END Phone,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%' 
				THEN  ec.fone
				ELSE ec.handy           
				END MobilePhone, 
				ec.fax fax, 
				CASE WHEN ec.email LIKE 'etv@%' THEN  NULL
				ELSE ec.email           
				END email__c,
				ec.www website,
				NVL(RTRIM (legaladdr.x_street_name||' '||legaladdr.x_street_house_no), legaladdr.postal_display_street) legalstreet, 
				cy.zip_code LegalPostalCode,
				cy.city legalcity,
				CASE WHEN cy.state IS NULL THEN 
					cyp.state
				ELSE 
					cy.state 
				END LegalState,  
				CASE WHEN cy.country_uid IS NULL THEN 
					DECODE (cyp.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein')
				else 
					DECODE (cy.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein') 
				END legalcountry, 
				gt.text P_O_Box__c,
				cyp.zip_code P_O_BoxPostalCode__c,
				cyp.city p_o_boxcity__c, 
				DECODE (ec.language_uid, 
					246, 'German', 
					1303, 'English', 
					7770, 'French', 
					7771, 'Italian', '?'
				) PreferedLanguage__c,
				ec.structure__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,  
				regexp_replace(
					coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), '^([^0-9]*) (\d+[a-zA-Z]{0,3})?$', '\1') 
					||  ' ' 
					|| nvl(shipping_addr.x_street_house_no, 
						ltrim(regexp_substr(
							coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), ' (\d+[a-zA-Z]{0,3})?$')
						)
				)  Shippingstreet, 
				cy_shipping.zip_code Shippingpostalcode,
				cy_shipping.city shippingcity, 
				cy_shipping.state ShippingState,
				DECODE (cy_shipping.country_uid, 
					1001148, 'Schweiz', 
					1001161, 'Deutschland', 
					1001179, 'Frankreich', 
					1001215, 'Italien', 
					1001234, 'Liechtenstein'
				) ShippingCountry,
				gt_sh_po.text ShippingP_O_Box__c,
				cy_sh_po.zip_code ShippingP_O_Box_PostalCode__c, 
				cy_sh_po.city ShippingP_O_BoxCity__c,
				DECODE (ec.x_advisory_status_uid, 
					117411, 'Fieldsales', 
					117413, 'KAM-Fieldsales'
				) SalesChannel__c,
				tkam.text KAMType__c, 
				CASE 
					WHEN kuba.legal_form_uid IS NOT NULL THEN
						REPLACE (tlf.text, 'K' || chr(50108) || 'Ba: ', '') 
					WHEN ec.y_legal_status_uid  <> 0 THEN 
						DECODE (ec.y_legal_status_uid, 
							875976469, 'AG', 
							875976471, 'Einzelunternehmen', 
							875976476, 'Genossenschaft', 
							875976472, 'GmbH', 
							875976474, 'Kollektivgesellschaft', 
							5714572491, 'Kommanditgesellschaft', 
							875976464, 'Stiftung', 
							875976459, 'Verein', 
							null
						)  
				END legalentity__c, 
				kuba.federal_company_id UID__c,
				tnc.text noga1__c,
				CASE WHEN kuba.founding_year = 0 THEN NULL
				ELSE kuba.founding_year
				END  CompanySince__c,
				CASE 
					WHEN kuba.turnover BETWEEN 2000001 AND 99999999 THEN  'A'
					WHEN kuba.turnover BETWEEN 1000001 AND 2000000 THEN  'B'
					WHEN kuba.turnover BETWEEN 200001 AND 1000000 THEN  'C'           
					WHEN kuba.turnover BETWEEN 5001 AND 200000 THEN  'D'             
				END TurnoverClass__c,
				tne.text NumberOfEmployees,
				EC.Allowed_comm_channel__c,
				EC.Communication_Channel__c
			FROM exported_companies ec
				LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
				LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr
				LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
				LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
				LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
				LEFT JOIN bsicrm.bsi_global_text gt ON gt.global_text_nr = AP.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cyp ON cyp.city_nr = AP.city_nr
				LEFT JOIN bsicrm.bsi_address shipping_addr ON shipping_addr.address_nr = ec.ship_address_nr
				LEFT JOIN bsicrm.bsi_address shipping_apo ON shipping_apo.address_nr = ec.ship_apo_nr
				LEFT JOIN bsicrm.bsi_city cy_sh_po ON cy_sh_po.city_nr = shipping_apo.city_nr
				LEFT JOIN bsicrm.bsi_global_text gt_sh_po ON gt_sh_po.global_text_nr = shipping_apo.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cy_shipping ON cy_shipping.city_nr = shipping_addr.city_nr
				LEFT JOIN bsicrm.bsi_uc_text tkam ON tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tlf ON tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tnc ON tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tne ON tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, OriginalSql = WITH exported_companies AS (
				SELECT /*+ ordered use_hash(ejj ej company cc cc2 a sspa sspba) full(ejj) full(ej) full(company) full(cc) full(cc2) full(a) full(sspa) full(sspba) */
					company.x_complex_no,  -- accounts_samba
					TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
					company.language_uid,
					ejj.join_nr,
					dbms_lob.substr(comp_samba.join_nos_samba, 4000, 1 ) join_nos_samba,
					dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx, 
					sadr.fone,
					sadr.handy,
					sadr.fax,
					sadr.email,
					sadr.www,
					kam.kamtyp,
					CASE 
						WHEN cc2.relation_uid = 300 THEN 'Group'
						WHEN cc2.relation_uid = 109876 THEN 'Company' 
						WHEN cc.relation_uid  = 300 THEN 'Company'
						WHEN cc.relation_uid  = 109876 THEN 'Branch'
						ELSE 'Single Company' 
					END structure__c, 
					sspa.address_nr address_nr,
					sspba.address_nr pobox_address_nr,
					ship_a.ship_anr  ship_address_nr,
					ship_ap.ship_apnr ship_apo_nr,
					company.y_legal_status_uid, 
					company.x_advisory_status_uid,  
					collection.join_nr coll_join_nr,
					kuba_data.kuba_join_nr,
					COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
					CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
						'Email'
					WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
						'Letter'
					WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
						'n.a.'
					END Communication_Channel__c
				FROM bsicrm.bsi_x_ext_join_join ejj
					JOIN bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
						AND ej.active = 1
					JOIN bsicrm.bsi_company company ON company.company_nr = ejj.join_nr 
						AND company.is_active = 1
					LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
					LEFT JOIN bsicrm.bsi_company_company cc ON cc.company_nr = ejj.join_nr
					LEFT JOIN (
						SELECT 
							cc2.group_company_nr, 
							MIN(cc2.relation_uid) relation_uid
						FROM bsicrm.bsi_company_company cc2 
						GROUP BY cc2.group_company_nr
					) cc2 ON cc2.group_company_nr = ejj.join_nr     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							MIN(ej2.kam_uid) kamtyp, 
							ejj2.join_nr innerjnr
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                     
						WHERE ej2.active = 1
						AND ej2.kam_uid != 0
						GROUP BY ejj2.join_nr
					) kam ON kam.innerjnr = ejj.join_nr  
					LEFT JOIN (
						SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
							adr.item_key0_nr,
							max (CASE WHEN adr.channel_uid = 113638 THEN adr.channel_value ELSE NULL END) fone,
							max (CASE WHEN adr.channel_uid = 113640 THEN adr.channel_value ELSE NULL END) handy,
							max (CASE WHEN adr.channel_uid = 113639 THEN adr.channel_value ELSE NULL END) fax,
							max (CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
							max (CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
						FROM bsicrm.bsi_address adr
							JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
							JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr and ej2.active = 1 AND ej2.interface_uid IN (108187,108205)
						WHERE adr.is_default_address = 1
							AND adr.item_type_id = 318594
						GROUP BY adr.item_key0_nr
					) sadr ON sadr.item_key0_nr = company.company_nr
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa ON  sspa.ext_join_nr = ejj.ext_join_nr
						AND sspa.join_type_uid = 318594
						AND sspa.type_uid = 2315 /* Hauptadresse */
						AND sspa.channel_uid = 113688
						AND sspa.join_nr = ejj.join_nr             
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba ON  sspba.ext_join_nr = ejj.ext_join_nr
						AND sspba.join_type_uid = 318594
						AND sspba.type_uid = 108240 /* Postfach */
						AND sspba.channel_uid = 113688
						AND sspba.join_nr = ejj.join_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_a au) full(ship_a) full(au) */
							ship_a.join_nr, 
							max (ship_a.address_nr )ship_aNr
						FROM bsicrm.bsi_x_address_mapping ship_a
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_a.address_nr
							AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_a.join_type_uid = 318594
							AND ship_a.channel_uid = 113688
							-- 2315:	Hauptadresse
							-- 108363:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedCode
							AND (ship_a.type_uid = 2315 OR  ship_a.type_uid = 108363)
						GROUP BY ship_a.join_nr
					) ship_a ON ship_a.join_nr = ejj.join_nr                     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_ap au) full(ship_ap) full(au) */
							ship_ap.join_nr, 
							max (ship_ap.address_nr ) ship_apnr
						FROM bsicrm.bsi_x_address_mapping ship_ap
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_ap.address_nr
								AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_ap.join_type_uid = 318594
							AND ship_ap.channel_uid = 113688
							-- 108240:	Postfach
							-- 108364:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedPoBoxCode
							AND (ship_ap.type_uid = 108240 OR  ship_ap.type_uid = 108364)
						GROUP BY ship_ap.join_nr
					) ship_ap ON  ship_ap.join_nr = ejj.join_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
							max (kd.join_nr) kuba_join_nr, 
							ejj2.join_nr             
						FROM bsicrm.bsi_x_ext_kuba_data kd
						JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr 
							AND ej2.ext_join_type_uid = kd.join_type_uid AND ej2.active = 1
						JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr 
							AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
						WHERE kd.status_uid = 4800511372 --aktiv  
						GROUP BY ejj2.join_nr
					) kuba_data ON kuba_data.join_nr = company.company_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
							DISTINCT ejjinner.join_nr 
						FROM bsicrm.bsi_x_collection coll 
							JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr 
								AND ejinner.active = 1
							JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
						WHERE coll.status_uid <> 137824
					) collection ON collection.join_nr = company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_samba
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108187
						GROUP BY ejj2.join_nr
					) comp_samba ON comp_samba.join_nr =  company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108205
						GROUP BY ejj2.join_nr
					) comp_nx ON comp_nx.join_nr =  company.company_nr  
				WHERE  ejj.is_master = 1
					AND    ejj.ext_join_type_uid = 108224
					AND    ej.interface_uid  = 108187 --samba      
			),
			dunning AS (
				SELECT /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
					distinct ejj.join_nr -- company.x_complex_no                    
				FROM bsicrm.bsi_x_ext_receipt xrcp
					JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr
						AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
					JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid
				WHERE xrcp.overdue_level_uid IN (137663,137664,137665) 
			)  
			SELECT /*+ ordered use_hash(kuba dnng legaladdr cy ap gt cyp shipping_addr shipping_apo cy_sh_po gt_sh_po cy_shipping tkam tlf tnc tne) 
                   full(kuba) full(dnng) full(legaladdr) full(cy) full(ap) full(gt) full(cyp) full(shipping_addr) full(shipping_apo) full(cy_sh_po) full(gt_sh_po) full(cy_shipping) full(tkam) full(tlf) full(tnc) full(tne) */
				distinct ec.x_complex_no uk_LCM_X_COMPLEX_NO__c,
				ec.NAME,
				ec.join_nos_samba LCM_Samba_MergeIDs__c,
				ec.join_nos_nx LCM_NX_MergeIDs__c,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%'  
				THEN  NULL
				ELSE ec.fone           
				END Phone,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%' 
				THEN  ec.fone
				ELSE ec.handy           
				END MobilePhone, 
				ec.fax fax, 
				CASE WHEN ec.email LIKE 'etv@%' THEN  NULL
				ELSE ec.email           
				END email__c,
				ec.www website,
				NVL(RTRIM (legaladdr.x_street_name||' '||legaladdr.x_street_house_no), legaladdr.postal_display_street) legalstreet, 
				cy.zip_code LegalPostalCode,
				cy.city legalcity,
				CASE WHEN cy.state IS NULL THEN 
					cyp.state
				ELSE 
					cy.state 
				END LegalState,  
				CASE WHEN cy.country_uid IS NULL THEN 
					DECODE (cyp.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein')
				else 
					DECODE (cy.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein') 
				END legalcountry, 
				gt.text P_O_Box__c,
				cyp.zip_code P_O_BoxPostalCode__c,
				cyp.city p_o_boxcity__c, 
				DECODE (ec.language_uid, 
					246, 'German', 
					1303, 'English', 
					7770, 'French', 
					7771, 'Italian', '?'
				) PreferedLanguage__c,
				ec.structure__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,  
				regexp_replace(
					coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), '^([^0-9]*) (\d+[a-zA-Z]{0,3})?$', '\1') 
					||  ' ' 
					|| nvl(shipping_addr.x_street_house_no, 
						ltrim(regexp_substr(
							coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), ' (\d+[a-zA-Z]{0,3})?$')
						)
				)  Shippingstreet, 
				cy_shipping.zip_code Shippingpostalcode,
				cy_shipping.city shippingcity, 
				cy_shipping.state ShippingState,
				DECODE (cy_shipping.country_uid, 
					1001148, 'Schweiz', 
					1001161, 'Deutschland', 
					1001179, 'Frankreich', 
					1001215, 'Italien', 
					1001234, 'Liechtenstein'
				) ShippingCountry,
				gt_sh_po.text ShippingP_O_Box__c,
				cy_sh_po.zip_code ShippingP_O_Box_PostalCode__c, 
				cy_sh_po.city ShippingP_O_BoxCity__c,
				DECODE (ec.x_advisory_status_uid, 
					117411, 'Fieldsales', 
					117413, 'KAM-Fieldsales'
				) SalesChannel__c,
				tkam.text KAMType__c, 
				CASE 
					WHEN kuba.legal_form_uid IS NOT NULL THEN
						REPLACE (tlf.text, 'K' || chr(50108) || 'Ba: ', '') 
					WHEN ec.y_legal_status_uid  <> 0 THEN 
						DECODE (ec.y_legal_status_uid, 
							875976469, 'AG', 
							875976471, 'Einzelunternehmen', 
							875976476, 'Genossenschaft', 
							875976472, 'GmbH', 
							875976474, 'Kollektivgesellschaft', 
							5714572491, 'Kommanditgesellschaft', 
							875976464, 'Stiftung', 
							875976459, 'Verein', 
							null
						)  
				END legalentity__c, 
				kuba.federal_company_id UID__c,
				tnc.text noga1__c,
				CASE WHEN kuba.founding_year = 0 THEN NULL
				ELSE kuba.founding_year
				END  CompanySince__c,
				CASE 
					WHEN kuba.turnover BETWEEN 2000001 AND 99999999 THEN  'A'
					WHEN kuba.turnover BETWEEN 1000001 AND 2000000 THEN  'B'
					WHEN kuba.turnover BETWEEN 200001 AND 1000000 THEN  'C'           
					WHEN kuba.turnover BETWEEN 5001 AND 200000 THEN  'D'             
				END TurnoverClass__c,
				tne.text NumberOfEmployees,
				EC.Allowed_comm_channel__c,
				EC.Communication_Channel__c
			FROM exported_companies ec
				LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
				LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr
				LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
				LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
				LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
				LEFT JOIN bsicrm.bsi_global_text gt ON gt.global_text_nr = AP.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cyp ON cyp.city_nr = AP.city_nr
				LEFT JOIN bsicrm.bsi_address shipping_addr ON shipping_addr.address_nr = ec.ship_address_nr
				LEFT JOIN bsicrm.bsi_address shipping_apo ON shipping_apo.address_nr = ec.ship_apo_nr
				LEFT JOIN bsicrm.bsi_city cy_sh_po ON cy_sh_po.city_nr = shipping_apo.city_nr
				LEFT JOIN bsicrm.bsi_global_text gt_sh_po ON gt_sh_po.global_text_nr = shipping_apo.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cy_shipping ON cy_shipping.city_nr = shipping_addr.city_nr
				LEFT JOIN bsicrm.bsi_uc_text tkam ON tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tlf ON tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tnc ON tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tne ON tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, Error Msg = ORA-00904: "EC"."X_IS_LOCKED": ungültiger Bezeichner

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 2 0 2019-10-31 17:55:53.124
!MESSAGE Can't read execution warnings
!SUBENTRY 1 org.jkiss.dbeaver.model 2 0 2019-10-31 17:55:53.124
!MESSAGE SQL-Fehler [17008] [08003]: Getrennte Verbindung
!SUBENTRY 2 org.jkiss.dbeaver.model 2 0 2019-10-31 17:55:53.124
!MESSAGE Getrennte Verbindung
!STACK 0
java.sql.SQLRecoverableException: Getrennte Verbindung
	at oracle.jdbc.driver.OracleStatement.ensureOpen(OracleStatement.java:4114)
	at oracle.jdbc.driver.OracleStatement.getWarnings(OracleStatement.java:3113)
	at oracle.jdbc.driver.OracleStatementWrapper.getWarnings(OracleStatementWrapper.java:348)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.getWarnings(JDBCStatementImpl.java:582)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.getStatementWarnings(JDBCStatementImpl.java:612)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:524)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.134
!MESSAGE Can't close statement
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.134
!MESSAGE Getrennte Verbindung
!STACK 0
java.sql.SQLRecoverableException: Getrennte Verbindung
	at oracle.jdbc.driver.PhysicalConnection.needLine(PhysicalConnection.java:3305)
	at oracle.jdbc.driver.OracleStatement.closeOrCache(OracleStatement.java:1409)
	at oracle.jdbc.driver.OracleStatement.close(OracleStatement.java:1392)
	at oracle.jdbc.driver.OracleStatementWrapper.close(OracleStatementWrapper.java:119)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.close(JDBCStatementImpl.java:512)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.closeStatement(SQLQueryJob.java:797)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:530)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.261
!MESSAGE Operation failed. Retry count remains = 1
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.261
!MESSAGE SQL-Fehler [17002] [08006]: I/O-Fehler: Eine bestehende Verbindung wurde softwaregesteuert
durch den Hostcomputer abgebrochen
!SUBENTRY 2 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.261
!MESSAGE I/O-Fehler: Eine bestehende Verbindung wurde softwaregesteuert
durch den Hostcomputer abgebrochen
!STACK 0
java.sql.SQLRecoverableException: I/O-Fehler: Eine bestehende Verbindung wurde softwaregesteuert
durch den Hostcomputer abgebrochen
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:738)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)
Caused by: java.io.IOException: Eine bestehende Verbindung wurde softwaregesteuert
durch den Hostcomputer abgebrochen
	at java.base/sun.nio.ch.SocketDispatcher.read0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:43)
	at java.base/sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:276)
	at java.base/sun.nio.ch.IOUtil.read(IOUtil.java:245)
	at java.base/sun.nio.ch.IOUtil.read(IOUtil.java:223)
	at java.base/sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:355)
	at oracle.net.nt.TimeoutSocketChannel.read(TimeoutSocketChannel.java:178)
	at oracle.net.ns.NSProtocolNIO.doSocketRead(NSProtocolNIO.java:544)
	at oracle.net.ns.NIOPacket.readHeader(NIOPacket.java:234)
	at oracle.net.ns.NIOPacket.readPacketFromSocketChannel(NIOPacket.java:174)
	at oracle.net.ns.NIOPacket.readFromSocketChannel(NIOPacket.java:122)
	at oracle.net.ns.NIOPacket.readFromSocketChannel(NIOPacket.java:100)
	at oracle.net.ns.NIONSDataChannel.readDataFromSocketChannel(NIONSDataChannel.java:86)
	at oracle.jdbc.driver.T4CMAREngineNIO.prepareForUnmarshall(T4CMAREngineNIO.java:762)
	at oracle.jdbc.driver.T4CMAREngineNIO.unmarshalUB1(T4CMAREngineNIO.java:427)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:394)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	... 18 more
!SUBENTRY 3 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.261
!MESSAGE Eine bestehende Verbindung wurde softwaregesteuert
durch den Hostcomputer abgebrochen
!STACK 0
java.io.IOException: Eine bestehende Verbindung wurde softwaregesteuert
durch den Hostcomputer abgebrochen
	at java.base/sun.nio.ch.SocketDispatcher.read0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:43)
	at java.base/sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:276)
	at java.base/sun.nio.ch.IOUtil.read(IOUtil.java:245)
	at java.base/sun.nio.ch.IOUtil.read(IOUtil.java:223)
	at java.base/sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:355)
	at oracle.net.nt.TimeoutSocketChannel.read(TimeoutSocketChannel.java:178)
	at oracle.net.ns.NSProtocolNIO.doSocketRead(NSProtocolNIO.java:544)
	at oracle.net.ns.NIOPacket.readHeader(NIOPacket.java:234)
	at oracle.net.ns.NIOPacket.readPacketFromSocketChannel(NIOPacket.java:174)
	at oracle.net.ns.NIOPacket.readFromSocketChannel(NIOPacket.java:122)
	at oracle.net.ns.NIOPacket.readFromSocketChannel(NIOPacket.java:100)
	at oracle.net.ns.NIONSDataChannel.readDataFromSocketChannel(NIONSDataChannel.java:86)
	at oracle.jdbc.driver.T4CMAREngineNIO.prepareForUnmarshall(T4CMAREngineNIO.java:762)
	at oracle.jdbc.driver.T4CMAREngineNIO.unmarshalUB1(T4CMAREngineNIO.java:427)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:394)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.285
!MESSAGE Operation failed. Retry count remains = 1
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.285
!MESSAGE SQL-Fehler [17002] [08006]: I/O-Fehler: The Network Adapter could not establish the connection
!SUBENTRY 2 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.285
!MESSAGE I/O-Fehler: The Network Adapter could not establish the connection
!STACK 0
java.sql.SQLRecoverableException: I/O-Fehler: The Network Adapter could not establish the connection
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:801)
	at oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:782)
	at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:39)
	at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:704)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.lambda$0(JDBCDataSource.java:148)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.openConnection(JDBCDataSource.java:157)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource.openConnection(OracleDataSource.java:144)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:89)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:77)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.getConnection(JDBCExecutionContext.java:166)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.getOriginal(JDBCConnectionImpl.java:64)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:248)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:150)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:1)
	at org.jkiss.dbeaver.model.DBUtils.createStatement(DBUtils.java:1104)
	at org.jkiss.dbeaver.model.DBUtils.makeStatement(DBUtils.java:1072)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:438)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)
Caused by: oracle.net.ns.NetException: The Network Adapter could not establish the connection
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:569)
	at oracle.net.resolver.AddrResolution.resolveAndExecute(AddrResolution.java:521)
	at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:660)
	at oracle.net.ns.NSProtocol.connect(NSProtocol.java:287)
	at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1481)
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:540)
	... 26 more
Caused by: java.net.UnknownHostException: ora-dbs-4.ltvintra.ltv.ch
	at java.base/java.net.InetAddress$CachedAddresses.get(InetAddress.java:797)
	at java.base/java.net.InetAddress.getAllByName0(InetAddress.java:1505)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1364)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1298)
	at oracle.net.nt.TcpNTAdapter.connect(TcpNTAdapter.java:145)
	at oracle.net.nt.ConnOption.connect(ConnOption.java:172)
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:508)
	... 31 more
!SUBENTRY 3 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.285
!MESSAGE The Network Adapter could not establish the connection
!STACK 0
oracle.net.ns.NetException: The Network Adapter could not establish the connection
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:569)
	at oracle.net.resolver.AddrResolution.resolveAndExecute(AddrResolution.java:521)
	at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:660)
	at oracle.net.ns.NSProtocol.connect(NSProtocol.java:287)
	at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1481)
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:540)
	at oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:782)
	at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:39)
	at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:704)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.lambda$0(JDBCDataSource.java:148)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.openConnection(JDBCDataSource.java:157)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource.openConnection(OracleDataSource.java:144)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:89)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:77)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.getConnection(JDBCExecutionContext.java:166)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.getOriginal(JDBCConnectionImpl.java:64)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:248)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:150)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:1)
	at org.jkiss.dbeaver.model.DBUtils.createStatement(DBUtils.java:1104)
	at org.jkiss.dbeaver.model.DBUtils.makeStatement(DBUtils.java:1072)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:438)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)
Caused by: java.net.UnknownHostException: ora-dbs-4.ltvintra.ltv.ch
	at java.base/java.net.InetAddress$CachedAddresses.get(InetAddress.java:797)
	at java.base/java.net.InetAddress.getAllByName0(InetAddress.java:1505)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1364)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1298)
	at oracle.net.nt.TcpNTAdapter.connect(TcpNTAdapter.java:145)
	at oracle.net.nt.ConnOption.connect(ConnOption.java:172)
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:508)
	... 31 more
!SUBENTRY 4 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.285
!MESSAGE ora-dbs-4.ltvintra.ltv.ch
!STACK 0
java.net.UnknownHostException: ora-dbs-4.ltvintra.ltv.ch
	at java.base/java.net.InetAddress$CachedAddresses.get(InetAddress.java:797)
	at java.base/java.net.InetAddress.getAllByName0(InetAddress.java:1505)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1364)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1298)
	at oracle.net.nt.TcpNTAdapter.connect(TcpNTAdapter.java:145)
	at oracle.net.nt.ConnOption.connect(ConnOption.java:172)
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:508)
	at oracle.net.resolver.AddrResolution.resolveAndExecute(AddrResolution.java:521)
	at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:660)
	at oracle.net.ns.NSProtocol.connect(NSProtocol.java:287)
	at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1481)
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:540)
	at oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:782)
	at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:39)
	at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:704)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.lambda$0(JDBCDataSource.java:148)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.openConnection(JDBCDataSource.java:157)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource.openConnection(OracleDataSource.java:144)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:89)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:77)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.getConnection(JDBCExecutionContext.java:166)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.getOriginal(JDBCConnectionImpl.java:64)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:248)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:150)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:1)
	at org.jkiss.dbeaver.model.DBUtils.createStatement(DBUtils.java:1104)
	at org.jkiss.dbeaver.model.DBUtils.makeStatement(DBUtils.java:1072)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:438)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.416
!MESSAGE Operation failed. Retry count remains = 1
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.416
!MESSAGE SQL-Fehler [17002] [08006]: I/O-Fehler: The Network Adapter could not establish the connection
!SUBENTRY 2 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.416
!MESSAGE I/O-Fehler: The Network Adapter could not establish the connection
!STACK 0
java.sql.SQLRecoverableException: I/O-Fehler: The Network Adapter could not establish the connection
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:801)
	at oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:782)
	at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:39)
	at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:704)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.lambda$0(JDBCDataSource.java:148)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.openConnection(JDBCDataSource.java:157)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource.openConnection(OracleDataSource.java:144)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:89)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:77)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.getConnection(JDBCExecutionContext.java:166)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.getOriginal(JDBCConnectionImpl.java:64)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:248)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:150)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:1)
	at org.jkiss.dbeaver.model.DBUtils.createStatement(DBUtils.java:1104)
	at org.jkiss.dbeaver.model.DBUtils.makeStatement(DBUtils.java:1072)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:438)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)
Caused by: oracle.net.ns.NetException: The Network Adapter could not establish the connection
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:569)
	at oracle.net.resolver.AddrResolution.resolveAndExecute(AddrResolution.java:521)
	at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:660)
	at oracle.net.ns.NSProtocol.connect(NSProtocol.java:287)
	at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1481)
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:540)
	... 26 more
Caused by: java.net.UnknownHostException: ora-dbs-4.ltvintra.ltv.ch
	at java.base/java.net.InetAddress$CachedAddresses.get(InetAddress.java:797)
	at java.base/java.net.InetAddress.getAllByName0(InetAddress.java:1505)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1364)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1298)
	at oracle.net.nt.TcpNTAdapter.connect(TcpNTAdapter.java:145)
	at oracle.net.nt.ConnOption.connect(ConnOption.java:172)
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:508)
	... 31 more
!SUBENTRY 3 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.416
!MESSAGE The Network Adapter could not establish the connection
!STACK 0
oracle.net.ns.NetException: The Network Adapter could not establish the connection
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:569)
	at oracle.net.resolver.AddrResolution.resolveAndExecute(AddrResolution.java:521)
	at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:660)
	at oracle.net.ns.NSProtocol.connect(NSProtocol.java:287)
	at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1481)
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:540)
	at oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:782)
	at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:39)
	at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:704)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.lambda$0(JDBCDataSource.java:148)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.openConnection(JDBCDataSource.java:157)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource.openConnection(OracleDataSource.java:144)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:89)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:77)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.getConnection(JDBCExecutionContext.java:166)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.getOriginal(JDBCConnectionImpl.java:64)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:248)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:150)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:1)
	at org.jkiss.dbeaver.model.DBUtils.createStatement(DBUtils.java:1104)
	at org.jkiss.dbeaver.model.DBUtils.makeStatement(DBUtils.java:1072)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:438)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)
Caused by: java.net.UnknownHostException: ora-dbs-4.ltvintra.ltv.ch
	at java.base/java.net.InetAddress$CachedAddresses.get(InetAddress.java:797)
	at java.base/java.net.InetAddress.getAllByName0(InetAddress.java:1505)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1364)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1298)
	at oracle.net.nt.TcpNTAdapter.connect(TcpNTAdapter.java:145)
	at oracle.net.nt.ConnOption.connect(ConnOption.java:172)
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:508)
	... 31 more
!SUBENTRY 4 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.416
!MESSAGE ora-dbs-4.ltvintra.ltv.ch
!STACK 0
java.net.UnknownHostException: ora-dbs-4.ltvintra.ltv.ch
	at java.base/java.net.InetAddress$CachedAddresses.get(InetAddress.java:797)
	at java.base/java.net.InetAddress.getAllByName0(InetAddress.java:1505)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1364)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1298)
	at oracle.net.nt.TcpNTAdapter.connect(TcpNTAdapter.java:145)
	at oracle.net.nt.ConnOption.connect(ConnOption.java:172)
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:508)
	at oracle.net.resolver.AddrResolution.resolveAndExecute(AddrResolution.java:521)
	at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:660)
	at oracle.net.ns.NSProtocol.connect(NSProtocol.java:287)
	at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1481)
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:540)
	at oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:782)
	at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:39)
	at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:704)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.lambda$0(JDBCDataSource.java:148)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.openConnection(JDBCDataSource.java:157)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource.openConnection(OracleDataSource.java:144)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:89)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:77)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.getConnection(JDBCExecutionContext.java:166)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.getOriginal(JDBCConnectionImpl.java:64)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:248)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:150)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:1)
	at org.jkiss.dbeaver.model.DBUtils.createStatement(DBUtils.java:1104)
	at org.jkiss.dbeaver.model.DBUtils.makeStatement(DBUtils.java:1072)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:438)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.501
!MESSAGE SQL-Fehler [17002] [08006]: I/O-Fehler: The Network Adapter could not establish the connection
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.501
!MESSAGE I/O-Fehler: The Network Adapter could not establish the connection
!STACK 0
java.sql.SQLRecoverableException: I/O-Fehler: The Network Adapter could not establish the connection
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:801)
	at oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:782)
	at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:39)
	at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:704)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.lambda$0(JDBCDataSource.java:148)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.openConnection(JDBCDataSource.java:157)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource.openConnection(OracleDataSource.java:144)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:89)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:77)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.getConnection(JDBCExecutionContext.java:166)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.getOriginal(JDBCConnectionImpl.java:64)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource$OracleOutputReader.readServerOutput(OracleDataSource.java:796)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$ServerOutputReader.dumpOutput(SQLEditor.java:3257)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$ServerOutputReader.run(SQLEditor.java:3239)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)
Caused by: oracle.net.ns.NetException: The Network Adapter could not establish the connection
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:569)
	at oracle.net.resolver.AddrResolution.resolveAndExecute(AddrResolution.java:521)
	at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:660)
	at oracle.net.ns.NSProtocol.connect(NSProtocol.java:287)
	at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1481)
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:540)
	... 15 more
Caused by: java.net.UnknownHostException: ora-dbs-4.ltvintra.ltv.ch
	at java.base/java.net.InetAddress$CachedAddresses.get(InetAddress.java:797)
	at java.base/java.net.InetAddress.getAllByName0(InetAddress.java:1505)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1364)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1298)
	at oracle.net.nt.TcpNTAdapter.connect(TcpNTAdapter.java:145)
	at oracle.net.nt.ConnOption.connect(ConnOption.java:172)
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:508)
	... 20 more
!SUBENTRY 2 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.502
!MESSAGE The Network Adapter could not establish the connection
!STACK 0
oracle.net.ns.NetException: The Network Adapter could not establish the connection
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:569)
	at oracle.net.resolver.AddrResolution.resolveAndExecute(AddrResolution.java:521)
	at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:660)
	at oracle.net.ns.NSProtocol.connect(NSProtocol.java:287)
	at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1481)
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:540)
	at oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:782)
	at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:39)
	at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:704)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.lambda$0(JDBCDataSource.java:148)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.openConnection(JDBCDataSource.java:157)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource.openConnection(OracleDataSource.java:144)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:89)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:77)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.getConnection(JDBCExecutionContext.java:166)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.getOriginal(JDBCConnectionImpl.java:64)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource$OracleOutputReader.readServerOutput(OracleDataSource.java:796)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$ServerOutputReader.dumpOutput(SQLEditor.java:3257)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$ServerOutputReader.run(SQLEditor.java:3239)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)
Caused by: java.net.UnknownHostException: ora-dbs-4.ltvintra.ltv.ch
	at java.base/java.net.InetAddress$CachedAddresses.get(InetAddress.java:797)
	at java.base/java.net.InetAddress.getAllByName0(InetAddress.java:1505)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1364)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1298)
	at oracle.net.nt.TcpNTAdapter.connect(TcpNTAdapter.java:145)
	at oracle.net.nt.ConnOption.connect(ConnOption.java:172)
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:508)
	... 20 more
!SUBENTRY 3 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.502
!MESSAGE ora-dbs-4.ltvintra.ltv.ch
!STACK 0
java.net.UnknownHostException: ora-dbs-4.ltvintra.ltv.ch
	at java.base/java.net.InetAddress$CachedAddresses.get(InetAddress.java:797)
	at java.base/java.net.InetAddress.getAllByName0(InetAddress.java:1505)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1364)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1298)
	at oracle.net.nt.TcpNTAdapter.connect(TcpNTAdapter.java:145)
	at oracle.net.nt.ConnOption.connect(ConnOption.java:172)
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:508)
	at oracle.net.resolver.AddrResolution.resolveAndExecute(AddrResolution.java:521)
	at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:660)
	at oracle.net.ns.NSProtocol.connect(NSProtocol.java:287)
	at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1481)
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:540)
	at oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:782)
	at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:39)
	at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:704)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.lambda$0(JDBCDataSource.java:148)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.openConnection(JDBCDataSource.java:157)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource.openConnection(OracleDataSource.java:144)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:89)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:77)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.getConnection(JDBCExecutionContext.java:166)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.getOriginal(JDBCConnectionImpl.java:64)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource$OracleOutputReader.readServerOutput(OracleDataSource.java:796)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$ServerOutputReader.dumpOutput(SQLEditor.java:3257)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$ServerOutputReader.run(SQLEditor.java:3239)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.522
!MESSAGE SQL-Fehler [17002] [08006]: I/O-Fehler: The Network Adapter could not establish the connection
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.522
!MESSAGE I/O-Fehler: The Network Adapter could not establish the connection
!STACK 0
java.sql.SQLRecoverableException: I/O-Fehler: The Network Adapter could not establish the connection
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:801)
	at oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:782)
	at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:39)
	at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:704)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.lambda$0(JDBCDataSource.java:148)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.openConnection(JDBCDataSource.java:157)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource.openConnection(OracleDataSource.java:144)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:89)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:77)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.getConnection(JDBCExecutionContext.java:166)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.getOriginal(JDBCConnectionImpl.java:64)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:248)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:150)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:1)
	at org.jkiss.dbeaver.model.DBUtils.createStatement(DBUtils.java:1104)
	at org.jkiss.dbeaver.model.DBUtils.makeStatement(DBUtils.java:1072)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:438)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)
Caused by: oracle.net.ns.NetException: The Network Adapter could not establish the connection
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:569)
	at oracle.net.resolver.AddrResolution.resolveAndExecute(AddrResolution.java:521)
	at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:660)
	at oracle.net.ns.NSProtocol.connect(NSProtocol.java:287)
	at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1481)
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:540)
	... 26 more
Caused by: java.net.UnknownHostException: ora-dbs-4.ltvintra.ltv.ch
	at java.base/java.net.InetAddress$CachedAddresses.get(InetAddress.java:797)
	at java.base/java.net.InetAddress.getAllByName0(InetAddress.java:1505)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1364)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1298)
	at oracle.net.nt.TcpNTAdapter.connect(TcpNTAdapter.java:145)
	at oracle.net.nt.ConnOption.connect(ConnOption.java:172)
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:508)
	... 31 more
!SUBENTRY 2 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.522
!MESSAGE The Network Adapter could not establish the connection
!STACK 0
oracle.net.ns.NetException: The Network Adapter could not establish the connection
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:569)
	at oracle.net.resolver.AddrResolution.resolveAndExecute(AddrResolution.java:521)
	at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:660)
	at oracle.net.ns.NSProtocol.connect(NSProtocol.java:287)
	at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1481)
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:540)
	at oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:782)
	at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:39)
	at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:704)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.lambda$0(JDBCDataSource.java:148)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.openConnection(JDBCDataSource.java:157)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource.openConnection(OracleDataSource.java:144)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:89)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:77)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.getConnection(JDBCExecutionContext.java:166)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.getOriginal(JDBCConnectionImpl.java:64)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:248)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:150)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:1)
	at org.jkiss.dbeaver.model.DBUtils.createStatement(DBUtils.java:1104)
	at org.jkiss.dbeaver.model.DBUtils.makeStatement(DBUtils.java:1072)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:438)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)
Caused by: java.net.UnknownHostException: ora-dbs-4.ltvintra.ltv.ch
	at java.base/java.net.InetAddress$CachedAddresses.get(InetAddress.java:797)
	at java.base/java.net.InetAddress.getAllByName0(InetAddress.java:1505)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1364)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1298)
	at oracle.net.nt.TcpNTAdapter.connect(TcpNTAdapter.java:145)
	at oracle.net.nt.ConnOption.connect(ConnOption.java:172)
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:508)
	... 31 more
!SUBENTRY 3 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.522
!MESSAGE ora-dbs-4.ltvintra.ltv.ch
!STACK 0
java.net.UnknownHostException: ora-dbs-4.ltvintra.ltv.ch
	at java.base/java.net.InetAddress$CachedAddresses.get(InetAddress.java:797)
	at java.base/java.net.InetAddress.getAllByName0(InetAddress.java:1505)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1364)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1298)
	at oracle.net.nt.TcpNTAdapter.connect(TcpNTAdapter.java:145)
	at oracle.net.nt.ConnOption.connect(ConnOption.java:172)
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:508)
	at oracle.net.resolver.AddrResolution.resolveAndExecute(AddrResolution.java:521)
	at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:660)
	at oracle.net.ns.NSProtocol.connect(NSProtocol.java:287)
	at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1481)
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:540)
	at oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:782)
	at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:39)
	at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:704)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.lambda$0(JDBCDataSource.java:148)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.openConnection(JDBCDataSource.java:157)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource.openConnection(OracleDataSource.java:144)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:89)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:77)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.getConnection(JDBCExecutionContext.java:166)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.getOriginal(JDBCConnectionImpl.java:64)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:248)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:150)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:1)
	at org.jkiss.dbeaver.model.DBUtils.createStatement(DBUtils.java:1104)
	at org.jkiss.dbeaver.model.DBUtils.makeStatement(DBUtils.java:1072)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:438)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.534
!MESSAGE SQL-Fehler [17002] [08006]: I/O-Fehler: The Network Adapter could not establish the connection
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.534
!MESSAGE I/O-Fehler: The Network Adapter could not establish the connection
!STACK 0
java.sql.SQLRecoverableException: I/O-Fehler: The Network Adapter could not establish the connection
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:801)
	at oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:782)
	at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:39)
	at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:704)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.lambda$0(JDBCDataSource.java:148)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.openConnection(JDBCDataSource.java:157)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource.openConnection(OracleDataSource.java:144)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:89)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:77)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.getConnection(JDBCExecutionContext.java:166)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.getOriginal(JDBCConnectionImpl.java:64)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource$OracleOutputReader.readServerOutput(OracleDataSource.java:796)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$ServerOutputReader.dumpOutput(SQLEditor.java:3257)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$ServerOutputReader.run(SQLEditor.java:3239)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)
Caused by: oracle.net.ns.NetException: The Network Adapter could not establish the connection
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:569)
	at oracle.net.resolver.AddrResolution.resolveAndExecute(AddrResolution.java:521)
	at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:660)
	at oracle.net.ns.NSProtocol.connect(NSProtocol.java:287)
	at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1481)
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:540)
	... 15 more
Caused by: java.net.UnknownHostException: ora-dbs-4.ltvintra.ltv.ch
	at java.base/java.net.InetAddress$CachedAddresses.get(InetAddress.java:797)
	at java.base/java.net.InetAddress.getAllByName0(InetAddress.java:1505)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1364)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1298)
	at oracle.net.nt.TcpNTAdapter.connect(TcpNTAdapter.java:145)
	at oracle.net.nt.ConnOption.connect(ConnOption.java:172)
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:508)
	... 20 more
!SUBENTRY 2 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.535
!MESSAGE The Network Adapter could not establish the connection
!STACK 0
oracle.net.ns.NetException: The Network Adapter could not establish the connection
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:569)
	at oracle.net.resolver.AddrResolution.resolveAndExecute(AddrResolution.java:521)
	at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:660)
	at oracle.net.ns.NSProtocol.connect(NSProtocol.java:287)
	at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1481)
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:540)
	at oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:782)
	at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:39)
	at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:704)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.lambda$0(JDBCDataSource.java:148)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.openConnection(JDBCDataSource.java:157)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource.openConnection(OracleDataSource.java:144)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:89)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:77)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.getConnection(JDBCExecutionContext.java:166)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.getOriginal(JDBCConnectionImpl.java:64)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource$OracleOutputReader.readServerOutput(OracleDataSource.java:796)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$ServerOutputReader.dumpOutput(SQLEditor.java:3257)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$ServerOutputReader.run(SQLEditor.java:3239)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)
Caused by: java.net.UnknownHostException: ora-dbs-4.ltvintra.ltv.ch
	at java.base/java.net.InetAddress$CachedAddresses.get(InetAddress.java:797)
	at java.base/java.net.InetAddress.getAllByName0(InetAddress.java:1505)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1364)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1298)
	at oracle.net.nt.TcpNTAdapter.connect(TcpNTAdapter.java:145)
	at oracle.net.nt.ConnOption.connect(ConnOption.java:172)
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:508)
	... 20 more
!SUBENTRY 3 org.jkiss.dbeaver.model 4 0 2019-10-31 17:55:53.535
!MESSAGE ora-dbs-4.ltvintra.ltv.ch
!STACK 0
java.net.UnknownHostException: ora-dbs-4.ltvintra.ltv.ch
	at java.base/java.net.InetAddress$CachedAddresses.get(InetAddress.java:797)
	at java.base/java.net.InetAddress.getAllByName0(InetAddress.java:1505)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1364)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1298)
	at oracle.net.nt.TcpNTAdapter.connect(TcpNTAdapter.java:145)
	at oracle.net.nt.ConnOption.connect(ConnOption.java:172)
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:508)
	at oracle.net.resolver.AddrResolution.resolveAndExecute(AddrResolution.java:521)
	at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:660)
	at oracle.net.ns.NSProtocol.connect(NSProtocol.java:287)
	at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1481)
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:540)
	at oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:782)
	at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:39)
	at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:704)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.lambda$0(JDBCDataSource.java:148)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCDataSource.openConnection(JDBCDataSource.java:157)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource.openConnection(OracleDataSource.java:144)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:89)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.connect(JDBCExecutionContext.java:77)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCExecutionContext.getConnection(JDBCExecutionContext.java:166)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.getOriginal(JDBCConnectionImpl.java:64)
	at org.jkiss.dbeaver.ext.oracle.model.OracleDataSource$OracleOutputReader.readServerOutput(OracleDataSource.java:796)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$ServerOutputReader.dumpOutput(SQLEditor.java:3257)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$ServerOutputReader.run(SQLEditor.java:3239)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 17:58:18.426
!MESSAGE SQL-Fehler [920] [42000]: ORA-00920: Ungültiger relationaler Operator

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 17:58:18.426
!MESSAGE Error : 920, Position : 14537, Sql = -- SAMBA
WITH exported_companies AS (
				SELECT /*+ ordered use_hash(ejj ej company cc cc2 a sspa sspba) full(ejj) full(ej) full(company) full(cc) full(cc2) full(a) full(sspa) full(sspba) */
					company.x_complex_no,  -- accounts_samba
					TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
					company.language_uid,
					COMPANY.x_is_locked,
					ejj.join_nr,
					dbms_lob.substr(comp_samba.join_nos_samba, 4000, 1 ) join_nos_samba,
					dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx, 
					sadr.fone,
					sadr.handy,
					sadr.fax,
					sadr.email,
					sadr.www,
					kam.kamtyp,
					CASE 
						WHEN cc2.relation_uid = 300 THEN 'Group'
						WHEN cc2.relation_uid = 109876 THEN 'Company' 
						WHEN cc.relation_uid  = 300 THEN 'Company'
						WHEN cc.relation_uid  = 109876 THEN 'Branch'
						ELSE 'Single Company' 
					END structure__c, 
					sspa.address_nr address_nr,
					sspba.address_nr pobox_address_nr,
					ship_a.ship_anr  ship_address_nr,
					ship_ap.ship_apnr ship_apo_nr,
					company.y_legal_status_uid, 
					company.x_advisory_status_uid,  
					collection.join_nr coll_join_nr,
					kuba_data.kuba_join_nr,
					COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
					CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
						'Email'
					WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
						'Letter'
					WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
						'n.a.'
					END Communication_Channel__c
				FROM bsicrm.bsi_x_ext_join_join ejj
					JOIN bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
						AND ej.active = 1
					JOIN bsicrm.bsi_company company ON company.company_nr = ejj.join_nr 
						AND company.is_active = 1
					LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
					LEFT JOIN bsicrm.bsi_company_company cc ON cc.company_nr = ejj.join_nr
					LEFT JOIN (
						SELECT 
							cc2.group_company_nr, 
							MIN(cc2.relation_uid) relation_uid
						FROM bsicrm.bsi_company_company cc2 
						GROUP BY cc2.group_company_nr
					) cc2 ON cc2.group_company_nr = ejj.join_nr     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							MIN(ej2.kam_uid) kamtyp, 
							ejj2.join_nr innerjnr
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                     
						WHERE ej2.active = 1
						AND ej2.kam_uid != 0
						GROUP BY ejj2.join_nr
					) kam ON kam.innerjnr = ejj.join_nr  
					LEFT JOIN (
						SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
							adr.item_key0_nr,
							max (CASE WHEN adr.channel_uid = 113638 THEN adr.channel_value ELSE NULL END) fone,
							max (CASE WHEN adr.channel_uid = 113640 THEN adr.channel_value ELSE NULL END) handy,
							max (CASE WHEN adr.channel_uid = 113639 THEN adr.channel_value ELSE NULL END) fax,
							max (CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
							max (CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
						FROM bsicrm.bsi_address adr
							JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
							JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr and ej2.active = 1 AND ej2.interface_uid IN (108187,108205)
						WHERE adr.is_default_address = 1
							AND adr.item_type_id = 318594
						GROUP BY adr.item_key0_nr
					) sadr ON sadr.item_key0_nr = company.company_nr
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa ON  sspa.ext_join_nr = ejj.ext_join_nr
						AND sspa.join_type_uid = 318594
						AND sspa.type_uid = 2315 /* Hauptadresse */
						AND sspa.channel_uid = 113688
						AND sspa.join_nr = ejj.join_nr             
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba ON  sspba.ext_join_nr = ejj.ext_join_nr
						AND sspba.join_type_uid = 318594
						AND sspba.type_uid = 108240 /* Postfach */
						AND sspba.channel_uid = 113688
						AND sspba.join_nr = ejj.join_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_a au) full(ship_a) full(au) */
							ship_a.join_nr, 
							max (ship_a.address_nr )ship_aNr
						FROM bsicrm.bsi_x_address_mapping ship_a
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_a.address_nr
							AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_a.join_type_uid = 318594
							AND ship_a.channel_uid = 113688
							-- 2315:	Hauptadresse
							-- 108363:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedCode
							AND (ship_a.type_uid = 2315 OR  ship_a.type_uid = 108363)
						GROUP BY ship_a.join_nr
					) ship_a ON ship_a.join_nr = ejj.join_nr                     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_ap au) full(ship_ap) full(au) */
							ship_ap.join_nr, 
							max (ship_ap.address_nr ) ship_apnr
						FROM bsicrm.bsi_x_address_mapping ship_ap
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_ap.address_nr
								AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_ap.join_type_uid = 318594
							AND ship_ap.channel_uid = 113688
							-- 108240:	Postfach
							-- 108364:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedPoBoxCode
							AND (ship_ap.type_uid = 108240 OR  ship_ap.type_uid = 108364)
						GROUP BY ship_ap.join_nr
					) ship_ap ON  ship_ap.join_nr = ejj.join_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
							max (kd.join_nr) kuba_join_nr, 
							ejj2.join_nr             
						FROM bsicrm.bsi_x_ext_kuba_data kd
						JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr 
							AND ej2.ext_join_type_uid = kd.join_type_uid AND ej2.active = 1
						JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr 
							AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
						WHERE kd.status_uid = 4800511372 --aktiv  
						GROUP BY ejj2.join_nr
					) kuba_data ON kuba_data.join_nr = company.company_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
							DISTINCT ejjinner.join_nr 
						FROM bsicrm.bsi_x_collection coll 
							JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr 
								AND ejinner.active = 1
							JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
						WHERE coll.status_uid <> 137824
					) collection ON collection.join_nr = company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_samba
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108187
						GROUP BY ejj2.join_nr
					) comp_samba ON comp_samba.join_nr =  company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108205
						GROUP BY ejj2.join_nr
					) comp_nx ON comp_nx.join_nr =  company.company_nr  
				WHERE  ejj.is_master = 1
					AND    ejj.ext_join_type_uid = 108224
					AND    ej.interface_uid  = 108187 --samba      
			),
			dunning AS (
				SELECT /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
					distinct ejj.join_nr -- company.x_complex_no                    
				FROM bsicrm.bsi_x_ext_receipt xrcp
					JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr
						AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
					JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid
				WHERE xrcp.overdue_level_uid IN (137663,137664,137665) 
			)  
			SELECT /*+ ordered use_hash(kuba dnng legaladdr cy ap gt cyp shipping_addr shipping_apo cy_sh_po gt_sh_po cy_shipping tkam tlf tnc tne) 
                   full(kuba) full(dnng) full(legaladdr) full(cy) full(ap) full(gt) full(cyp) full(shipping_addr) full(shipping_apo) full(cy_sh_po) full(gt_sh_po) full(cy_shipping) full(tkam) full(tlf) full(tnc) full(tne) */
				distinct ec.x_complex_no uk_LCM_X_COMPLEX_NO__c,
				ec.NAME,
				ec.join_nos_samba LCM_Samba_MergeIDs__c,
				ec.join_nos_nx LCM_NX_MergeIDs__c,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%'  
				THEN  NULL
				ELSE ec.fone           
				END Phone,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%' 
				THEN  ec.fone
				ELSE ec.handy           
				END MobilePhone, 
				ec.fax fax, 
				CASE WHEN ec.email LIKE 'etv@%' THEN  NULL
				ELSE ec.email           
				END email__c,
				ec.www website,
				NVL(RTRIM (legaladdr.x_street_name||' '||legaladdr.x_street_house_no), legaladdr.postal_display_street) legalstreet, 
				cy.zip_code LegalPostalCode,
				cy.city legalcity,
				CASE WHEN cy.state IS NULL THEN 
					cyp.state
				ELSE 
					cy.state 
				END LegalState,  
				CASE WHEN cy.country_uid IS NULL THEN 
					DECODE (cyp.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein')
				else 
					DECODE (cy.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein') 
				END legalcountry, 
				gt.text P_O_Box__c,
				cyp.zip_code P_O_BoxPostalCode__c,
				cyp.city p_o_boxcity__c, 
				DECODE (ec.language_uid, 
					246, 'German', 
					1303, 'English', 
					7770, 'French', 
					7771, 'Italian', '?'
				) PreferedLanguage__c,
				ec.structure__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,  
				regexp_replace(
					coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), '^([^0-9]*) (\d+[a-zA-Z]{0,3})?$', '\1') 
					||  ' ' 
					|| nvl(shipping_addr.x_street_house_no, 
						ltrim(regexp_substr(
							coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), ' (\d+[a-zA-Z]{0,3})?$')
						)
				)  Shippingstreet, 
				cy_shipping.zip_code Shippingpostalcode,
				cy_shipping.city shippingcity, 
				cy_shipping.state ShippingState,
				DECODE (cy_shipping.country_uid, 
					1001148, 'Schweiz', 
					1001161, 'Deutschland', 
					1001179, 'Frankreich', 
					1001215, 'Italien', 
					1001234, 'Liechtenstein'
				) ShippingCountry,
				gt_sh_po.text ShippingP_O_Box__c,
				cy_sh_po.zip_code ShippingP_O_Box_PostalCode__c, 
				cy_sh_po.city ShippingP_O_BoxCity__c,
				DECODE (ec.x_advisory_status_uid, 
					117411, 'Fieldsales', 
					117413, 'KAM-Fieldsales'
				) SalesChannel__c,
				tkam.text KAMType__c, 
				CASE 
					WHEN kuba.legal_form_uid IS NOT NULL THEN
						REPLACE (tlf.text, 'K' || chr(50108) || 'Ba: ', '') 
					WHEN ec.y_legal_status_uid  <> 0 THEN 
						DECODE (ec.y_legal_status_uid, 
							875976469, 'AG', 
							875976471, 'Einzelunternehmen', 
							875976476, 'Genossenschaft', 
							875976472, 'GmbH', 
							875976474, 'Kollektivgesellschaft', 
							5714572491, 'Kommanditgesellschaft', 
							875976464, 'Stiftung', 
							875976459, 'Verein', 
							null
						)  
				END legalentity__c, 
				kuba.federal_company_id UID__c,
				tnc.text noga1__c,
				CASE WHEN kuba.founding_year = 0 THEN NULL
				ELSE kuba.founding_year
				END  CompanySince__c,
				CASE 
					WHEN kuba.turnover BETWEEN 2000001 AND 99999999 THEN  'A'
					WHEN kuba.turnover BETWEEN 1000001 AND 2000000 THEN  'B'
					WHEN kuba.turnover BETWEEN 200001 AND 1000000 THEN  'C'           
					WHEN kuba.turnover BETWEEN 5001 AND 200000 THEN  'D'             
				END TurnoverClass__c,
				tne.text NumberOfEmployees,
				EC.Allowed_comm_channel__c,
				EC.Communication_Channel__c
			FROM exported_companies ec
				LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
				LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr
				LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
				LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
				LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
				LEFT JOIN bsicrm.bsi_global_text gt ON gt.global_text_nr = AP.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cyp ON cyp.city_nr = AP.city_nr
				LEFT JOIN bsicrm.bsi_address shipping_addr ON shipping_addr.address_nr = ec.ship_address_nr
				LEFT JOIN bsicrm.bsi_address shipping_apo ON shipping_apo.address_nr = ec.ship_apo_nr
				LEFT JOIN bsicrm.bsi_city cy_sh_po ON cy_sh_po.city_nr = shipping_apo.city_nr
				LEFT JOIN bsicrm.bsi_global_text gt_sh_po ON gt_sh_po.global_text_nr = shipping_apo.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cy_shipping ON cy_shipping.city_nr = shipping_addr.city_nr
				LEFT JOIN bsicrm.bsi_uc_text tkam ON tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tlf ON tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tnc ON tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tne ON tne.uc_uid = kuba.number_of_employees_uid and tne.language_ui, OriginalSql = -- SAMBA
WITH exported_companies AS (
				SELECT /*+ ordered use_hash(ejj ej company cc cc2 a sspa sspba) full(ejj) full(ej) full(company) full(cc) full(cc2) full(a) full(sspa) full(sspba) */
					company.x_complex_no,  -- accounts_samba
					TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
					company.language_uid,
					COMPANY.x_is_locked,
					ejj.join_nr,
					dbms_lob.substr(comp_samba.join_nos_samba, 4000, 1 ) join_nos_samba,
					dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx, 
					sadr.fone,
					sadr.handy,
					sadr.fax,
					sadr.email,
					sadr.www,
					kam.kamtyp,
					CASE 
						WHEN cc2.relation_uid = 300 THEN 'Group'
						WHEN cc2.relation_uid = 109876 THEN 'Company' 
						WHEN cc.relation_uid  = 300 THEN 'Company'
						WHEN cc.relation_uid  = 109876 THEN 'Branch'
						ELSE 'Single Company' 
					END structure__c, 
					sspa.address_nr address_nr,
					sspba.address_nr pobox_address_nr,
					ship_a.ship_anr  ship_address_nr,
					ship_ap.ship_apnr ship_apo_nr,
					company.y_legal_status_uid, 
					company.x_advisory_status_uid,  
					collection.join_nr coll_join_nr,
					kuba_data.kuba_join_nr,
					COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
					CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
						'Email'
					WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
						'Letter'
					WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
						'n.a.'
					END Communication_Channel__c
				FROM bsicrm.bsi_x_ext_join_join ejj
					JOIN bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
						AND ej.active = 1
					JOIN bsicrm.bsi_company company ON company.company_nr = ejj.join_nr 
						AND company.is_active = 1
					LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
					LEFT JOIN bsicrm.bsi_company_company cc ON cc.company_nr = ejj.join_nr
					LEFT JOIN (
						SELECT 
							cc2.group_company_nr, 
							MIN(cc2.relation_uid) relation_uid
						FROM bsicrm.bsi_company_company cc2 
						GROUP BY cc2.group_company_nr
					) cc2 ON cc2.group_company_nr = ejj.join_nr     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							MIN(ej2.kam_uid) kamtyp, 
							ejj2.join_nr innerjnr
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                     
						WHERE ej2.active = 1
						AND ej2.kam_uid != 0
						GROUP BY ejj2.join_nr
					) kam ON kam.innerjnr = ejj.join_nr  
					LEFT JOIN (
						SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
							adr.item_key0_nr,
							max (CASE WHEN adr.channel_uid = 113638 THEN adr.channel_value ELSE NULL END) fone,
							max (CASE WHEN adr.channel_uid = 113640 THEN adr.channel_value ELSE NULL END) handy,
							max (CASE WHEN adr.channel_uid = 113639 THEN adr.channel_value ELSE NULL END) fax,
							max (CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
							max (CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
						FROM bsicrm.bsi_address adr
							JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
							JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr and ej2.active = 1 AND ej2.interface_uid IN (108187,108205)
						WHERE adr.is_default_address = 1
							AND adr.item_type_id = 318594
						GROUP BY adr.item_key0_nr
					) sadr ON sadr.item_key0_nr = company.company_nr
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa ON  sspa.ext_join_nr = ejj.ext_join_nr
						AND sspa.join_type_uid = 318594
						AND sspa.type_uid = 2315 /* Hauptadresse */
						AND sspa.channel_uid = 113688
						AND sspa.join_nr = ejj.join_nr             
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba ON  sspba.ext_join_nr = ejj.ext_join_nr
						AND sspba.join_type_uid = 318594
						AND sspba.type_uid = 108240 /* Postfach */
						AND sspba.channel_uid = 113688
						AND sspba.join_nr = ejj.join_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_a au) full(ship_a) full(au) */
							ship_a.join_nr, 
							max (ship_a.address_nr )ship_aNr
						FROM bsicrm.bsi_x_address_mapping ship_a
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_a.address_nr
							AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_a.join_type_uid = 318594
							AND ship_a.channel_uid = 113688
							-- 2315:	Hauptadresse
							-- 108363:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedCode
							AND (ship_a.type_uid = 2315 OR  ship_a.type_uid = 108363)
						GROUP BY ship_a.join_nr
					) ship_a ON ship_a.join_nr = ejj.join_nr                     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_ap au) full(ship_ap) full(au) */
							ship_ap.join_nr, 
							max (ship_ap.address_nr ) ship_apnr
						FROM bsicrm.bsi_x_address_mapping ship_ap
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_ap.address_nr
								AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_ap.join_type_uid = 318594
							AND ship_ap.channel_uid = 113688
							-- 108240:	Postfach
							-- 108364:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedPoBoxCode
							AND (ship_ap.type_uid = 108240 OR  ship_ap.type_uid = 108364)
						GROUP BY ship_ap.join_nr
					) ship_ap ON  ship_ap.join_nr = ejj.join_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
							max (kd.join_nr) kuba_join_nr, 
							ejj2.join_nr             
						FROM bsicrm.bsi_x_ext_kuba_data kd
						JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr 
							AND ej2.ext_join_type_uid = kd.join_type_uid AND ej2.active = 1
						JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr 
							AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
						WHERE kd.status_uid = 4800511372 --aktiv  
						GROUP BY ejj2.join_nr
					) kuba_data ON kuba_data.join_nr = company.company_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
							DISTINCT ejjinner.join_nr 
						FROM bsicrm.bsi_x_collection coll 
							JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr 
								AND ejinner.active = 1
							JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
						WHERE coll.status_uid <> 137824
					) collection ON collection.join_nr = company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_samba
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108187
						GROUP BY ejj2.join_nr
					) comp_samba ON comp_samba.join_nr =  company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108205
						GROUP BY ejj2.join_nr
					) comp_nx ON comp_nx.join_nr =  company.company_nr  
				WHERE  ejj.is_master = 1
					AND    ejj.ext_join_type_uid = 108224
					AND    ej.interface_uid  = 108187 --samba      
			),
			dunning AS (
				SELECT /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
					distinct ejj.join_nr -- company.x_complex_no                    
				FROM bsicrm.bsi_x_ext_receipt xrcp
					JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr
						AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
					JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid
				WHERE xrcp.overdue_level_uid IN (137663,137664,137665) 
			)  
			SELECT /*+ ordered use_hash(kuba dnng legaladdr cy ap gt cyp shipping_addr shipping_apo cy_sh_po gt_sh_po cy_shipping tkam tlf tnc tne) 
                   full(kuba) full(dnng) full(legaladdr) full(cy) full(ap) full(gt) full(cyp) full(shipping_addr) full(shipping_apo) full(cy_sh_po) full(gt_sh_po) full(cy_shipping) full(tkam) full(tlf) full(tnc) full(tne) */
				distinct ec.x_complex_no uk_LCM_X_COMPLEX_NO__c,
				ec.NAME,
				ec.join_nos_samba LCM_Samba_MergeIDs__c,
				ec.join_nos_nx LCM_NX_MergeIDs__c,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%'  
				THEN  NULL
				ELSE ec.fone           
				END Phone,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%' 
				THEN  ec.fone
				ELSE ec.handy           
				END MobilePhone, 
				ec.fax fax, 
				CASE WHEN ec.email LIKE 'etv@%' THEN  NULL
				ELSE ec.email           
				END email__c,
				ec.www website,
				NVL(RTRIM (legaladdr.x_street_name||' '||legaladdr.x_street_house_no), legaladdr.postal_display_street) legalstreet, 
				cy.zip_code LegalPostalCode,
				cy.city legalcity,
				CASE WHEN cy.state IS NULL THEN 
					cyp.state
				ELSE 
					cy.state 
				END LegalState,  
				CASE WHEN cy.country_uid IS NULL THEN 
					DECODE (cyp.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein')
				else 
					DECODE (cy.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein') 
				END legalcountry, 
				gt.text P_O_Box__c,
				cyp.zip_code P_O_BoxPostalCode__c,
				cyp.city p_o_boxcity__c, 
				DECODE (ec.language_uid, 
					246, 'German', 
					1303, 'English', 
					7770, 'French', 
					7771, 'Italian', '?'
				) PreferedLanguage__c,
				ec.structure__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,  
				regexp_replace(
					coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), '^([^0-9]*) (\d+[a-zA-Z]{0,3})?$', '\1') 
					||  ' ' 
					|| nvl(shipping_addr.x_street_house_no, 
						ltrim(regexp_substr(
							coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), ' (\d+[a-zA-Z]{0,3})?$')
						)
				)  Shippingstreet, 
				cy_shipping.zip_code Shippingpostalcode,
				cy_shipping.city shippingcity, 
				cy_shipping.state ShippingState,
				DECODE (cy_shipping.country_uid, 
					1001148, 'Schweiz', 
					1001161, 'Deutschland', 
					1001179, 'Frankreich', 
					1001215, 'Italien', 
					1001234, 'Liechtenstein'
				) ShippingCountry,
				gt_sh_po.text ShippingP_O_Box__c,
				cy_sh_po.zip_code ShippingP_O_Box_PostalCode__c, 
				cy_sh_po.city ShippingP_O_BoxCity__c,
				DECODE (ec.x_advisory_status_uid, 
					117411, 'Fieldsales', 
					117413, 'KAM-Fieldsales'
				) SalesChannel__c,
				tkam.text KAMType__c, 
				CASE 
					WHEN kuba.legal_form_uid IS NOT NULL THEN
						REPLACE (tlf.text, 'K' || chr(50108) || 'Ba: ', '') 
					WHEN ec.y_legal_status_uid  <> 0 THEN 
						DECODE (ec.y_legal_status_uid, 
							875976469, 'AG', 
							875976471, 'Einzelunternehmen', 
							875976476, 'Genossenschaft', 
							875976472, 'GmbH', 
							875976474, 'Kollektivgesellschaft', 
							5714572491, 'Kommanditgesellschaft', 
							875976464, 'Stiftung', 
							875976459, 'Verein', 
							null
						)  
				END legalentity__c, 
				kuba.federal_company_id UID__c,
				tnc.text noga1__c,
				CASE WHEN kuba.founding_year = 0 THEN NULL
				ELSE kuba.founding_year
				END  CompanySince__c,
				CASE 
					WHEN kuba.turnover BETWEEN 2000001 AND 99999999 THEN  'A'
					WHEN kuba.turnover BETWEEN 1000001 AND 2000000 THEN  'B'
					WHEN kuba.turnover BETWEEN 200001 AND 1000000 THEN  'C'           
					WHEN kuba.turnover BETWEEN 5001 AND 200000 THEN  'D'             
				END TurnoverClass__c,
				tne.text NumberOfEmployees,
				EC.Allowed_comm_channel__c,
				EC.Communication_Channel__c
			FROM exported_companies ec
				LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
				LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr
				LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
				LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
				LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
				LEFT JOIN bsicrm.bsi_global_text gt ON gt.global_text_nr = AP.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cyp ON cyp.city_nr = AP.city_nr
				LEFT JOIN bsicrm.bsi_address shipping_addr ON shipping_addr.address_nr = ec.ship_address_nr
				LEFT JOIN bsicrm.bsi_address shipping_apo ON shipping_apo.address_nr = ec.ship_apo_nr
				LEFT JOIN bsicrm.bsi_city cy_sh_po ON cy_sh_po.city_nr = shipping_apo.city_nr
				LEFT JOIN bsicrm.bsi_global_text gt_sh_po ON gt_sh_po.global_text_nr = shipping_apo.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cy_shipping ON cy_shipping.city_nr = shipping_addr.city_nr
				LEFT JOIN bsicrm.bsi_uc_text tkam ON tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tlf ON tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tnc ON tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tne ON tne.uc_uid = kuba.number_of_employees_uid and tne.language_ui, Error Msg = ORA-00920: Ungültiger relationaler Operator

!STACK 0
Error : 920, Position : 14537, Sql = -- SAMBA
WITH exported_companies AS (
				SELECT /*+ ordered use_hash(ejj ej company cc cc2 a sspa sspba) full(ejj) full(ej) full(company) full(cc) full(cc2) full(a) full(sspa) full(sspba) */
					company.x_complex_no,  -- accounts_samba
					TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
					company.language_uid,
					COMPANY.x_is_locked,
					ejj.join_nr,
					dbms_lob.substr(comp_samba.join_nos_samba, 4000, 1 ) join_nos_samba,
					dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx, 
					sadr.fone,
					sadr.handy,
					sadr.fax,
					sadr.email,
					sadr.www,
					kam.kamtyp,
					CASE 
						WHEN cc2.relation_uid = 300 THEN 'Group'
						WHEN cc2.relation_uid = 109876 THEN 'Company' 
						WHEN cc.relation_uid  = 300 THEN 'Company'
						WHEN cc.relation_uid  = 109876 THEN 'Branch'
						ELSE 'Single Company' 
					END structure__c, 
					sspa.address_nr address_nr,
					sspba.address_nr pobox_address_nr,
					ship_a.ship_anr  ship_address_nr,
					ship_ap.ship_apnr ship_apo_nr,
					company.y_legal_status_uid, 
					company.x_advisory_status_uid,  
					collection.join_nr coll_join_nr,
					kuba_data.kuba_join_nr,
					COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
					CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
						'Email'
					WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
						'Letter'
					WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
						'n.a.'
					END Communication_Channel__c
				FROM bsicrm.bsi_x_ext_join_join ejj
					JOIN bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
						AND ej.active = 1
					JOIN bsicrm.bsi_company company ON company.company_nr = ejj.join_nr 
						AND company.is_active = 1
					LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
					LEFT JOIN bsicrm.bsi_company_company cc ON cc.company_nr = ejj.join_nr
					LEFT JOIN (
						SELECT 
							cc2.group_company_nr, 
							MIN(cc2.relation_uid) relation_uid
						FROM bsicrm.bsi_company_company cc2 
						GROUP BY cc2.group_company_nr
					) cc2 ON cc2.group_company_nr = ejj.join_nr     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							MIN(ej2.kam_uid) kamtyp, 
							ejj2.join_nr innerjnr
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                     
						WHERE ej2.active = 1
						AND ej2.kam_uid != 0
						GROUP BY ejj2.join_nr
					) kam ON kam.innerjnr = ejj.join_nr  
					LEFT JOIN (
						SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
							adr.item_key0_nr,
							max (CASE WHEN adr.channel_uid = 113638 THEN adr.channel_value ELSE NULL END) fone,
							max (CASE WHEN adr.channel_uid = 113640 THEN adr.channel_value ELSE NULL END) handy,
							max (CASE WHEN adr.channel_uid = 113639 THEN adr.channel_value ELSE NULL END) fax,
							max (CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
							max (CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
						FROM bsicrm.bsi_address adr
							JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
							JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr and ej2.active = 1 AND ej2.interface_uid IN (108187,108205)
						WHERE adr.is_default_address = 1
							AND adr.item_type_id = 318594
						GROUP BY adr.item_key0_nr
					) sadr ON sadr.item_key0_nr = company.company_nr
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa ON  sspa.ext_join_nr = ejj.ext_join_nr
						AND sspa.join_type_uid = 318594
						AND sspa.type_uid = 2315 /* Hauptadresse */
						AND sspa.channel_uid = 113688
						AND sspa.join_nr = ejj.join_nr             
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba ON  sspba.ext_join_nr = ejj.ext_join_nr
						AND sspba.join_type_uid = 318594
						AND sspba.type_uid = 108240 /* Postfach */
						AND sspba.channel_uid = 113688
						AND sspba.join_nr = ejj.join_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_a au) full(ship_a) full(au) */
							ship_a.join_nr, 
							max (ship_a.address_nr )ship_aNr
						FROM bsicrm.bsi_x_address_mapping ship_a
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_a.address_nr
							AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_a.join_type_uid = 318594
							AND ship_a.channel_uid = 113688
							-- 2315:	Hauptadresse
							-- 108363:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedCode
							AND (ship_a.type_uid = 2315 OR  ship_a.type_uid = 108363)
						GROUP BY ship_a.join_nr
					) ship_a ON ship_a.join_nr = ejj.join_nr                     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_ap au) full(ship_ap) full(au) */
							ship_ap.join_nr, 
							max (ship_ap.address_nr ) ship_apnr
						FROM bsicrm.bsi_x_address_mapping ship_ap
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_ap.address_nr
								AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_ap.join_type_uid = 318594
							AND ship_ap.channel_uid = 113688
							-- 108240:	Postfach
							-- 108364:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedPoBoxCode
							AND (ship_ap.type_uid = 108240 OR  ship_ap.type_uid = 108364)
						GROUP BY ship_ap.join_nr
					) ship_ap ON  ship_ap.join_nr = ejj.join_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
							max (kd.join_nr) kuba_join_nr, 
							ejj2.join_nr             
						FROM bsicrm.bsi_x_ext_kuba_data kd
						JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr 
							AND ej2.ext_join_type_uid = kd.join_type_uid AND ej2.active = 1
						JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr 
							AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
						WHERE kd.status_uid = 4800511372 --aktiv  
						GROUP BY ejj2.join_nr
					) kuba_data ON kuba_data.join_nr = company.company_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
							DISTINCT ejjinner.join_nr 
						FROM bsicrm.bsi_x_collection coll 
							JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr 
								AND ejinner.active = 1
							JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
						WHERE coll.status_uid <> 137824
					) collection ON collection.join_nr = company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_samba
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108187
						GROUP BY ejj2.join_nr
					) comp_samba ON comp_samba.join_nr =  company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108205
						GROUP BY ejj2.join_nr
					) comp_nx ON comp_nx.join_nr =  company.company_nr  
				WHERE  ejj.is_master = 1
					AND    ejj.ext_join_type_uid = 108224
					AND    ej.interface_uid  = 108187 --samba      
			),
			dunning AS (
				SELECT /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
					distinct ejj.join_nr -- company.x_complex_no                    
				FROM bsicrm.bsi_x_ext_receipt xrcp
					JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr
						AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
					JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid
				WHERE xrcp.overdue_level_uid IN (137663,137664,137665) 
			)  
			SELECT /*+ ordered use_hash(kuba dnng legaladdr cy ap gt cyp shipping_addr shipping_apo cy_sh_po gt_sh_po cy_shipping tkam tlf tnc tne) 
                   full(kuba) full(dnng) full(legaladdr) full(cy) full(ap) full(gt) full(cyp) full(shipping_addr) full(shipping_apo) full(cy_sh_po) full(gt_sh_po) full(cy_shipping) full(tkam) full(tlf) full(tnc) full(tne) */
				distinct ec.x_complex_no uk_LCM_X_COMPLEX_NO__c,
				ec.NAME,
				ec.join_nos_samba LCM_Samba_MergeIDs__c,
				ec.join_nos_nx LCM_NX_MergeIDs__c,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%'  
				THEN  NULL
				ELSE ec.fone           
				END Phone,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%' 
				THEN  ec.fone
				ELSE ec.handy           
				END MobilePhone, 
				ec.fax fax, 
				CASE WHEN ec.email LIKE 'etv@%' THEN  NULL
				ELSE ec.email           
				END email__c,
				ec.www website,
				NVL(RTRIM (legaladdr.x_street_name||' '||legaladdr.x_street_house_no), legaladdr.postal_display_street) legalstreet, 
				cy.zip_code LegalPostalCode,
				cy.city legalcity,
				CASE WHEN cy.state IS NULL THEN 
					cyp.state
				ELSE 
					cy.state 
				END LegalState,  
				CASE WHEN cy.country_uid IS NULL THEN 
					DECODE (cyp.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein')
				else 
					DECODE (cy.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein') 
				END legalcountry, 
				gt.text P_O_Box__c,
				cyp.zip_code P_O_BoxPostalCode__c,
				cyp.city p_o_boxcity__c, 
				DECODE (ec.language_uid, 
					246, 'German', 
					1303, 'English', 
					7770, 'French', 
					7771, 'Italian', '?'
				) PreferedLanguage__c,
				ec.structure__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,  
				regexp_replace(
					coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), '^([^0-9]*) (\d+[a-zA-Z]{0,3})?$', '\1') 
					||  ' ' 
					|| nvl(shipping_addr.x_street_house_no, 
						ltrim(regexp_substr(
							coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), ' (\d+[a-zA-Z]{0,3})?$')
						)
				)  Shippingstreet, 
				cy_shipping.zip_code Shippingpostalcode,
				cy_shipping.city shippingcity, 
				cy_shipping.state ShippingState,
				DECODE (cy_shipping.country_uid, 
					1001148, 'Schweiz', 
					1001161, 'Deutschland', 
					1001179, 'Frankreich', 
					1001215, 'Italien', 
					1001234, 'Liechtenstein'
				) ShippingCountry,
				gt_sh_po.text ShippingP_O_Box__c,
				cy_sh_po.zip_code ShippingP_O_Box_PostalCode__c, 
				cy_sh_po.city ShippingP_O_BoxCity__c,
				DECODE (ec.x_advisory_status_uid, 
					117411, 'Fieldsales', 
					117413, 'KAM-Fieldsales'
				) SalesChannel__c,
				tkam.text KAMType__c, 
				CASE 
					WHEN kuba.legal_form_uid IS NOT NULL THEN
						REPLACE (tlf.text, 'K' || chr(50108) || 'Ba: ', '') 
					WHEN ec.y_legal_status_uid  <> 0 THEN 
						DECODE (ec.y_legal_status_uid, 
							875976469, 'AG', 
							875976471, 'Einzelunternehmen', 
							875976476, 'Genossenschaft', 
							875976472, 'GmbH', 
							875976474, 'Kollektivgesellschaft', 
							5714572491, 'Kommanditgesellschaft', 
							875976464, 'Stiftung', 
							875976459, 'Verein', 
							null
						)  
				END legalentity__c, 
				kuba.federal_company_id UID__c,
				tnc.text noga1__c,
				CASE WHEN kuba.founding_year = 0 THEN NULL
				ELSE kuba.founding_year
				END  CompanySince__c,
				CASE 
					WHEN kuba.turnover BETWEEN 2000001 AND 99999999 THEN  'A'
					WHEN kuba.turnover BETWEEN 1000001 AND 2000000 THEN  'B'
					WHEN kuba.turnover BETWEEN 200001 AND 1000000 THEN  'C'           
					WHEN kuba.turnover BETWEEN 5001 AND 200000 THEN  'D'             
				END TurnoverClass__c,
				tne.text NumberOfEmployees,
				EC.Allowed_comm_channel__c,
				EC.Communication_Channel__c
			FROM exported_companies ec
				LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
				LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr
				LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
				LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
				LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
				LEFT JOIN bsicrm.bsi_global_text gt ON gt.global_text_nr = AP.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cyp ON cyp.city_nr = AP.city_nr
				LEFT JOIN bsicrm.bsi_address shipping_addr ON shipping_addr.address_nr = ec.ship_address_nr
				LEFT JOIN bsicrm.bsi_address shipping_apo ON shipping_apo.address_nr = ec.ship_apo_nr
				LEFT JOIN bsicrm.bsi_city cy_sh_po ON cy_sh_po.city_nr = shipping_apo.city_nr
				LEFT JOIN bsicrm.bsi_global_text gt_sh_po ON gt_sh_po.global_text_nr = shipping_apo.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cy_shipping ON cy_shipping.city_nr = shipping_addr.city_nr
				LEFT JOIN bsicrm.bsi_uc_text tkam ON tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tlf ON tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tnc ON tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tne ON tne.uc_uid = kuba.number_of_employees_uid and tne.language_ui, OriginalSql = -- SAMBA
WITH exported_companies AS (
				SELECT /*+ ordered use_hash(ejj ej company cc cc2 a sspa sspba) full(ejj) full(ej) full(company) full(cc) full(cc2) full(a) full(sspa) full(sspba) */
					company.x_complex_no,  -- accounts_samba
					TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
					company.language_uid,
					COMPANY.x_is_locked,
					ejj.join_nr,
					dbms_lob.substr(comp_samba.join_nos_samba, 4000, 1 ) join_nos_samba,
					dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx, 
					sadr.fone,
					sadr.handy,
					sadr.fax,
					sadr.email,
					sadr.www,
					kam.kamtyp,
					CASE 
						WHEN cc2.relation_uid = 300 THEN 'Group'
						WHEN cc2.relation_uid = 109876 THEN 'Company' 
						WHEN cc.relation_uid  = 300 THEN 'Company'
						WHEN cc.relation_uid  = 109876 THEN 'Branch'
						ELSE 'Single Company' 
					END structure__c, 
					sspa.address_nr address_nr,
					sspba.address_nr pobox_address_nr,
					ship_a.ship_anr  ship_address_nr,
					ship_ap.ship_apnr ship_apo_nr,
					company.y_legal_status_uid, 
					company.x_advisory_status_uid,  
					collection.join_nr coll_join_nr,
					kuba_data.kuba_join_nr,
					COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
					CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
						'Email'
					WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
						'Letter'
					WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
						'n.a.'
					END Communication_Channel__c
				FROM bsicrm.bsi_x_ext_join_join ejj
					JOIN bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
						AND ej.active = 1
					JOIN bsicrm.bsi_company company ON company.company_nr = ejj.join_nr 
						AND company.is_active = 1
					LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
					LEFT JOIN bsicrm.bsi_company_company cc ON cc.company_nr = ejj.join_nr
					LEFT JOIN (
						SELECT 
							cc2.group_company_nr, 
							MIN(cc2.relation_uid) relation_uid
						FROM bsicrm.bsi_company_company cc2 
						GROUP BY cc2.group_company_nr
					) cc2 ON cc2.group_company_nr = ejj.join_nr     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							MIN(ej2.kam_uid) kamtyp, 
							ejj2.join_nr innerjnr
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                     
						WHERE ej2.active = 1
						AND ej2.kam_uid != 0
						GROUP BY ejj2.join_nr
					) kam ON kam.innerjnr = ejj.join_nr  
					LEFT JOIN (
						SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
							adr.item_key0_nr,
							max (CASE WHEN adr.channel_uid = 113638 THEN adr.channel_value ELSE NULL END) fone,
							max (CASE WHEN adr.channel_uid = 113640 THEN adr.channel_value ELSE NULL END) handy,
							max (CASE WHEN adr.channel_uid = 113639 THEN adr.channel_value ELSE NULL END) fax,
							max (CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
							max (CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
						FROM bsicrm.bsi_address adr
							JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
							JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr and ej2.active = 1 AND ej2.interface_uid IN (108187,108205)
						WHERE adr.is_default_address = 1
							AND adr.item_type_id = 318594
						GROUP BY adr.item_key0_nr
					) sadr ON sadr.item_key0_nr = company.company_nr
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa ON  sspa.ext_join_nr = ejj.ext_join_nr
						AND sspa.join_type_uid = 318594
						AND sspa.type_uid = 2315 /* Hauptadresse */
						AND sspa.channel_uid = 113688
						AND sspa.join_nr = ejj.join_nr             
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba ON  sspba.ext_join_nr = ejj.ext_join_nr
						AND sspba.join_type_uid = 318594
						AND sspba.type_uid = 108240 /* Postfach */
						AND sspba.channel_uid = 113688
						AND sspba.join_nr = ejj.join_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_a au) full(ship_a) full(au) */
							ship_a.join_nr, 
							max (ship_a.address_nr )ship_aNr
						FROM bsicrm.bsi_x_address_mapping ship_a
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_a.address_nr
							AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_a.join_type_uid = 318594
							AND ship_a.channel_uid = 113688
							-- 2315:	Hauptadresse
							-- 108363:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedCode
							AND (ship_a.type_uid = 2315 OR  ship_a.type_uid = 108363)
						GROUP BY ship_a.join_nr
					) ship_a ON ship_a.join_nr = ejj.join_nr                     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_ap au) full(ship_ap) full(au) */
							ship_ap.join_nr, 
							max (ship_ap.address_nr ) ship_apnr
						FROM bsicrm.bsi_x_address_mapping ship_ap
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_ap.address_nr
								AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_ap.join_type_uid = 318594
							AND ship_ap.channel_uid = 113688
							-- 108240:	Postfach
							-- 108364:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedPoBoxCode
							AND (ship_ap.type_uid = 108240 OR  ship_ap.type_uid = 108364)
						GROUP BY ship_ap.join_nr
					) ship_ap ON  ship_ap.join_nr = ejj.join_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
							max (kd.join_nr) kuba_join_nr, 
							ejj2.join_nr             
						FROM bsicrm.bsi_x_ext_kuba_data kd
						JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr 
							AND ej2.ext_join_type_uid = kd.join_type_uid AND ej2.active = 1
						JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr 
							AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
						WHERE kd.status_uid = 4800511372 --aktiv  
						GROUP BY ejj2.join_nr
					) kuba_data ON kuba_data.join_nr = company.company_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
							DISTINCT ejjinner.join_nr 
						FROM bsicrm.bsi_x_collection coll 
							JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr 
								AND ejinner.active = 1
							JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
						WHERE coll.status_uid <> 137824
					) collection ON collection.join_nr = company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_samba
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108187
						GROUP BY ejj2.join_nr
					) comp_samba ON comp_samba.join_nr =  company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108205
						GROUP BY ejj2.join_nr
					) comp_nx ON comp_nx.join_nr =  company.company_nr  
				WHERE  ejj.is_master = 1
					AND    ejj.ext_join_type_uid = 108224
					AND    ej.interface_uid  = 108187 --samba      
			),
			dunning AS (
				SELECT /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
					distinct ejj.join_nr -- company.x_complex_no                    
				FROM bsicrm.bsi_x_ext_receipt xrcp
					JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr
						AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
					JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid
				WHERE xrcp.overdue_level_uid IN (137663,137664,137665) 
			)  
			SELECT /*+ ordered use_hash(kuba dnng legaladdr cy ap gt cyp shipping_addr shipping_apo cy_sh_po gt_sh_po cy_shipping tkam tlf tnc tne) 
                   full(kuba) full(dnng) full(legaladdr) full(cy) full(ap) full(gt) full(cyp) full(shipping_addr) full(shipping_apo) full(cy_sh_po) full(gt_sh_po) full(cy_shipping) full(tkam) full(tlf) full(tnc) full(tne) */
				distinct ec.x_complex_no uk_LCM_X_COMPLEX_NO__c,
				ec.NAME,
				ec.join_nos_samba LCM_Samba_MergeIDs__c,
				ec.join_nos_nx LCM_NX_MergeIDs__c,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%'  
				THEN  NULL
				ELSE ec.fone           
				END Phone,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%' 
				THEN  ec.fone
				ELSE ec.handy           
				END MobilePhone, 
				ec.fax fax, 
				CASE WHEN ec.email LIKE 'etv@%' THEN  NULL
				ELSE ec.email           
				END email__c,
				ec.www website,
				NVL(RTRIM (legaladdr.x_street_name||' '||legaladdr.x_street_house_no), legaladdr.postal_display_street) legalstreet, 
				cy.zip_code LegalPostalCode,
				cy.city legalcity,
				CASE WHEN cy.state IS NULL THEN 
					cyp.state
				ELSE 
					cy.state 
				END LegalState,  
				CASE WHEN cy.country_uid IS NULL THEN 
					DECODE (cyp.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein')
				else 
					DECODE (cy.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein') 
				END legalcountry, 
				gt.text P_O_Box__c,
				cyp.zip_code P_O_BoxPostalCode__c,
				cyp.city p_o_boxcity__c, 
				DECODE (ec.language_uid, 
					246, 'German', 
					1303, 'English', 
					7770, 'French', 
					7771, 'Italian', '?'
				) PreferedLanguage__c,
				ec.structure__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,  
				regexp_replace(
					coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), '^([^0-9]*) (\d+[a-zA-Z]{0,3})?$', '\1') 
					||  ' ' 
					|| nvl(shipping_addr.x_street_house_no, 
						ltrim(regexp_substr(
							coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), ' (\d+[a-zA-Z]{0,3})?$')
						)
				)  Shippingstreet, 
				cy_shipping.zip_code Shippingpostalcode,
				cy_shipping.city shippingcity, 
				cy_shipping.state ShippingState,
				DECODE (cy_shipping.country_uid, 
					1001148, 'Schweiz', 
					1001161, 'Deutschland', 
					1001179, 'Frankreich', 
					1001215, 'Italien', 
					1001234, 'Liechtenstein'
				) ShippingCountry,
				gt_sh_po.text ShippingP_O_Box__c,
				cy_sh_po.zip_code ShippingP_O_Box_PostalCode__c, 
				cy_sh_po.city ShippingP_O_BoxCity__c,
				DECODE (ec.x_advisory_status_uid, 
					117411, 'Fieldsales', 
					117413, 'KAM-Fieldsales'
				) SalesChannel__c,
				tkam.text KAMType__c, 
				CASE 
					WHEN kuba.legal_form_uid IS NOT NULL THEN
						REPLACE (tlf.text, 'K' || chr(50108) || 'Ba: ', '') 
					WHEN ec.y_legal_status_uid  <> 0 THEN 
						DECODE (ec.y_legal_status_uid, 
							875976469, 'AG', 
							875976471, 'Einzelunternehmen', 
							875976476, 'Genossenschaft', 
							875976472, 'GmbH', 
							875976474, 'Kollektivgesellschaft', 
							5714572491, 'Kommanditgesellschaft', 
							875976464, 'Stiftung', 
							875976459, 'Verein', 
							null
						)  
				END legalentity__c, 
				kuba.federal_company_id UID__c,
				tnc.text noga1__c,
				CASE WHEN kuba.founding_year = 0 THEN NULL
				ELSE kuba.founding_year
				END  CompanySince__c,
				CASE 
					WHEN kuba.turnover BETWEEN 2000001 AND 99999999 THEN  'A'
					WHEN kuba.turnover BETWEEN 1000001 AND 2000000 THEN  'B'
					WHEN kuba.turnover BETWEEN 200001 AND 1000000 THEN  'C'           
					WHEN kuba.turnover BETWEEN 5001 AND 200000 THEN  'D'             
				END TurnoverClass__c,
				tne.text NumberOfEmployees,
				EC.Allowed_comm_channel__c,
				EC.Communication_Channel__c
			FROM exported_companies ec
				LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
				LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr
				LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
				LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
				LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
				LEFT JOIN bsicrm.bsi_global_text gt ON gt.global_text_nr = AP.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cyp ON cyp.city_nr = AP.city_nr
				LEFT JOIN bsicrm.bsi_address shipping_addr ON shipping_addr.address_nr = ec.ship_address_nr
				LEFT JOIN bsicrm.bsi_address shipping_apo ON shipping_apo.address_nr = ec.ship_apo_nr
				LEFT JOIN bsicrm.bsi_city cy_sh_po ON cy_sh_po.city_nr = shipping_apo.city_nr
				LEFT JOIN bsicrm.bsi_global_text gt_sh_po ON gt_sh_po.global_text_nr = shipping_apo.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cy_shipping ON cy_shipping.city_nr = shipping_addr.city_nr
				LEFT JOIN bsicrm.bsi_uc_text tkam ON tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tlf ON tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tnc ON tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tne ON tne.uc_uid = kuba.number_of_employees_uid and tne.language_ui, Error Msg = ORA-00920: Ungültiger relationaler Operator

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-10-31 18:53:15.862
!MESSAGE SQL-Fehler [1013] [72000]: ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-10-31 18:53:15.862
!MESSAGE Error : 1013, Position : 0, Sql = -- SAMBA
WITH exported_companies AS (
				SELECT /*+ ordered use_hash(ejj ej company cc cc2 a sspa sspba) full(ejj) full(ej) full(company) full(cc) full(cc2) full(a) full(sspa) full(sspba) */
					company.x_complex_no,  -- accounts_samba
					TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
					company.language_uid,
					COMPANY.x_is_locked,
					ejj.join_nr,
					dbms_lob.substr(comp_samba.join_nos_samba, 4000, 1 ) join_nos_samba,
					dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx, 
					sadr.fone,
					sadr.handy,
					sadr.fax,
					sadr.email,
					sadr.www,
					kam.kamtyp,
					CASE 
						WHEN cc2.relation_uid = 300 THEN 'Group'
						WHEN cc2.relation_uid = 109876 THEN 'Company' 
						WHEN cc.relation_uid  = 300 THEN 'Company'
						WHEN cc.relation_uid  = 109876 THEN 'Branch'
						ELSE 'Single Company' 
					END structure__c, 
					sspa.address_nr address_nr,
					sspba.address_nr pobox_address_nr,
					ship_a.ship_anr  ship_address_nr,
					ship_ap.ship_apnr ship_apo_nr,
					company.y_legal_status_uid, 
					company.x_advisory_status_uid,  
					collection.join_nr coll_join_nr,
					kuba_data.kuba_join_nr,
					COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
					CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
						'Email'
					WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
						'Letter'
					WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
						'n.a.'
					END Communication_Channel__c
				FROM bsicrm.bsi_x_ext_join_join ejj
					JOIN bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
						AND ej.active = 1
					JOIN bsicrm.bsi_company company ON company.company_nr = ejj.join_nr 
						AND company.is_active = 1
					LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
					LEFT JOIN bsicrm.bsi_company_company cc ON cc.company_nr = ejj.join_nr
					LEFT JOIN (
						SELECT 
							cc2.group_company_nr, 
							MIN(cc2.relation_uid) relation_uid
						FROM bsicrm.bsi_company_company cc2 
						GROUP BY cc2.group_company_nr
					) cc2 ON cc2.group_company_nr = ejj.join_nr     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							MIN(ej2.kam_uid) kamtyp, 
							ejj2.join_nr innerjnr
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                     
						WHERE ej2.active = 1
						AND ej2.kam_uid != 0
						GROUP BY ejj2.join_nr
					) kam ON kam.innerjnr = ejj.join_nr  
					LEFT JOIN (
						SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
							adr.item_key0_nr,
							max (CASE WHEN adr.channel_uid = 113638 THEN adr.channel_value ELSE NULL END) fone,
							max (CASE WHEN adr.channel_uid = 113640 THEN adr.channel_value ELSE NULL END) handy,
							max (CASE WHEN adr.channel_uid = 113639 THEN adr.channel_value ELSE NULL END) fax,
							max (CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
							max (CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
						FROM bsicrm.bsi_address adr
							JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
							JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr and ej2.active = 1 AND ej2.interface_uid IN (108187,108205)
						WHERE adr.is_default_address = 1
							AND adr.item_type_id = 318594
						GROUP BY adr.item_key0_nr
					) sadr ON sadr.item_key0_nr = company.company_nr
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa ON  sspa.ext_join_nr = ejj.ext_join_nr
						AND sspa.join_type_uid = 318594
						AND sspa.type_uid = 2315 /* Hauptadresse */
						AND sspa.channel_uid = 113688
						AND sspa.join_nr = ejj.join_nr             
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba ON  sspba.ext_join_nr = ejj.ext_join_nr
						AND sspba.join_type_uid = 318594
						AND sspba.type_uid = 108240 /* Postfach */
						AND sspba.channel_uid = 113688
						AND sspba.join_nr = ejj.join_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_a au) full(ship_a) full(au) */
							ship_a.join_nr, 
							max (ship_a.address_nr )ship_aNr
						FROM bsicrm.bsi_x_address_mapping ship_a
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_a.address_nr
							AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_a.join_type_uid = 318594
							AND ship_a.channel_uid = 113688
							-- 2315:	Hauptadresse
							-- 108363:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedCode
							AND (ship_a.type_uid = 2315 OR  ship_a.type_uid = 108363)
						GROUP BY ship_a.join_nr
					) ship_a ON ship_a.join_nr = ejj.join_nr                     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_ap au) full(ship_ap) full(au) */
							ship_ap.join_nr, 
							max (ship_ap.address_nr ) ship_apnr
						FROM bsicrm.bsi_x_address_mapping ship_ap
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_ap.address_nr
								AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_ap.join_type_uid = 318594
							AND ship_ap.channel_uid = 113688
							-- 108240:	Postfach
							-- 108364:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedPoBoxCode
							AND (ship_ap.type_uid = 108240 OR  ship_ap.type_uid = 108364)
						GROUP BY ship_ap.join_nr
					) ship_ap ON  ship_ap.join_nr = ejj.join_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
							max (kd.join_nr) kuba_join_nr, 
							ejj2.join_nr             
						FROM bsicrm.bsi_x_ext_kuba_data kd
						JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr 
							AND ej2.ext_join_type_uid = kd.join_type_uid AND ej2.active = 1
						JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr 
							AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
						WHERE kd.status_uid = 4800511372 --aktiv  
						GROUP BY ejj2.join_nr
					) kuba_data ON kuba_data.join_nr = company.company_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
							DISTINCT ejjinner.join_nr 
						FROM bsicrm.bsi_x_collection coll 
							JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr 
								AND ejinner.active = 1
							JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
						WHERE coll.status_uid <> 137824
					) collection ON collection.join_nr = company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_samba
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108187
						GROUP BY ejj2.join_nr
					) comp_samba ON comp_samba.join_nr =  company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108205
						GROUP BY ejj2.join_nr
					) comp_nx ON comp_nx.join_nr =  company.company_nr  
				WHERE  ejj.is_master = 1
					AND    ejj.ext_join_type_uid = 108224
					AND    ej.interface_uid  = 108187 --samba      
			),
			dunning AS (
				SELECT /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
					distinct ejj.join_nr -- company.x_complex_no                    
				FROM bsicrm.bsi_x_ext_receipt xrcp
					JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr
						AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
					JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid
				WHERE xrcp.overdue_level_uid IN (137663,137664,137665) 
			)  
			SELECT /*+ ordered use_hash(kuba dnng legaladdr cy ap gt cyp shipping_addr shipping_apo cy_sh_po gt_sh_po cy_shipping tkam tlf tnc tne) 
                   full(kuba) full(dnng) full(legaladdr) full(cy) full(ap) full(gt) full(cyp) full(shipping_addr) full(shipping_apo) full(cy_sh_po) full(gt_sh_po) full(cy_shipping) full(tkam) full(tlf) full(tnc) full(tne) */
				distinct ec.x_complex_no uk_LCM_X_COMPLEX_NO__c,
				ec.NAME,
				ec.join_nos_samba LCM_Samba_MergeIDs__c,
				ec.join_nos_nx LCM_NX_MergeIDs__c,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%'  
				THEN  NULL
				ELSE ec.fone           
				END Phone,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%' 
				THEN  ec.fone
				ELSE ec.handy           
				END MobilePhone, 
				ec.fax fax, 
				CASE WHEN ec.email LIKE 'etv@%' THEN  NULL
				ELSE ec.email           
				END email__c,
				ec.www website,
				NVL(RTRIM (legaladdr.x_street_name||' '||legaladdr.x_street_house_no), legaladdr.postal_display_street) legalstreet, 
				cy.zip_code LegalPostalCode,
				cy.city legalcity,
				CASE WHEN cy.state IS NULL THEN 
					cyp.state
				ELSE 
					cy.state 
				END LegalState,  
				CASE WHEN cy.country_uid IS NULL THEN 
					DECODE (cyp.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein')
				else 
					DECODE (cy.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein') 
				END legalcountry, 
				gt.text P_O_Box__c,
				cyp.zip_code P_O_BoxPostalCode__c,
				cyp.city p_o_boxcity__c, 
				DECODE (ec.language_uid, 
					246, 'German', 
					1303, 'English', 
					7770, 'French', 
					7771, 'Italian', '?'
				) PreferedLanguage__c,
				ec.structure__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,  
				regexp_replace(
					coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), '^([^0-9]*) (\d+[a-zA-Z]{0,3})?$', '\1') 
					||  ' ' 
					|| nvl(shipping_addr.x_street_house_no, 
						ltrim(regexp_substr(
							coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), ' (\d+[a-zA-Z]{0,3})?$')
						)
				)  Shippingstreet, 
				cy_shipping.zip_code Shippingpostalcode,
				cy_shipping.city shippingcity, 
				cy_shipping.state ShippingState,
				DECODE (cy_shipping.country_uid, 
					1001148, 'Schweiz', 
					1001161, 'Deutschland', 
					1001179, 'Frankreich', 
					1001215, 'Italien', 
					1001234, 'Liechtenstein'
				) ShippingCountry,
				gt_sh_po.text ShippingP_O_Box__c,
				cy_sh_po.zip_code ShippingP_O_Box_PostalCode__c, 
				cy_sh_po.city ShippingP_O_BoxCity__c,
				DECODE (ec.x_advisory_status_uid, 
					117411, 'Fieldsales', 
					117413, 'KAM-Fieldsales'
				) SalesChannel__c,
				tkam.text KAMType__c, 
				CASE 
					WHEN kuba.legal_form_uid IS NOT NULL THEN
						REPLACE (tlf.text, 'K' || chr(50108) || 'Ba: ', '') 
					WHEN ec.y_legal_status_uid  <> 0 THEN 
						DECODE (ec.y_legal_status_uid, 
							875976469, 'AG', 
							875976471, 'Einzelunternehmen', 
							875976476, 'Genossenschaft', 
							875976472, 'GmbH', 
							875976474, 'Kollektivgesellschaft', 
							5714572491, 'Kommanditgesellschaft', 
							875976464, 'Stiftung', 
							875976459, 'Verein', 
							null
						)  
				END legalentity__c, 
				kuba.federal_company_id UID__c,
				tnc.text noga1__c,
				CASE WHEN kuba.founding_year = 0 THEN NULL
				ELSE kuba.founding_year
				END  CompanySince__c,
				CASE 
					WHEN kuba.turnover BETWEEN 2000001 AND 99999999 THEN  'A'
					WHEN kuba.turnover BETWEEN 1000001 AND 2000000 THEN  'B'
					WHEN kuba.turnover BETWEEN 200001 AND 1000000 THEN  'C'           
					WHEN kuba.turnover BETWEEN 5001 AND 200000 THEN  'D'             
				END TurnoverClass__c,
				tne.text NumberOfEmployees,
				EC.Allowed_comm_channel__c,
				EC.Communication_Channel__c
			FROM exported_companies ec
				LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
				LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr
				LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
				LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
				LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
				LEFT JOIN bsicrm.bsi_global_text gt ON gt.global_text_nr = AP.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cyp ON cyp.city_nr = AP.city_nr
				LEFT JOIN bsicrm.bsi_address shipping_addr ON shipping_addr.address_nr = ec.ship_address_nr
				LEFT JOIN bsicrm.bsi_address shipping_apo ON shipping_apo.address_nr = ec.ship_apo_nr
				LEFT JOIN bsicrm.bsi_city cy_sh_po ON cy_sh_po.city_nr = shipping_apo.city_nr
				LEFT JOIN bsicrm.bsi_global_text gt_sh_po ON gt_sh_po.global_text_nr = shipping_apo.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cy_shipping ON cy_shipping.city_nr = shipping_addr.city_nr
				LEFT JOIN bsicrm.bsi_uc_text tkam ON tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tlf ON tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tnc ON tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tne ON tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, OriginalSql = -- SAMBA
WITH exported_companies AS (
				SELECT /*+ ordered use_hash(ejj ej company cc cc2 a sspa sspba) full(ejj) full(ej) full(company) full(cc) full(cc2) full(a) full(sspa) full(sspba) */
					company.x_complex_no,  -- accounts_samba
					TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
					company.language_uid,
					COMPANY.x_is_locked,
					ejj.join_nr,
					dbms_lob.substr(comp_samba.join_nos_samba, 4000, 1 ) join_nos_samba,
					dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx, 
					sadr.fone,
					sadr.handy,
					sadr.fax,
					sadr.email,
					sadr.www,
					kam.kamtyp,
					CASE 
						WHEN cc2.relation_uid = 300 THEN 'Group'
						WHEN cc2.relation_uid = 109876 THEN 'Company' 
						WHEN cc.relation_uid  = 300 THEN 'Company'
						WHEN cc.relation_uid  = 109876 THEN 'Branch'
						ELSE 'Single Company' 
					END structure__c, 
					sspa.address_nr address_nr,
					sspba.address_nr pobox_address_nr,
					ship_a.ship_anr  ship_address_nr,
					ship_ap.ship_apnr ship_apo_nr,
					company.y_legal_status_uid, 
					company.x_advisory_status_uid,  
					collection.join_nr coll_join_nr,
					kuba_data.kuba_join_nr,
					COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
					CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
						'Email'
					WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
						'Letter'
					WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
						'n.a.'
					END Communication_Channel__c
				FROM bsicrm.bsi_x_ext_join_join ejj
					JOIN bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
						AND ej.active = 1
					JOIN bsicrm.bsi_company company ON company.company_nr = ejj.join_nr 
						AND company.is_active = 1
					LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
					LEFT JOIN bsicrm.bsi_company_company cc ON cc.company_nr = ejj.join_nr
					LEFT JOIN (
						SELECT 
							cc2.group_company_nr, 
							MIN(cc2.relation_uid) relation_uid
						FROM bsicrm.bsi_company_company cc2 
						GROUP BY cc2.group_company_nr
					) cc2 ON cc2.group_company_nr = ejj.join_nr     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							MIN(ej2.kam_uid) kamtyp, 
							ejj2.join_nr innerjnr
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                     
						WHERE ej2.active = 1
						AND ej2.kam_uid != 0
						GROUP BY ejj2.join_nr
					) kam ON kam.innerjnr = ejj.join_nr  
					LEFT JOIN (
						SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
							adr.item_key0_nr,
							max (CASE WHEN adr.channel_uid = 113638 THEN adr.channel_value ELSE NULL END) fone,
							max (CASE WHEN adr.channel_uid = 113640 THEN adr.channel_value ELSE NULL END) handy,
							max (CASE WHEN adr.channel_uid = 113639 THEN adr.channel_value ELSE NULL END) fax,
							max (CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
							max (CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
						FROM bsicrm.bsi_address adr
							JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
							JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr and ej2.active = 1 AND ej2.interface_uid IN (108187,108205)
						WHERE adr.is_default_address = 1
							AND adr.item_type_id = 318594
						GROUP BY adr.item_key0_nr
					) sadr ON sadr.item_key0_nr = company.company_nr
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa ON  sspa.ext_join_nr = ejj.ext_join_nr
						AND sspa.join_type_uid = 318594
						AND sspa.type_uid = 2315 /* Hauptadresse */
						AND sspa.channel_uid = 113688
						AND sspa.join_nr = ejj.join_nr             
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba ON  sspba.ext_join_nr = ejj.ext_join_nr
						AND sspba.join_type_uid = 318594
						AND sspba.type_uid = 108240 /* Postfach */
						AND sspba.channel_uid = 113688
						AND sspba.join_nr = ejj.join_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_a au) full(ship_a) full(au) */
							ship_a.join_nr, 
							max (ship_a.address_nr )ship_aNr
						FROM bsicrm.bsi_x_address_mapping ship_a
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_a.address_nr
							AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_a.join_type_uid = 318594
							AND ship_a.channel_uid = 113688
							-- 2315:	Hauptadresse
							-- 108363:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedCode
							AND (ship_a.type_uid = 2315 OR  ship_a.type_uid = 108363)
						GROUP BY ship_a.join_nr
					) ship_a ON ship_a.join_nr = ejj.join_nr                     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_ap au) full(ship_ap) full(au) */
							ship_ap.join_nr, 
							max (ship_ap.address_nr ) ship_apnr
						FROM bsicrm.bsi_x_address_mapping ship_ap
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_ap.address_nr
								AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_ap.join_type_uid = 318594
							AND ship_ap.channel_uid = 113688
							-- 108240:	Postfach
							-- 108364:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedPoBoxCode
							AND (ship_ap.type_uid = 108240 OR  ship_ap.type_uid = 108364)
						GROUP BY ship_ap.join_nr
					) ship_ap ON  ship_ap.join_nr = ejj.join_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
							max (kd.join_nr) kuba_join_nr, 
							ejj2.join_nr             
						FROM bsicrm.bsi_x_ext_kuba_data kd
						JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr 
							AND ej2.ext_join_type_uid = kd.join_type_uid AND ej2.active = 1
						JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr 
							AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
						WHERE kd.status_uid = 4800511372 --aktiv  
						GROUP BY ejj2.join_nr
					) kuba_data ON kuba_data.join_nr = company.company_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
							DISTINCT ejjinner.join_nr 
						FROM bsicrm.bsi_x_collection coll 
							JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr 
								AND ejinner.active = 1
							JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
						WHERE coll.status_uid <> 137824
					) collection ON collection.join_nr = company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_samba
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108187
						GROUP BY ejj2.join_nr
					) comp_samba ON comp_samba.join_nr =  company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108205
						GROUP BY ejj2.join_nr
					) comp_nx ON comp_nx.join_nr =  company.company_nr  
				WHERE  ejj.is_master = 1
					AND    ejj.ext_join_type_uid = 108224
					AND    ej.interface_uid  = 108187 --samba      
			),
			dunning AS (
				SELECT /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
					distinct ejj.join_nr -- company.x_complex_no                    
				FROM bsicrm.bsi_x_ext_receipt xrcp
					JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr
						AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
					JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid
				WHERE xrcp.overdue_level_uid IN (137663,137664,137665) 
			)  
			SELECT /*+ ordered use_hash(kuba dnng legaladdr cy ap gt cyp shipping_addr shipping_apo cy_sh_po gt_sh_po cy_shipping tkam tlf tnc tne) 
                   full(kuba) full(dnng) full(legaladdr) full(cy) full(ap) full(gt) full(cyp) full(shipping_addr) full(shipping_apo) full(cy_sh_po) full(gt_sh_po) full(cy_shipping) full(tkam) full(tlf) full(tnc) full(tne) */
				distinct ec.x_complex_no uk_LCM_X_COMPLEX_NO__c,
				ec.NAME,
				ec.join_nos_samba LCM_Samba_MergeIDs__c,
				ec.join_nos_nx LCM_NX_MergeIDs__c,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%'  
				THEN  NULL
				ELSE ec.fone           
				END Phone,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%' 
				THEN  ec.fone
				ELSE ec.handy           
				END MobilePhone, 
				ec.fax fax, 
				CASE WHEN ec.email LIKE 'etv@%' THEN  NULL
				ELSE ec.email           
				END email__c,
				ec.www website,
				NVL(RTRIM (legaladdr.x_street_name||' '||legaladdr.x_street_house_no), legaladdr.postal_display_street) legalstreet, 
				cy.zip_code LegalPostalCode,
				cy.city legalcity,
				CASE WHEN cy.state IS NULL THEN 
					cyp.state
				ELSE 
					cy.state 
				END LegalState,  
				CASE WHEN cy.country_uid IS NULL THEN 
					DECODE (cyp.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein')
				else 
					DECODE (cy.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein') 
				END legalcountry, 
				gt.text P_O_Box__c,
				cyp.zip_code P_O_BoxPostalCode__c,
				cyp.city p_o_boxcity__c, 
				DECODE (ec.language_uid, 
					246, 'German', 
					1303, 'English', 
					7770, 'French', 
					7771, 'Italian', '?'
				) PreferedLanguage__c,
				ec.structure__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,  
				regexp_replace(
					coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), '^([^0-9]*) (\d+[a-zA-Z]{0,3})?$', '\1') 
					||  ' ' 
					|| nvl(shipping_addr.x_street_house_no, 
						ltrim(regexp_substr(
							coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), ' (\d+[a-zA-Z]{0,3})?$')
						)
				)  Shippingstreet, 
				cy_shipping.zip_code Shippingpostalcode,
				cy_shipping.city shippingcity, 
				cy_shipping.state ShippingState,
				DECODE (cy_shipping.country_uid, 
					1001148, 'Schweiz', 
					1001161, 'Deutschland', 
					1001179, 'Frankreich', 
					1001215, 'Italien', 
					1001234, 'Liechtenstein'
				) ShippingCountry,
				gt_sh_po.text ShippingP_O_Box__c,
				cy_sh_po.zip_code ShippingP_O_Box_PostalCode__c, 
				cy_sh_po.city ShippingP_O_BoxCity__c,
				DECODE (ec.x_advisory_status_uid, 
					117411, 'Fieldsales', 
					117413, 'KAM-Fieldsales'
				) SalesChannel__c,
				tkam.text KAMType__c, 
				CASE 
					WHEN kuba.legal_form_uid IS NOT NULL THEN
						REPLACE (tlf.text, 'K' || chr(50108) || 'Ba: ', '') 
					WHEN ec.y_legal_status_uid  <> 0 THEN 
						DECODE (ec.y_legal_status_uid, 
							875976469, 'AG', 
							875976471, 'Einzelunternehmen', 
							875976476, 'Genossenschaft', 
							875976472, 'GmbH', 
							875976474, 'Kollektivgesellschaft', 
							5714572491, 'Kommanditgesellschaft', 
							875976464, 'Stiftung', 
							875976459, 'Verein', 
							null
						)  
				END legalentity__c, 
				kuba.federal_company_id UID__c,
				tnc.text noga1__c,
				CASE WHEN kuba.founding_year = 0 THEN NULL
				ELSE kuba.founding_year
				END  CompanySince__c,
				CASE 
					WHEN kuba.turnover BETWEEN 2000001 AND 99999999 THEN  'A'
					WHEN kuba.turnover BETWEEN 1000001 AND 2000000 THEN  'B'
					WHEN kuba.turnover BETWEEN 200001 AND 1000000 THEN  'C'           
					WHEN kuba.turnover BETWEEN 5001 AND 200000 THEN  'D'             
				END TurnoverClass__c,
				tne.text NumberOfEmployees,
				EC.Allowed_comm_channel__c,
				EC.Communication_Channel__c
			FROM exported_companies ec
				LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
				LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr
				LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
				LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
				LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
				LEFT JOIN bsicrm.bsi_global_text gt ON gt.global_text_nr = AP.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cyp ON cyp.city_nr = AP.city_nr
				LEFT JOIN bsicrm.bsi_address shipping_addr ON shipping_addr.address_nr = ec.ship_address_nr
				LEFT JOIN bsicrm.bsi_address shipping_apo ON shipping_apo.address_nr = ec.ship_apo_nr
				LEFT JOIN bsicrm.bsi_city cy_sh_po ON cy_sh_po.city_nr = shipping_apo.city_nr
				LEFT JOIN bsicrm.bsi_global_text gt_sh_po ON gt_sh_po.global_text_nr = shipping_apo.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cy_shipping ON cy_shipping.city_nr = shipping_addr.city_nr
				LEFT JOIN bsicrm.bsi_uc_text tkam ON tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tlf ON tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tnc ON tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tne ON tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, Error Msg = ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert

!STACK 0
Error : 1013, Position : 0, Sql = -- SAMBA
WITH exported_companies AS (
				SELECT /*+ ordered use_hash(ejj ej company cc cc2 a sspa sspba) full(ejj) full(ej) full(company) full(cc) full(cc2) full(a) full(sspa) full(sspba) */
					company.x_complex_no,  -- accounts_samba
					TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
					company.language_uid,
					COMPANY.x_is_locked,
					ejj.join_nr,
					dbms_lob.substr(comp_samba.join_nos_samba, 4000, 1 ) join_nos_samba,
					dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx, 
					sadr.fone,
					sadr.handy,
					sadr.fax,
					sadr.email,
					sadr.www,
					kam.kamtyp,
					CASE 
						WHEN cc2.relation_uid = 300 THEN 'Group'
						WHEN cc2.relation_uid = 109876 THEN 'Company' 
						WHEN cc.relation_uid  = 300 THEN 'Company'
						WHEN cc.relation_uid  = 109876 THEN 'Branch'
						ELSE 'Single Company' 
					END structure__c, 
					sspa.address_nr address_nr,
					sspba.address_nr pobox_address_nr,
					ship_a.ship_anr  ship_address_nr,
					ship_ap.ship_apnr ship_apo_nr,
					company.y_legal_status_uid, 
					company.x_advisory_status_uid,  
					collection.join_nr coll_join_nr,
					kuba_data.kuba_join_nr,
					COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
					CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
						'Email'
					WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
						'Letter'
					WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
						'n.a.'
					END Communication_Channel__c
				FROM bsicrm.bsi_x_ext_join_join ejj
					JOIN bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
						AND ej.active = 1
					JOIN bsicrm.bsi_company company ON company.company_nr = ejj.join_nr 
						AND company.is_active = 1
					LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
					LEFT JOIN bsicrm.bsi_company_company cc ON cc.company_nr = ejj.join_nr
					LEFT JOIN (
						SELECT 
							cc2.group_company_nr, 
							MIN(cc2.relation_uid) relation_uid
						FROM bsicrm.bsi_company_company cc2 
						GROUP BY cc2.group_company_nr
					) cc2 ON cc2.group_company_nr = ejj.join_nr     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							MIN(ej2.kam_uid) kamtyp, 
							ejj2.join_nr innerjnr
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                     
						WHERE ej2.active = 1
						AND ej2.kam_uid != 0
						GROUP BY ejj2.join_nr
					) kam ON kam.innerjnr = ejj.join_nr  
					LEFT JOIN (
						SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
							adr.item_key0_nr,
							max (CASE WHEN adr.channel_uid = 113638 THEN adr.channel_value ELSE NULL END) fone,
							max (CASE WHEN adr.channel_uid = 113640 THEN adr.channel_value ELSE NULL END) handy,
							max (CASE WHEN adr.channel_uid = 113639 THEN adr.channel_value ELSE NULL END) fax,
							max (CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
							max (CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
						FROM bsicrm.bsi_address adr
							JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
							JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr and ej2.active = 1 AND ej2.interface_uid IN (108187,108205)
						WHERE adr.is_default_address = 1
							AND adr.item_type_id = 318594
						GROUP BY adr.item_key0_nr
					) sadr ON sadr.item_key0_nr = company.company_nr
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa ON  sspa.ext_join_nr = ejj.ext_join_nr
						AND sspa.join_type_uid = 318594
						AND sspa.type_uid = 2315 /* Hauptadresse */
						AND sspa.channel_uid = 113688
						AND sspa.join_nr = ejj.join_nr             
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba ON  sspba.ext_join_nr = ejj.ext_join_nr
						AND sspba.join_type_uid = 318594
						AND sspba.type_uid = 108240 /* Postfach */
						AND sspba.channel_uid = 113688
						AND sspba.join_nr = ejj.join_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_a au) full(ship_a) full(au) */
							ship_a.join_nr, 
							max (ship_a.address_nr )ship_aNr
						FROM bsicrm.bsi_x_address_mapping ship_a
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_a.address_nr
							AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_a.join_type_uid = 318594
							AND ship_a.channel_uid = 113688
							-- 2315:	Hauptadresse
							-- 108363:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedCode
							AND (ship_a.type_uid = 2315 OR  ship_a.type_uid = 108363)
						GROUP BY ship_a.join_nr
					) ship_a ON ship_a.join_nr = ejj.join_nr                     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_ap au) full(ship_ap) full(au) */
							ship_ap.join_nr, 
							max (ship_ap.address_nr ) ship_apnr
						FROM bsicrm.bsi_x_address_mapping ship_ap
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_ap.address_nr
								AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_ap.join_type_uid = 318594
							AND ship_ap.channel_uid = 113688
							-- 108240:	Postfach
							-- 108364:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedPoBoxCode
							AND (ship_ap.type_uid = 108240 OR  ship_ap.type_uid = 108364)
						GROUP BY ship_ap.join_nr
					) ship_ap ON  ship_ap.join_nr = ejj.join_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
							max (kd.join_nr) kuba_join_nr, 
							ejj2.join_nr             
						FROM bsicrm.bsi_x_ext_kuba_data kd
						JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr 
							AND ej2.ext_join_type_uid = kd.join_type_uid AND ej2.active = 1
						JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr 
							AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
						WHERE kd.status_uid = 4800511372 --aktiv  
						GROUP BY ejj2.join_nr
					) kuba_data ON kuba_data.join_nr = company.company_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
							DISTINCT ejjinner.join_nr 
						FROM bsicrm.bsi_x_collection coll 
							JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr 
								AND ejinner.active = 1
							JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
						WHERE coll.status_uid <> 137824
					) collection ON collection.join_nr = company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_samba
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108187
						GROUP BY ejj2.join_nr
					) comp_samba ON comp_samba.join_nr =  company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108205
						GROUP BY ejj2.join_nr
					) comp_nx ON comp_nx.join_nr =  company.company_nr  
				WHERE  ejj.is_master = 1
					AND    ejj.ext_join_type_uid = 108224
					AND    ej.interface_uid  = 108187 --samba      
			),
			dunning AS (
				SELECT /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
					distinct ejj.join_nr -- company.x_complex_no                    
				FROM bsicrm.bsi_x_ext_receipt xrcp
					JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr
						AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
					JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid
				WHERE xrcp.overdue_level_uid IN (137663,137664,137665) 
			)  
			SELECT /*+ ordered use_hash(kuba dnng legaladdr cy ap gt cyp shipping_addr shipping_apo cy_sh_po gt_sh_po cy_shipping tkam tlf tnc tne) 
                   full(kuba) full(dnng) full(legaladdr) full(cy) full(ap) full(gt) full(cyp) full(shipping_addr) full(shipping_apo) full(cy_sh_po) full(gt_sh_po) full(cy_shipping) full(tkam) full(tlf) full(tnc) full(tne) */
				distinct ec.x_complex_no uk_LCM_X_COMPLEX_NO__c,
				ec.NAME,
				ec.join_nos_samba LCM_Samba_MergeIDs__c,
				ec.join_nos_nx LCM_NX_MergeIDs__c,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%'  
				THEN  NULL
				ELSE ec.fone           
				END Phone,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%' 
				THEN  ec.fone
				ELSE ec.handy           
				END MobilePhone, 
				ec.fax fax, 
				CASE WHEN ec.email LIKE 'etv@%' THEN  NULL
				ELSE ec.email           
				END email__c,
				ec.www website,
				NVL(RTRIM (legaladdr.x_street_name||' '||legaladdr.x_street_house_no), legaladdr.postal_display_street) legalstreet, 
				cy.zip_code LegalPostalCode,
				cy.city legalcity,
				CASE WHEN cy.state IS NULL THEN 
					cyp.state
				ELSE 
					cy.state 
				END LegalState,  
				CASE WHEN cy.country_uid IS NULL THEN 
					DECODE (cyp.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein')
				else 
					DECODE (cy.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein') 
				END legalcountry, 
				gt.text P_O_Box__c,
				cyp.zip_code P_O_BoxPostalCode__c,
				cyp.city p_o_boxcity__c, 
				DECODE (ec.language_uid, 
					246, 'German', 
					1303, 'English', 
					7770, 'French', 
					7771, 'Italian', '?'
				) PreferedLanguage__c,
				ec.structure__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,  
				regexp_replace(
					coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), '^([^0-9]*) (\d+[a-zA-Z]{0,3})?$', '\1') 
					||  ' ' 
					|| nvl(shipping_addr.x_street_house_no, 
						ltrim(regexp_substr(
							coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), ' (\d+[a-zA-Z]{0,3})?$')
						)
				)  Shippingstreet, 
				cy_shipping.zip_code Shippingpostalcode,
				cy_shipping.city shippingcity, 
				cy_shipping.state ShippingState,
				DECODE (cy_shipping.country_uid, 
					1001148, 'Schweiz', 
					1001161, 'Deutschland', 
					1001179, 'Frankreich', 
					1001215, 'Italien', 
					1001234, 'Liechtenstein'
				) ShippingCountry,
				gt_sh_po.text ShippingP_O_Box__c,
				cy_sh_po.zip_code ShippingP_O_Box_PostalCode__c, 
				cy_sh_po.city ShippingP_O_BoxCity__c,
				DECODE (ec.x_advisory_status_uid, 
					117411, 'Fieldsales', 
					117413, 'KAM-Fieldsales'
				) SalesChannel__c,
				tkam.text KAMType__c, 
				CASE 
					WHEN kuba.legal_form_uid IS NOT NULL THEN
						REPLACE (tlf.text, 'K' || chr(50108) || 'Ba: ', '') 
					WHEN ec.y_legal_status_uid  <> 0 THEN 
						DECODE (ec.y_legal_status_uid, 
							875976469, 'AG', 
							875976471, 'Einzelunternehmen', 
							875976476, 'Genossenschaft', 
							875976472, 'GmbH', 
							875976474, 'Kollektivgesellschaft', 
							5714572491, 'Kommanditgesellschaft', 
							875976464, 'Stiftung', 
							875976459, 'Verein', 
							null
						)  
				END legalentity__c, 
				kuba.federal_company_id UID__c,
				tnc.text noga1__c,
				CASE WHEN kuba.founding_year = 0 THEN NULL
				ELSE kuba.founding_year
				END  CompanySince__c,
				CASE 
					WHEN kuba.turnover BETWEEN 2000001 AND 99999999 THEN  'A'
					WHEN kuba.turnover BETWEEN 1000001 AND 2000000 THEN  'B'
					WHEN kuba.turnover BETWEEN 200001 AND 1000000 THEN  'C'           
					WHEN kuba.turnover BETWEEN 5001 AND 200000 THEN  'D'             
				END TurnoverClass__c,
				tne.text NumberOfEmployees,
				EC.Allowed_comm_channel__c,
				EC.Communication_Channel__c
			FROM exported_companies ec
				LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
				LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr
				LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
				LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
				LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
				LEFT JOIN bsicrm.bsi_global_text gt ON gt.global_text_nr = AP.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cyp ON cyp.city_nr = AP.city_nr
				LEFT JOIN bsicrm.bsi_address shipping_addr ON shipping_addr.address_nr = ec.ship_address_nr
				LEFT JOIN bsicrm.bsi_address shipping_apo ON shipping_apo.address_nr = ec.ship_apo_nr
				LEFT JOIN bsicrm.bsi_city cy_sh_po ON cy_sh_po.city_nr = shipping_apo.city_nr
				LEFT JOIN bsicrm.bsi_global_text gt_sh_po ON gt_sh_po.global_text_nr = shipping_apo.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cy_shipping ON cy_shipping.city_nr = shipping_addr.city_nr
				LEFT JOIN bsicrm.bsi_uc_text tkam ON tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tlf ON tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tnc ON tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tne ON tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, OriginalSql = -- SAMBA
WITH exported_companies AS (
				SELECT /*+ ordered use_hash(ejj ej company cc cc2 a sspa sspba) full(ejj) full(ej) full(company) full(cc) full(cc2) full(a) full(sspa) full(sspba) */
					company.x_complex_no,  -- accounts_samba
					TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
					company.language_uid,
					COMPANY.x_is_locked,
					ejj.join_nr,
					dbms_lob.substr(comp_samba.join_nos_samba, 4000, 1 ) join_nos_samba,
					dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx, 
					sadr.fone,
					sadr.handy,
					sadr.fax,
					sadr.email,
					sadr.www,
					kam.kamtyp,
					CASE 
						WHEN cc2.relation_uid = 300 THEN 'Group'
						WHEN cc2.relation_uid = 109876 THEN 'Company' 
						WHEN cc.relation_uid  = 300 THEN 'Company'
						WHEN cc.relation_uid  = 109876 THEN 'Branch'
						ELSE 'Single Company' 
					END structure__c, 
					sspa.address_nr address_nr,
					sspba.address_nr pobox_address_nr,
					ship_a.ship_anr  ship_address_nr,
					ship_ap.ship_apnr ship_apo_nr,
					company.y_legal_status_uid, 
					company.x_advisory_status_uid,  
					collection.join_nr coll_join_nr,
					kuba_data.kuba_join_nr,
					COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
					CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
						'Email'
					WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
						'Letter'
					WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
						'n.a.'
					END Communication_Channel__c
				FROM bsicrm.bsi_x_ext_join_join ejj
					JOIN bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
						AND ej.active = 1
					JOIN bsicrm.bsi_company company ON company.company_nr = ejj.join_nr 
						AND company.is_active = 1
					LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
					LEFT JOIN bsicrm.bsi_company_company cc ON cc.company_nr = ejj.join_nr
					LEFT JOIN (
						SELECT 
							cc2.group_company_nr, 
							MIN(cc2.relation_uid) relation_uid
						FROM bsicrm.bsi_company_company cc2 
						GROUP BY cc2.group_company_nr
					) cc2 ON cc2.group_company_nr = ejj.join_nr     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							MIN(ej2.kam_uid) kamtyp, 
							ejj2.join_nr innerjnr
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                     
						WHERE ej2.active = 1
						AND ej2.kam_uid != 0
						GROUP BY ejj2.join_nr
					) kam ON kam.innerjnr = ejj.join_nr  
					LEFT JOIN (
						SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
							adr.item_key0_nr,
							max (CASE WHEN adr.channel_uid = 113638 THEN adr.channel_value ELSE NULL END) fone,
							max (CASE WHEN adr.channel_uid = 113640 THEN adr.channel_value ELSE NULL END) handy,
							max (CASE WHEN adr.channel_uid = 113639 THEN adr.channel_value ELSE NULL END) fax,
							max (CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
							max (CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
						FROM bsicrm.bsi_address adr
							JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
							JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr and ej2.active = 1 AND ej2.interface_uid IN (108187,108205)
						WHERE adr.is_default_address = 1
							AND adr.item_type_id = 318594
						GROUP BY adr.item_key0_nr
					) sadr ON sadr.item_key0_nr = company.company_nr
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa ON  sspa.ext_join_nr = ejj.ext_join_nr
						AND sspa.join_type_uid = 318594
						AND sspa.type_uid = 2315 /* Hauptadresse */
						AND sspa.channel_uid = 113688
						AND sspa.join_nr = ejj.join_nr             
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba ON  sspba.ext_join_nr = ejj.ext_join_nr
						AND sspba.join_type_uid = 318594
						AND sspba.type_uid = 108240 /* Postfach */
						AND sspba.channel_uid = 113688
						AND sspba.join_nr = ejj.join_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_a au) full(ship_a) full(au) */
							ship_a.join_nr, 
							max (ship_a.address_nr )ship_aNr
						FROM bsicrm.bsi_x_address_mapping ship_a
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_a.address_nr
							AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_a.join_type_uid = 318594
							AND ship_a.channel_uid = 113688
							-- 2315:	Hauptadresse
							-- 108363:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedCode
							AND (ship_a.type_uid = 2315 OR  ship_a.type_uid = 108363)
						GROUP BY ship_a.join_nr
					) ship_a ON ship_a.join_nr = ejj.join_nr                     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_ap au) full(ship_ap) full(au) */
							ship_ap.join_nr, 
							max (ship_ap.address_nr ) ship_apnr
						FROM bsicrm.bsi_x_address_mapping ship_ap
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_ap.address_nr
								AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_ap.join_type_uid = 318594
							AND ship_ap.channel_uid = 113688
							-- 108240:	Postfach
							-- 108364:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedPoBoxCode
							AND (ship_ap.type_uid = 108240 OR  ship_ap.type_uid = 108364)
						GROUP BY ship_ap.join_nr
					) ship_ap ON  ship_ap.join_nr = ejj.join_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
							max (kd.join_nr) kuba_join_nr, 
							ejj2.join_nr             
						FROM bsicrm.bsi_x_ext_kuba_data kd
						JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr 
							AND ej2.ext_join_type_uid = kd.join_type_uid AND ej2.active = 1
						JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr 
							AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
						WHERE kd.status_uid = 4800511372 --aktiv  
						GROUP BY ejj2.join_nr
					) kuba_data ON kuba_data.join_nr = company.company_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
							DISTINCT ejjinner.join_nr 
						FROM bsicrm.bsi_x_collection coll 
							JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr 
								AND ejinner.active = 1
							JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
						WHERE coll.status_uid <> 137824
					) collection ON collection.join_nr = company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_samba
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108187
						GROUP BY ejj2.join_nr
					) comp_samba ON comp_samba.join_nr =  company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108205
						GROUP BY ejj2.join_nr
					) comp_nx ON comp_nx.join_nr =  company.company_nr  
				WHERE  ejj.is_master = 1
					AND    ejj.ext_join_type_uid = 108224
					AND    ej.interface_uid  = 108187 --samba      
			),
			dunning AS (
				SELECT /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
					distinct ejj.join_nr -- company.x_complex_no                    
				FROM bsicrm.bsi_x_ext_receipt xrcp
					JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr
						AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
					JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid
				WHERE xrcp.overdue_level_uid IN (137663,137664,137665) 
			)  
			SELECT /*+ ordered use_hash(kuba dnng legaladdr cy ap gt cyp shipping_addr shipping_apo cy_sh_po gt_sh_po cy_shipping tkam tlf tnc tne) 
                   full(kuba) full(dnng) full(legaladdr) full(cy) full(ap) full(gt) full(cyp) full(shipping_addr) full(shipping_apo) full(cy_sh_po) full(gt_sh_po) full(cy_shipping) full(tkam) full(tlf) full(tnc) full(tne) */
				distinct ec.x_complex_no uk_LCM_X_COMPLEX_NO__c,
				ec.NAME,
				ec.join_nos_samba LCM_Samba_MergeIDs__c,
				ec.join_nos_nx LCM_NX_MergeIDs__c,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%'  
				THEN  NULL
				ELSE ec.fone           
				END Phone,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%' 
				THEN  ec.fone
				ELSE ec.handy           
				END MobilePhone, 
				ec.fax fax, 
				CASE WHEN ec.email LIKE 'etv@%' THEN  NULL
				ELSE ec.email           
				END email__c,
				ec.www website,
				NVL(RTRIM (legaladdr.x_street_name||' '||legaladdr.x_street_house_no), legaladdr.postal_display_street) legalstreet, 
				cy.zip_code LegalPostalCode,
				cy.city legalcity,
				CASE WHEN cy.state IS NULL THEN 
					cyp.state
				ELSE 
					cy.state 
				END LegalState,  
				CASE WHEN cy.country_uid IS NULL THEN 
					DECODE (cyp.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein')
				else 
					DECODE (cy.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein') 
				END legalcountry, 
				gt.text P_O_Box__c,
				cyp.zip_code P_O_BoxPostalCode__c,
				cyp.city p_o_boxcity__c, 
				DECODE (ec.language_uid, 
					246, 'German', 
					1303, 'English', 
					7770, 'French', 
					7771, 'Italian', '?'
				) PreferedLanguage__c,
				ec.structure__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,  
				regexp_replace(
					coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), '^([^0-9]*) (\d+[a-zA-Z]{0,3})?$', '\1') 
					||  ' ' 
					|| nvl(shipping_addr.x_street_house_no, 
						ltrim(regexp_substr(
							coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), ' (\d+[a-zA-Z]{0,3})?$')
						)
				)  Shippingstreet, 
				cy_shipping.zip_code Shippingpostalcode,
				cy_shipping.city shippingcity, 
				cy_shipping.state ShippingState,
				DECODE (cy_shipping.country_uid, 
					1001148, 'Schweiz', 
					1001161, 'Deutschland', 
					1001179, 'Frankreich', 
					1001215, 'Italien', 
					1001234, 'Liechtenstein'
				) ShippingCountry,
				gt_sh_po.text ShippingP_O_Box__c,
				cy_sh_po.zip_code ShippingP_O_Box_PostalCode__c, 
				cy_sh_po.city ShippingP_O_BoxCity__c,
				DECODE (ec.x_advisory_status_uid, 
					117411, 'Fieldsales', 
					117413, 'KAM-Fieldsales'
				) SalesChannel__c,
				tkam.text KAMType__c, 
				CASE 
					WHEN kuba.legal_form_uid IS NOT NULL THEN
						REPLACE (tlf.text, 'K' || chr(50108) || 'Ba: ', '') 
					WHEN ec.y_legal_status_uid  <> 0 THEN 
						DECODE (ec.y_legal_status_uid, 
							875976469, 'AG', 
							875976471, 'Einzelunternehmen', 
							875976476, 'Genossenschaft', 
							875976472, 'GmbH', 
							875976474, 'Kollektivgesellschaft', 
							5714572491, 'Kommanditgesellschaft', 
							875976464, 'Stiftung', 
							875976459, 'Verein', 
							null
						)  
				END legalentity__c, 
				kuba.federal_company_id UID__c,
				tnc.text noga1__c,
				CASE WHEN kuba.founding_year = 0 THEN NULL
				ELSE kuba.founding_year
				END  CompanySince__c,
				CASE 
					WHEN kuba.turnover BETWEEN 2000001 AND 99999999 THEN  'A'
					WHEN kuba.turnover BETWEEN 1000001 AND 2000000 THEN  'B'
					WHEN kuba.turnover BETWEEN 200001 AND 1000000 THEN  'C'           
					WHEN kuba.turnover BETWEEN 5001 AND 200000 THEN  'D'             
				END TurnoverClass__c,
				tne.text NumberOfEmployees,
				EC.Allowed_comm_channel__c,
				EC.Communication_Channel__c
			FROM exported_companies ec
				LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
				LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr
				LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
				LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
				LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
				LEFT JOIN bsicrm.bsi_global_text gt ON gt.global_text_nr = AP.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cyp ON cyp.city_nr = AP.city_nr
				LEFT JOIN bsicrm.bsi_address shipping_addr ON shipping_addr.address_nr = ec.ship_address_nr
				LEFT JOIN bsicrm.bsi_address shipping_apo ON shipping_apo.address_nr = ec.ship_apo_nr
				LEFT JOIN bsicrm.bsi_city cy_sh_po ON cy_sh_po.city_nr = shipping_apo.city_nr
				LEFT JOIN bsicrm.bsi_global_text gt_sh_po ON gt_sh_po.global_text_nr = shipping_apo.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cy_shipping ON cy_shipping.city_nr = shipping_addr.city_nr
				LEFT JOIN bsicrm.bsi_uc_text tkam ON tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tlf ON tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tnc ON tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tne ON tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, Error Msg = ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 2 0 2019-11-01 06:09:57.941
!MESSAGE Can't read execution warnings
!SUBENTRY 1 org.jkiss.dbeaver.model 2 0 2019-11-01 06:09:57.941
!MESSAGE SQL-Fehler [17008] [08003]: Getrennte Verbindung
!SUBENTRY 2 org.jkiss.dbeaver.model 2 0 2019-11-01 06:09:57.941
!MESSAGE Getrennte Verbindung
!STACK 0
java.sql.SQLRecoverableException: Getrennte Verbindung
	at oracle.jdbc.driver.OracleStatement.ensureOpen(OracleStatement.java:4114)
	at oracle.jdbc.driver.OracleStatement.getWarnings(OracleStatement.java:3113)
	at oracle.jdbc.driver.OracleStatementWrapper.getWarnings(OracleStatementWrapper.java:348)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.getWarnings(JDBCStatementImpl.java:582)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.getStatementWarnings(JDBCStatementImpl.java:612)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:524)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-01 06:09:57.952
!MESSAGE Can't close statement
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-01 06:09:57.952
!MESSAGE Getrennte Verbindung
!STACK 0
java.sql.SQLRecoverableException: Getrennte Verbindung
	at oracle.jdbc.driver.PhysicalConnection.needLine(PhysicalConnection.java:3305)
	at oracle.jdbc.driver.OracleStatement.closeOrCache(OracleStatement.java:1409)
	at oracle.jdbc.driver.OracleStatement.close(OracleStatement.java:1392)
	at oracle.jdbc.driver.OracleStatementWrapper.close(OracleStatementWrapper.java:119)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.close(JDBCStatementImpl.java:512)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.closeStatement(SQLQueryJob.java:797)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:530)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-01 06:10:02.113
!MESSAGE Operation failed. Retry count remains = 1
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-01 06:10:02.113
!MESSAGE SQL-Fehler [17002] [08006]: I/O-Fehler: Eine bestehende Verbindung wurde softwaregesteuert
durch den Hostcomputer abgebrochen
!SUBENTRY 2 org.jkiss.dbeaver.model 4 0 2019-11-01 06:10:02.113
!MESSAGE I/O-Fehler: Eine bestehende Verbindung wurde softwaregesteuert
durch den Hostcomputer abgebrochen
!STACK 0
java.sql.SQLRecoverableException: I/O-Fehler: Eine bestehende Verbindung wurde softwaregesteuert
durch den Hostcomputer abgebrochen
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:738)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)
Caused by: java.io.IOException: Eine bestehende Verbindung wurde softwaregesteuert
durch den Hostcomputer abgebrochen
	at java.base/sun.nio.ch.SocketDispatcher.read0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:43)
	at java.base/sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:276)
	at java.base/sun.nio.ch.IOUtil.read(IOUtil.java:245)
	at java.base/sun.nio.ch.IOUtil.read(IOUtil.java:223)
	at java.base/sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:355)
	at oracle.net.nt.TimeoutSocketChannel.read(TimeoutSocketChannel.java:178)
	at oracle.net.ns.NSProtocolNIO.doSocketRead(NSProtocolNIO.java:544)
	at oracle.net.ns.NIOPacket.readHeader(NIOPacket.java:234)
	at oracle.net.ns.NIOPacket.readPacketFromSocketChannel(NIOPacket.java:174)
	at oracle.net.ns.NIOPacket.readFromSocketChannel(NIOPacket.java:122)
	at oracle.net.ns.NIOPacket.readFromSocketChannel(NIOPacket.java:100)
	at oracle.net.ns.NIONSDataChannel.readDataFromSocketChannel(NIONSDataChannel.java:86)
	at oracle.jdbc.driver.T4CMAREngineNIO.prepareForUnmarshall(T4CMAREngineNIO.java:762)
	at oracle.jdbc.driver.T4CMAREngineNIO.unmarshalUB1(T4CMAREngineNIO.java:427)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:394)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	... 18 more
!SUBENTRY 3 org.jkiss.dbeaver.model 4 0 2019-11-01 06:10:02.114
!MESSAGE Eine bestehende Verbindung wurde softwaregesteuert
durch den Hostcomputer abgebrochen
!STACK 0
java.io.IOException: Eine bestehende Verbindung wurde softwaregesteuert
durch den Hostcomputer abgebrochen
	at java.base/sun.nio.ch.SocketDispatcher.read0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:43)
	at java.base/sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:276)
	at java.base/sun.nio.ch.IOUtil.read(IOUtil.java:245)
	at java.base/sun.nio.ch.IOUtil.read(IOUtil.java:223)
	at java.base/sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:355)
	at oracle.net.nt.TimeoutSocketChannel.read(TimeoutSocketChannel.java:178)
	at oracle.net.ns.NSProtocolNIO.doSocketRead(NSProtocolNIO.java:544)
	at oracle.net.ns.NIOPacket.readHeader(NIOPacket.java:234)
	at oracle.net.ns.NIOPacket.readPacketFromSocketChannel(NIOPacket.java:174)
	at oracle.net.ns.NIOPacket.readFromSocketChannel(NIOPacket.java:122)
	at oracle.net.ns.NIOPacket.readFromSocketChannel(NIOPacket.java:100)
	at oracle.net.ns.NIONSDataChannel.readDataFromSocketChannel(NIONSDataChannel.java:86)
	at oracle.jdbc.driver.T4CMAREngineNIO.prepareForUnmarshall(T4CMAREngineNIO.java:762)
	at oracle.jdbc.driver.T4CMAREngineNIO.unmarshalUB1(T4CMAREngineNIO.java:427)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:394)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-01 06:11:44.374
!MESSAGE SQL-Fehler [1013] [72000]: ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-01 06:11:44.374
!MESSAGE Error : 1013, Position : 0, Sql = 	-----------------------------------
	--	Procedure lcm_accounts_samba --
	-----------------------------------
	--
			WITH exported_companies AS (
				SELECT /*+ ordered use_hash(ejj ej company cc cc2 a sspa sspba) full(ejj) full(ej) full(company) full(cc) full(cc2) full(a) full(sspa) full(sspba) */
					company.x_complex_no,  -- lcm_accounts_samba
					TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
					company.language_uid,
					COMPANY.x_is_locked,
					ejj.join_nr,
					dbms_lob.substr(comp_samba.join_nos_samba, 4000, 1 ) join_nos_samba,
					dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx, 
					sadr.fone,
					sadr.handy,
					sadr.fax,
					sadr.email,
					sadr.www,
					kam.kamtyp,
					CASE 
						WHEN cc2.relation_uid = 300 THEN 'Group'
						WHEN cc2.relation_uid = 109876 THEN 'Company' 
						WHEN cc.relation_uid  = 300 THEN 'Company'
						WHEN cc.relation_uid  = 109876 THEN 'Branch'
						ELSE 'Single Company' 
					END structure__c, 
					sspa.address_nr address_nr,
					sspba.address_nr pobox_address_nr,
					ship_a.ship_anr  ship_address_nr,
					ship_ap.ship_apnr ship_apo_nr,
					company.y_legal_status_uid, 
					company.x_advisory_status_uid,  
					collection.join_nr coll_join_nr,
					kuba_data.kuba_join_nr,
					COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
					CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
						'Email'
					WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
						'Letter'
					WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
						'n.a.'
					END Communication_Channel__c
				FROM bsicrm.bsi_x_ext_join_join ejj
					JOIN bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
						AND ej.active = 1
					JOIN bsicrm.bsi_company company ON company.company_nr = ejj.join_nr 
						AND company.is_active = 1
					LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
					LEFT JOIN bsicrm.bsi_company_company cc ON cc.company_nr = ejj.join_nr
					LEFT JOIN (
						SELECT 
							cc2.group_company_nr, 
							MIN(cc2.relation_uid) relation_uid
						FROM bsicrm.bsi_company_company cc2 
						GROUP BY cc2.group_company_nr
					) cc2 ON cc2.group_company_nr = ejj.join_nr     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							MIN(ej2.kam_uid) kamtyp, 
							ejj2.join_nr innerjnr
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                     
						WHERE ej2.active = 1
						AND ej2.kam_uid != 0
						GROUP BY ejj2.join_nr
					) kam ON kam.innerjnr = ejj.join_nr  
					LEFT JOIN (
						SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
							adr.item_key0_nr,
							max (CASE WHEN adr.channel_uid = 113638 THEN adr.channel_value ELSE NULL END) fone,
							max (CASE WHEN adr.channel_uid = 113640 THEN adr.channel_value ELSE NULL END) handy,
							max (CASE WHEN adr.channel_uid = 113639 THEN adr.channel_value ELSE NULL END) fax,
							max (CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
							max (CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
						FROM bsicrm.bsi_address adr
							JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
							JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr and ej2.active = 1 AND ej2.interface_uid IN (108187,108205)
						WHERE adr.is_default_address = 1
							AND adr.item_type_id = 318594
						GROUP BY adr.item_key0_nr
					) sadr ON sadr.item_key0_nr = company.company_nr
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa ON  sspa.ext_join_nr = ejj.ext_join_nr
						AND sspa.join_type_uid = 318594
						AND sspa.type_uid = 2315 /* Hauptadresse */
						AND sspa.channel_uid = 113688
						AND sspa.join_nr = ejj.join_nr             
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba ON  sspba.ext_join_nr = ejj.ext_join_nr
						AND sspba.join_type_uid = 318594
						AND sspba.type_uid = 108240 /* Postfach */
						AND sspba.channel_uid = 113688
						AND sspba.join_nr = ejj.join_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_a au) full(ship_a) full(au) */
							ship_a.join_nr, 
							max (ship_a.address_nr )ship_aNr
						FROM bsicrm.bsi_x_address_mapping ship_a
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_a.address_nr
							AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_a.join_type_uid = 318594
							AND ship_a.channel_uid = 113688
							-- 2315:	Hauptadresse
							-- 108363:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedCode
							AND (ship_a.type_uid = 2315 OR  ship_a.type_uid = 108363)
						GROUP BY ship_a.join_nr
					) ship_a ON ship_a.join_nr = ejj.join_nr                     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_ap au) full(ship_ap) full(au) */
							ship_ap.join_nr, 
							max (ship_ap.address_nr ) ship_apnr
						FROM bsicrm.bsi_x_address_mapping ship_ap
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_ap.address_nr
								AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_ap.join_type_uid = 318594
							AND ship_ap.channel_uid = 113688
							-- 108240:	Postfach
							-- 108364:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedPoBoxCode
							AND (ship_ap.type_uid = 108240 OR  ship_ap.type_uid = 108364)
						GROUP BY ship_ap.join_nr
					) ship_ap ON  ship_ap.join_nr = ejj.join_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
							max (kd.join_nr) kuba_join_nr, 
							ejj2.join_nr             
						FROM bsicrm.bsi_x_ext_kuba_data kd
						JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr 
							AND ej2.ext_join_type_uid = kd.join_type_uid AND ej2.active = 1
						JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr 
							AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
						WHERE kd.status_uid = 4800511372 --aktiv  
						GROUP BY ejj2.join_nr
					) kuba_data ON kuba_data.join_nr = company.company_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
							DISTINCT ejjinner.join_nr 
						FROM bsicrm.bsi_x_collection coll 
							JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr 
								AND ejinner.active = 1
							JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
						WHERE coll.status_uid <> 137824
					) collection ON collection.join_nr = company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_samba
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108187
						GROUP BY ejj2.join_nr
					) comp_samba ON comp_samba.join_nr =  company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108205
						GROUP BY ejj2.join_nr
					) comp_nx ON comp_nx.join_nr =  company.company_nr  
				WHERE  ejj.is_master = 1
					AND    ejj.ext_join_type_uid = 108224
					AND    ej.interface_uid  = 108187 --samba      
			),
			dunning AS (
				SELECT /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
					distinct ejj.join_nr -- company.x_complex_no                    
				FROM bsicrm.bsi_x_ext_receipt xrcp
					JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr
						AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
					JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid
				WHERE xrcp.overdue_level_uid IN (137663,137664,137665) 
			)  
			SELECT /*+ ordered use_hash(kuba dnng legaladdr cy ap gt cyp shipping_addr shipping_apo cy_sh_po gt_sh_po cy_shipping tkam tlf tnc tne) 
                   full(kuba) full(dnng) full(legaladdr) full(cy) full(ap) full(gt) full(cyp) full(shipping_addr) full(shipping_apo) full(cy_sh_po) full(gt_sh_po) full(cy_shipping) full(tkam) full(tlf) full(tnc) full(tne) */
				distinct ec.x_complex_no uk_LCM_X_COMPLEX_NO__c,
				ec.NAME,
				ec.join_nos_samba LCM_Samba_MergeIDs__c,
				ec.join_nos_nx LCM_NX_MergeIDs__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,
				CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
				    ELSE NULL           
				END clientrating__prior,

				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%'  
				THEN  NULL
				ELSE ec.fone           
				END Phone,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%' 
				THEN  ec.fone
				ELSE ec.handy           
				END MobilePhone, 
				ec.fax fax, 
				CASE WHEN ec.email LIKE 'etv@%' THEN  NULL
				ELSE ec.email           
				END email__c,
				ec.www website,
				NVL(RTRIM (legaladdr.x_street_name||' '||legaladdr.x_street_house_no), legaladdr.postal_display_street) legalstreet, 
				cy.zip_code LegalPostalCode,
				cy.city legalcity,
				CASE WHEN cy.state IS NULL THEN 
					cyp.state
				ELSE 
					cy.state 
				END LegalState,  
				CASE WHEN cy.country_uid IS NULL THEN 
					DECODE (cyp.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein')
				else 
					DECODE (cy.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein') 
				END legalcountry, 
				gt.text P_O_Box__c,
				cyp.zip_code P_O_BoxPostalCode__c,
				cyp.city p_o_boxcity__c, 
				DECODE (ec.language_uid, 
					246, 'German', 
					1303, 'English', 
					7770, 'French', 
					7771, 'Italian', '?'
				) PreferedLanguage__c,
				ec.structure__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,
				CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
				    ELSE NULL           
				END clientrating__prior,
				regexp_replace(
					coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), '^([^0-9]*) (\d+[a-zA-Z]{0,3})?$', '\1') 
					||  ' ' 
					|| nvl(shipping_addr.x_street_house_no, 
						ltrim(regexp_substr(
							coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), ' (\d+[a-zA-Z]{0,3})?$')
						)
				)  Shippingstreet, 
				cy_shipping.zip_code Shippingpostalcode,
				cy_shipping.city shippingcity, 
				cy_shipping.state ShippingState,
				DECODE (cy_shipping.country_uid, 
					1001148, 'Schweiz', 
					1001161, 'Deutschland', 
					1001179, 'Frankreich', 
					1001215, 'Italien', 
					1001234, 'Liechtenstein'
				) ShippingCountry,
				gt_sh_po.text ShippingP_O_Box__c,
				cy_sh_po.zip_code ShippingP_O_Box_PostalCode__c, 
				cy_sh_po.city ShippingP_O_BoxCity__c,
				DECODE (ec.x_advisory_status_uid, 
					117411, 'Fieldsales', 
					117413, 'KAM-Fieldsales'
				) SalesChannel__c,
				tkam.text KAMType__c, 
				CASE 
					WHEN kuba.legal_form_uid IS NOT NULL THEN
						REPLACE (tlf.text, 'K' || chr(50108) || 'Ba: ', '') 
					WHEN ec.y_legal_status_uid  <> 0 THEN 
						DECODE (ec.y_legal_status_uid, 
							875976469, 'AG', 
							875976471, 'Einzelunternehmen', 
							875976476, 'Genossenschaft', 
							875976472, 'GmbH', 
							875976474, 'Kollektivgesellschaft', 
							5714572491, 'Kommanditgesellschaft', 
							875976464, 'Stiftung', 
							875976459, 'Verein', 
							null
						)  
				END legalentity__c, 
				kuba.federal_company_id UID__c,
				tnc.text noga1__c,
				CASE WHEN kuba.founding_year = 0 THEN NULL
				ELSE kuba.founding_year
				END  CompanySince__c,
				CASE 
					WHEN kuba.turnover BETWEEN 2000001 AND 99999999 THEN  'A'
					WHEN kuba.turnover BETWEEN 1000001 AND 2000000 THEN  'B'
					WHEN kuba.turnover BETWEEN 200001 AND 1000000 THEN  'C'           
					WHEN kuba.turnover BETWEEN 5001 AND 200000 THEN  'D'             
				END TurnoverClass__c,
				tne.text NumberOfEmployees,
				EC.Allowed_comm_channel__c,
				EC.Communication_Channel__c
			FROM exported_companies ec
				LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
				LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr
				LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
				LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
				LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
				LEFT JOIN bsicrm.bsi_global_text gt ON gt.global_text_nr = AP.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cyp ON cyp.city_nr = AP.city_nr
				LEFT JOIN bsicrm.bsi_address shipping_addr ON shipping_addr.address_nr = ec.ship_address_nr
				LEFT JOIN bsicrm.bsi_address shipping_apo ON shipping_apo.address_nr = ec.ship_apo_nr
				LEFT JOIN bsicrm.bsi_city cy_sh_po ON cy_sh_po.city_nr = shipping_apo.city_nr
				LEFT JOIN bsicrm.bsi_global_text gt_sh_po ON gt_sh_po.global_text_nr = shipping_apo.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cy_shipping ON cy_shipping.city_nr = shipping_addr.city_nr
				LEFT JOIN bsicrm.bsi_uc_text tkam ON tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tlf ON tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tnc ON tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tne ON tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, OriginalSql = 	-----------------------------------
	--	Procedure lcm_accounts_samba --
	-----------------------------------
	--
			WITH exported_companies AS (
				SELECT /*+ ordered use_hash(ejj ej company cc cc2 a sspa sspba) full(ejj) full(ej) full(company) full(cc) full(cc2) full(a) full(sspa) full(sspba) */
					company.x_complex_no,  -- lcm_accounts_samba
					TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
					company.language_uid,
					COMPANY.x_is_locked,
					ejj.join_nr,
					dbms_lob.substr(comp_samba.join_nos_samba, 4000, 1 ) join_nos_samba,
					dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx, 
					sadr.fone,
					sadr.handy,
					sadr.fax,
					sadr.email,
					sadr.www,
					kam.kamtyp,
					CASE 
						WHEN cc2.relation_uid = 300 THEN 'Group'
						WHEN cc2.relation_uid = 109876 THEN 'Company' 
						WHEN cc.relation_uid  = 300 THEN 'Company'
						WHEN cc.relation_uid  = 109876 THEN 'Branch'
						ELSE 'Single Company' 
					END structure__c, 
					sspa.address_nr address_nr,
					sspba.address_nr pobox_address_nr,
					ship_a.ship_anr  ship_address_nr,
					ship_ap.ship_apnr ship_apo_nr,
					company.y_legal_status_uid, 
					company.x_advisory_status_uid,  
					collection.join_nr coll_join_nr,
					kuba_data.kuba_join_nr,
					COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
					CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
						'Email'
					WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
						'Letter'
					WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
						'n.a.'
					END Communication_Channel__c
				FROM bsicrm.bsi_x_ext_join_join ejj
					JOIN bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
						AND ej.active = 1
					JOIN bsicrm.bsi_company company ON company.company_nr = ejj.join_nr 
						AND company.is_active = 1
					LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
					LEFT JOIN bsicrm.bsi_company_company cc ON cc.company_nr = ejj.join_nr
					LEFT JOIN (
						SELECT 
							cc2.group_company_nr, 
							MIN(cc2.relation_uid) relation_uid
						FROM bsicrm.bsi_company_company cc2 
						GROUP BY cc2.group_company_nr
					) cc2 ON cc2.group_company_nr = ejj.join_nr     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							MIN(ej2.kam_uid) kamtyp, 
							ejj2.join_nr innerjnr
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                     
						WHERE ej2.active = 1
						AND ej2.kam_uid != 0
						GROUP BY ejj2.join_nr
					) kam ON kam.innerjnr = ejj.join_nr  
					LEFT JOIN (
						SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
							adr.item_key0_nr,
							max (CASE WHEN adr.channel_uid = 113638 THEN adr.channel_value ELSE NULL END) fone,
							max (CASE WHEN adr.channel_uid = 113640 THEN adr.channel_value ELSE NULL END) handy,
							max (CASE WHEN adr.channel_uid = 113639 THEN adr.channel_value ELSE NULL END) fax,
							max (CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
							max (CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
						FROM bsicrm.bsi_address adr
							JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
							JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr and ej2.active = 1 AND ej2.interface_uid IN (108187,108205)
						WHERE adr.is_default_address = 1
							AND adr.item_type_id = 318594
						GROUP BY adr.item_key0_nr
					) sadr ON sadr.item_key0_nr = company.company_nr
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa ON  sspa.ext_join_nr = ejj.ext_join_nr
						AND sspa.join_type_uid = 318594
						AND sspa.type_uid = 2315 /* Hauptadresse */
						AND sspa.channel_uid = 113688
						AND sspa.join_nr = ejj.join_nr             
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba ON  sspba.ext_join_nr = ejj.ext_join_nr
						AND sspba.join_type_uid = 318594
						AND sspba.type_uid = 108240 /* Postfach */
						AND sspba.channel_uid = 113688
						AND sspba.join_nr = ejj.join_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_a au) full(ship_a) full(au) */
							ship_a.join_nr, 
							max (ship_a.address_nr )ship_aNr
						FROM bsicrm.bsi_x_address_mapping ship_a
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_a.address_nr
							AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_a.join_type_uid = 318594
							AND ship_a.channel_uid = 113688
							-- 2315:	Hauptadresse
							-- 108363:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedCode
							AND (ship_a.type_uid = 2315 OR  ship_a.type_uid = 108363)
						GROUP BY ship_a.join_nr
					) ship_a ON ship_a.join_nr = ejj.join_nr                     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_ap au) full(ship_ap) full(au) */
							ship_ap.join_nr, 
							max (ship_ap.address_nr ) ship_apnr
						FROM bsicrm.bsi_x_address_mapping ship_ap
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_ap.address_nr
								AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_ap.join_type_uid = 318594
							AND ship_ap.channel_uid = 113688
							-- 108240:	Postfach
							-- 108364:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedPoBoxCode
							AND (ship_ap.type_uid = 108240 OR  ship_ap.type_uid = 108364)
						GROUP BY ship_ap.join_nr
					) ship_ap ON  ship_ap.join_nr = ejj.join_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
							max (kd.join_nr) kuba_join_nr, 
							ejj2.join_nr             
						FROM bsicrm.bsi_x_ext_kuba_data kd
						JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr 
							AND ej2.ext_join_type_uid = kd.join_type_uid AND ej2.active = 1
						JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr 
							AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
						WHERE kd.status_uid = 4800511372 --aktiv  
						GROUP BY ejj2.join_nr
					) kuba_data ON kuba_data.join_nr = company.company_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
							DISTINCT ejjinner.join_nr 
						FROM bsicrm.bsi_x_collection coll 
							JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr 
								AND ejinner.active = 1
							JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
						WHERE coll.status_uid <> 137824
					) collection ON collection.join_nr = company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_samba
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108187
						GROUP BY ejj2.join_nr
					) comp_samba ON comp_samba.join_nr =  company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108205
						GROUP BY ejj2.join_nr
					) comp_nx ON comp_nx.join_nr =  company.company_nr  
				WHERE  ejj.is_master = 1
					AND    ejj.ext_join_type_uid = 108224
					AND    ej.interface_uid  = 108187 --samba      
			),
			dunning AS (
				SELECT /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
					distinct ejj.join_nr -- company.x_complex_no                    
				FROM bsicrm.bsi_x_ext_receipt xrcp
					JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr
						AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
					JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid
				WHERE xrcp.overdue_level_uid IN (137663,137664,137665) 
			)  
			SELECT /*+ ordered use_hash(kuba dnng legaladdr cy ap gt cyp shipping_addr shipping_apo cy_sh_po gt_sh_po cy_shipping tkam tlf tnc tne) 
                   full(kuba) full(dnng) full(legaladdr) full(cy) full(ap) full(gt) full(cyp) full(shipping_addr) full(shipping_apo) full(cy_sh_po) full(gt_sh_po) full(cy_shipping) full(tkam) full(tlf) full(tnc) full(tne) */
				distinct ec.x_complex_no uk_LCM_X_COMPLEX_NO__c,
				ec.NAME,
				ec.join_nos_samba LCM_Samba_MergeIDs__c,
				ec.join_nos_nx LCM_NX_MergeIDs__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,
				CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
				    ELSE NULL           
				END clientrating__prior,

				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%'  
				THEN  NULL
				ELSE ec.fone           
				END Phone,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%' 
				THEN  ec.fone
				ELSE ec.handy           
				END MobilePhone, 
				ec.fax fax, 
				CASE WHEN ec.email LIKE 'etv@%' THEN  NULL
				ELSE ec.email           
				END email__c,
				ec.www website,
				NVL(RTRIM (legaladdr.x_street_name||' '||legaladdr.x_street_house_no), legaladdr.postal_display_street) legalstreet, 
				cy.zip_code LegalPostalCode,
				cy.city legalcity,
				CASE WHEN cy.state IS NULL THEN 
					cyp.state
				ELSE 
					cy.state 
				END LegalState,  
				CASE WHEN cy.country_uid IS NULL THEN 
					DECODE (cyp.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein')
				else 
					DECODE (cy.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein') 
				END legalcountry, 
				gt.text P_O_Box__c,
				cyp.zip_code P_O_BoxPostalCode__c,
				cyp.city p_o_boxcity__c, 
				DECODE (ec.language_uid, 
					246, 'German', 
					1303, 'English', 
					7770, 'French', 
					7771, 'Italian', '?'
				) PreferedLanguage__c,
				ec.structure__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,
				CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
				    ELSE NULL           
				END clientrating__prior,
				regexp_replace(
					coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), '^([^0-9]*) (\d+[a-zA-Z]{0,3})?$', '\1') 
					||  ' ' 
					|| nvl(shipping_addr.x_street_house_no, 
						ltrim(regexp_substr(
							coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), ' (\d+[a-zA-Z]{0,3})?$')
						)
				)  Shippingstreet, 
				cy_shipping.zip_code Shippingpostalcode,
				cy_shipping.city shippingcity, 
				cy_shipping.state ShippingState,
				DECODE (cy_shipping.country_uid, 
					1001148, 'Schweiz', 
					1001161, 'Deutschland', 
					1001179, 'Frankreich', 
					1001215, 'Italien', 
					1001234, 'Liechtenstein'
				) ShippingCountry,
				gt_sh_po.text ShippingP_O_Box__c,
				cy_sh_po.zip_code ShippingP_O_Box_PostalCode__c, 
				cy_sh_po.city ShippingP_O_BoxCity__c,
				DECODE (ec.x_advisory_status_uid, 
					117411, 'Fieldsales', 
					117413, 'KAM-Fieldsales'
				) SalesChannel__c,
				tkam.text KAMType__c, 
				CASE 
					WHEN kuba.legal_form_uid IS NOT NULL THEN
						REPLACE (tlf.text, 'K' || chr(50108) || 'Ba: ', '') 
					WHEN ec.y_legal_status_uid  <> 0 THEN 
						DECODE (ec.y_legal_status_uid, 
							875976469, 'AG', 
							875976471, 'Einzelunternehmen', 
							875976476, 'Genossenschaft', 
							875976472, 'GmbH', 
							875976474, 'Kollektivgesellschaft', 
							5714572491, 'Kommanditgesellschaft', 
							875976464, 'Stiftung', 
							875976459, 'Verein', 
							null
						)  
				END legalentity__c, 
				kuba.federal_company_id UID__c,
				tnc.text noga1__c,
				CASE WHEN kuba.founding_year = 0 THEN NULL
				ELSE kuba.founding_year
				END  CompanySince__c,
				CASE 
					WHEN kuba.turnover BETWEEN 2000001 AND 99999999 THEN  'A'
					WHEN kuba.turnover BETWEEN 1000001 AND 2000000 THEN  'B'
					WHEN kuba.turnover BETWEEN 200001 AND 1000000 THEN  'C'           
					WHEN kuba.turnover BETWEEN 5001 AND 200000 THEN  'D'             
				END TurnoverClass__c,
				tne.text NumberOfEmployees,
				EC.Allowed_comm_channel__c,
				EC.Communication_Channel__c
			FROM exported_companies ec
				LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
				LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr
				LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
				LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
				LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
				LEFT JOIN bsicrm.bsi_global_text gt ON gt.global_text_nr = AP.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cyp ON cyp.city_nr = AP.city_nr
				LEFT JOIN bsicrm.bsi_address shipping_addr ON shipping_addr.address_nr = ec.ship_address_nr
				LEFT JOIN bsicrm.bsi_address shipping_apo ON shipping_apo.address_nr = ec.ship_apo_nr
				LEFT JOIN bsicrm.bsi_city cy_sh_po ON cy_sh_po.city_nr = shipping_apo.city_nr
				LEFT JOIN bsicrm.bsi_global_text gt_sh_po ON gt_sh_po.global_text_nr = shipping_apo.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cy_shipping ON cy_shipping.city_nr = shipping_addr.city_nr
				LEFT JOIN bsicrm.bsi_uc_text tkam ON tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tlf ON tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tnc ON tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tne ON tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, Error Msg = ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert

!STACK 0
Error : 1013, Position : 0, Sql = 	-----------------------------------
	--	Procedure lcm_accounts_samba --
	-----------------------------------
	--
			WITH exported_companies AS (
				SELECT /*+ ordered use_hash(ejj ej company cc cc2 a sspa sspba) full(ejj) full(ej) full(company) full(cc) full(cc2) full(a) full(sspa) full(sspba) */
					company.x_complex_no,  -- lcm_accounts_samba
					TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
					company.language_uid,
					COMPANY.x_is_locked,
					ejj.join_nr,
					dbms_lob.substr(comp_samba.join_nos_samba, 4000, 1 ) join_nos_samba,
					dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx, 
					sadr.fone,
					sadr.handy,
					sadr.fax,
					sadr.email,
					sadr.www,
					kam.kamtyp,
					CASE 
						WHEN cc2.relation_uid = 300 THEN 'Group'
						WHEN cc2.relation_uid = 109876 THEN 'Company' 
						WHEN cc.relation_uid  = 300 THEN 'Company'
						WHEN cc.relation_uid  = 109876 THEN 'Branch'
						ELSE 'Single Company' 
					END structure__c, 
					sspa.address_nr address_nr,
					sspba.address_nr pobox_address_nr,
					ship_a.ship_anr  ship_address_nr,
					ship_ap.ship_apnr ship_apo_nr,
					company.y_legal_status_uid, 
					company.x_advisory_status_uid,  
					collection.join_nr coll_join_nr,
					kuba_data.kuba_join_nr,
					COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
					CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
						'Email'
					WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
						'Letter'
					WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
						'n.a.'
					END Communication_Channel__c
				FROM bsicrm.bsi_x_ext_join_join ejj
					JOIN bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
						AND ej.active = 1
					JOIN bsicrm.bsi_company company ON company.company_nr = ejj.join_nr 
						AND company.is_active = 1
					LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
					LEFT JOIN bsicrm.bsi_company_company cc ON cc.company_nr = ejj.join_nr
					LEFT JOIN (
						SELECT 
							cc2.group_company_nr, 
							MIN(cc2.relation_uid) relation_uid
						FROM bsicrm.bsi_company_company cc2 
						GROUP BY cc2.group_company_nr
					) cc2 ON cc2.group_company_nr = ejj.join_nr     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							MIN(ej2.kam_uid) kamtyp, 
							ejj2.join_nr innerjnr
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                     
						WHERE ej2.active = 1
						AND ej2.kam_uid != 0
						GROUP BY ejj2.join_nr
					) kam ON kam.innerjnr = ejj.join_nr  
					LEFT JOIN (
						SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
							adr.item_key0_nr,
							max (CASE WHEN adr.channel_uid = 113638 THEN adr.channel_value ELSE NULL END) fone,
							max (CASE WHEN adr.channel_uid = 113640 THEN adr.channel_value ELSE NULL END) handy,
							max (CASE WHEN adr.channel_uid = 113639 THEN adr.channel_value ELSE NULL END) fax,
							max (CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
							max (CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
						FROM bsicrm.bsi_address adr
							JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
							JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr and ej2.active = 1 AND ej2.interface_uid IN (108187,108205)
						WHERE adr.is_default_address = 1
							AND adr.item_type_id = 318594
						GROUP BY adr.item_key0_nr
					) sadr ON sadr.item_key0_nr = company.company_nr
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa ON  sspa.ext_join_nr = ejj.ext_join_nr
						AND sspa.join_type_uid = 318594
						AND sspa.type_uid = 2315 /* Hauptadresse */
						AND sspa.channel_uid = 113688
						AND sspa.join_nr = ejj.join_nr             
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba ON  sspba.ext_join_nr = ejj.ext_join_nr
						AND sspba.join_type_uid = 318594
						AND sspba.type_uid = 108240 /* Postfach */
						AND sspba.channel_uid = 113688
						AND sspba.join_nr = ejj.join_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_a au) full(ship_a) full(au) */
							ship_a.join_nr, 
							max (ship_a.address_nr )ship_aNr
						FROM bsicrm.bsi_x_address_mapping ship_a
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_a.address_nr
							AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_a.join_type_uid = 318594
							AND ship_a.channel_uid = 113688
							-- 2315:	Hauptadresse
							-- 108363:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedCode
							AND (ship_a.type_uid = 2315 OR  ship_a.type_uid = 108363)
						GROUP BY ship_a.join_nr
					) ship_a ON ship_a.join_nr = ejj.join_nr                     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_ap au) full(ship_ap) full(au) */
							ship_ap.join_nr, 
							max (ship_ap.address_nr ) ship_apnr
						FROM bsicrm.bsi_x_address_mapping ship_ap
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_ap.address_nr
								AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_ap.join_type_uid = 318594
							AND ship_ap.channel_uid = 113688
							-- 108240:	Postfach
							-- 108364:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedPoBoxCode
							AND (ship_ap.type_uid = 108240 OR  ship_ap.type_uid = 108364)
						GROUP BY ship_ap.join_nr
					) ship_ap ON  ship_ap.join_nr = ejj.join_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
							max (kd.join_nr) kuba_join_nr, 
							ejj2.join_nr             
						FROM bsicrm.bsi_x_ext_kuba_data kd
						JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr 
							AND ej2.ext_join_type_uid = kd.join_type_uid AND ej2.active = 1
						JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr 
							AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
						WHERE kd.status_uid = 4800511372 --aktiv  
						GROUP BY ejj2.join_nr
					) kuba_data ON kuba_data.join_nr = company.company_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
							DISTINCT ejjinner.join_nr 
						FROM bsicrm.bsi_x_collection coll 
							JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr 
								AND ejinner.active = 1
							JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
						WHERE coll.status_uid <> 137824
					) collection ON collection.join_nr = company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_samba
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108187
						GROUP BY ejj2.join_nr
					) comp_samba ON comp_samba.join_nr =  company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108205
						GROUP BY ejj2.join_nr
					) comp_nx ON comp_nx.join_nr =  company.company_nr  
				WHERE  ejj.is_master = 1
					AND    ejj.ext_join_type_uid = 108224
					AND    ej.interface_uid  = 108187 --samba      
			),
			dunning AS (
				SELECT /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
					distinct ejj.join_nr -- company.x_complex_no                    
				FROM bsicrm.bsi_x_ext_receipt xrcp
					JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr
						AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
					JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid
				WHERE xrcp.overdue_level_uid IN (137663,137664,137665) 
			)  
			SELECT /*+ ordered use_hash(kuba dnng legaladdr cy ap gt cyp shipping_addr shipping_apo cy_sh_po gt_sh_po cy_shipping tkam tlf tnc tne) 
                   full(kuba) full(dnng) full(legaladdr) full(cy) full(ap) full(gt) full(cyp) full(shipping_addr) full(shipping_apo) full(cy_sh_po) full(gt_sh_po) full(cy_shipping) full(tkam) full(tlf) full(tnc) full(tne) */
				distinct ec.x_complex_no uk_LCM_X_COMPLEX_NO__c,
				ec.NAME,
				ec.join_nos_samba LCM_Samba_MergeIDs__c,
				ec.join_nos_nx LCM_NX_MergeIDs__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,
				CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
				    ELSE NULL           
				END clientrating__prior,

				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%'  
				THEN  NULL
				ELSE ec.fone           
				END Phone,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%' 
				THEN  ec.fone
				ELSE ec.handy           
				END MobilePhone, 
				ec.fax fax, 
				CASE WHEN ec.email LIKE 'etv@%' THEN  NULL
				ELSE ec.email           
				END email__c,
				ec.www website,
				NVL(RTRIM (legaladdr.x_street_name||' '||legaladdr.x_street_house_no), legaladdr.postal_display_street) legalstreet, 
				cy.zip_code LegalPostalCode,
				cy.city legalcity,
				CASE WHEN cy.state IS NULL THEN 
					cyp.state
				ELSE 
					cy.state 
				END LegalState,  
				CASE WHEN cy.country_uid IS NULL THEN 
					DECODE (cyp.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein')
				else 
					DECODE (cy.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein') 
				END legalcountry, 
				gt.text P_O_Box__c,
				cyp.zip_code P_O_BoxPostalCode__c,
				cyp.city p_o_boxcity__c, 
				DECODE (ec.language_uid, 
					246, 'German', 
					1303, 'English', 
					7770, 'French', 
					7771, 'Italian', '?'
				) PreferedLanguage__c,
				ec.structure__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,
				CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
				    ELSE NULL           
				END clientrating__prior,
				regexp_replace(
					coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), '^([^0-9]*) (\d+[a-zA-Z]{0,3})?$', '\1') 
					||  ' ' 
					|| nvl(shipping_addr.x_street_house_no, 
						ltrim(regexp_substr(
							coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), ' (\d+[a-zA-Z]{0,3})?$')
						)
				)  Shippingstreet, 
				cy_shipping.zip_code Shippingpostalcode,
				cy_shipping.city shippingcity, 
				cy_shipping.state ShippingState,
				DECODE (cy_shipping.country_uid, 
					1001148, 'Schweiz', 
					1001161, 'Deutschland', 
					1001179, 'Frankreich', 
					1001215, 'Italien', 
					1001234, 'Liechtenstein'
				) ShippingCountry,
				gt_sh_po.text ShippingP_O_Box__c,
				cy_sh_po.zip_code ShippingP_O_Box_PostalCode__c, 
				cy_sh_po.city ShippingP_O_BoxCity__c,
				DECODE (ec.x_advisory_status_uid, 
					117411, 'Fieldsales', 
					117413, 'KAM-Fieldsales'
				) SalesChannel__c,
				tkam.text KAMType__c, 
				CASE 
					WHEN kuba.legal_form_uid IS NOT NULL THEN
						REPLACE (tlf.text, 'K' || chr(50108) || 'Ba: ', '') 
					WHEN ec.y_legal_status_uid  <> 0 THEN 
						DECODE (ec.y_legal_status_uid, 
							875976469, 'AG', 
							875976471, 'Einzelunternehmen', 
							875976476, 'Genossenschaft', 
							875976472, 'GmbH', 
							875976474, 'Kollektivgesellschaft', 
							5714572491, 'Kommanditgesellschaft', 
							875976464, 'Stiftung', 
							875976459, 'Verein', 
							null
						)  
				END legalentity__c, 
				kuba.federal_company_id UID__c,
				tnc.text noga1__c,
				CASE WHEN kuba.founding_year = 0 THEN NULL
				ELSE kuba.founding_year
				END  CompanySince__c,
				CASE 
					WHEN kuba.turnover BETWEEN 2000001 AND 99999999 THEN  'A'
					WHEN kuba.turnover BETWEEN 1000001 AND 2000000 THEN  'B'
					WHEN kuba.turnover BETWEEN 200001 AND 1000000 THEN  'C'           
					WHEN kuba.turnover BETWEEN 5001 AND 200000 THEN  'D'             
				END TurnoverClass__c,
				tne.text NumberOfEmployees,
				EC.Allowed_comm_channel__c,
				EC.Communication_Channel__c
			FROM exported_companies ec
				LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
				LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr
				LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
				LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
				LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
				LEFT JOIN bsicrm.bsi_global_text gt ON gt.global_text_nr = AP.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cyp ON cyp.city_nr = AP.city_nr
				LEFT JOIN bsicrm.bsi_address shipping_addr ON shipping_addr.address_nr = ec.ship_address_nr
				LEFT JOIN bsicrm.bsi_address shipping_apo ON shipping_apo.address_nr = ec.ship_apo_nr
				LEFT JOIN bsicrm.bsi_city cy_sh_po ON cy_sh_po.city_nr = shipping_apo.city_nr
				LEFT JOIN bsicrm.bsi_global_text gt_sh_po ON gt_sh_po.global_text_nr = shipping_apo.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cy_shipping ON cy_shipping.city_nr = shipping_addr.city_nr
				LEFT JOIN bsicrm.bsi_uc_text tkam ON tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tlf ON tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tnc ON tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tne ON tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, OriginalSql = 	-----------------------------------
	--	Procedure lcm_accounts_samba --
	-----------------------------------
	--
			WITH exported_companies AS (
				SELECT /*+ ordered use_hash(ejj ej company cc cc2 a sspa sspba) full(ejj) full(ej) full(company) full(cc) full(cc2) full(a) full(sspa) full(sspba) */
					company.x_complex_no,  -- lcm_accounts_samba
					TRIM(company.name1 || ' ' || company.name2 || ' ' || company.name3) NAME,
					company.language_uid,
					COMPANY.x_is_locked,
					ejj.join_nr,
					dbms_lob.substr(comp_samba.join_nos_samba, 4000, 1 ) join_nos_samba,
					dbms_lob.substr(comp_nx.join_nos_nx, 4000, 1 ) join_nos_nx, 
					sadr.fone,
					sadr.handy,
					sadr.fax,
					sadr.email,
					sadr.www,
					kam.kamtyp,
					CASE 
						WHEN cc2.relation_uid = 300 THEN 'Group'
						WHEN cc2.relation_uid = 109876 THEN 'Company' 
						WHEN cc.relation_uid  = 300 THEN 'Company'
						WHEN cc.relation_uid  = 109876 THEN 'Branch'
						ELSE 'Single Company' 
					END structure__c, 
					sspa.address_nr address_nr,
					sspba.address_nr pobox_address_nr,
					ship_a.ship_anr  ship_address_nr,
					ship_ap.ship_apnr ship_apo_nr,
					company.y_legal_status_uid, 
					company.x_advisory_status_uid,  
					collection.join_nr coll_join_nr,
					kuba_data.kuba_join_nr,
					COMPANY.IS_MAILING_DISABLED Allowed_comm_channel__c,
					CASE WHEN xcrpd.LETTER_CHANNEL_UID IN (128573, 128572) THEN 
						'Email'
					WHEN xcrpd.LETTER_CHANNEL_UID IN (128575, 128574, 128571) THEN 
						'Letter'
					WHEN xcrpd.LETTER_CHANNEL_UID = 0 THEN 
						'n.a.'
					END Communication_Channel__c
				FROM bsicrm.bsi_x_ext_join_join ejj
					JOIN bsicrm.bsi_x_ext_join ej ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid 
						AND ej.active = 1
					JOIN bsicrm.bsi_company company ON company.company_nr = ejj.join_nr 
						AND company.is_active = 1
					LEFT JOIN BSICRM.BSI_X_CORRESPONDENCE xcrpd ON xcrpd.CUSTOMER_KEY0_NR = EJj.JOIN_NR
					LEFT JOIN bsicrm.bsi_company_company cc ON cc.company_nr = ejj.join_nr
					LEFT JOIN (
						SELECT 
							cc2.group_company_nr, 
							MIN(cc2.relation_uid) relation_uid
						FROM bsicrm.bsi_company_company cc2 
						GROUP BY cc2.group_company_nr
					) cc2 ON cc2.group_company_nr = ejj.join_nr     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							MIN(ej2.kam_uid) kamtyp, 
							ejj2.join_nr innerjnr
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr                     
						WHERE ej2.active = 1
						AND ej2.kam_uid != 0
						GROUP BY ejj2.join_nr
					) kam ON kam.innerjnr = ejj.join_nr  
					LEFT JOIN (
						SELECT /*+ ordered use_hash(adr am ej2) full(adr) full(am) full(ej2) */
							adr.item_key0_nr,
							max (CASE WHEN adr.channel_uid = 113638 THEN adr.channel_value ELSE NULL END) fone,
							max (CASE WHEN adr.channel_uid = 113640 THEN adr.channel_value ELSE NULL END) handy,
							max (CASE WHEN adr.channel_uid = 113639 THEN adr.channel_value ELSE NULL END) fax,
							max (CASE WHEN adr.channel_uid = 113641 THEN adr.channel_value ELSE NULL END) email,
							max (CASE WHEN adr.channel_uid = 113642 THEN adr.channel_value ELSE NULL END) www
						FROM bsicrm.bsi_address adr
							JOIN bsicrm.bsi_x_address_mapping am ON am.address_nr = adr.address_nr 
							JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = am.ext_join_nr and ej2.active = 1 AND ej2.interface_uid IN (108187,108205)
						WHERE adr.is_default_address = 1
							AND adr.item_type_id = 318594
						GROUP BY adr.item_key0_nr
					) sadr ON sadr.item_key0_nr = company.company_nr
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspa ON  sspa.ext_join_nr = ejj.ext_join_nr
						AND sspa.join_type_uid = 318594
						AND sspa.type_uid = 2315 /* Hauptadresse */
						AND sspa.channel_uid = 113688
						AND sspa.join_nr = ejj.join_nr             
					LEFT OUTER JOIN bsicrm.bsi_x_address_mapping sspba ON  sspba.ext_join_nr = ejj.ext_join_nr
						AND sspba.join_type_uid = 318594
						AND sspba.type_uid = 108240 /* Postfach */
						AND sspba.channel_uid = 113688
						AND sspba.join_nr = ejj.join_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_a au) full(ship_a) full(au) */
							ship_a.join_nr, 
							max (ship_a.address_nr )ship_aNr
						FROM bsicrm.bsi_x_address_mapping ship_a
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_a.address_nr
							AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_a.join_type_uid = 318594
							AND ship_a.channel_uid = 113688
							-- 2315:	Hauptadresse
							-- 108363:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedCode
							AND (ship_a.type_uid = 2315 OR  ship_a.type_uid = 108363)
						GROUP BY ship_a.join_nr
					) ship_a ON ship_a.join_nr = ejj.join_nr                     
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ship_ap au) full(ship_ap) full(au) */
							ship_ap.join_nr, 
							max (ship_ap.address_nr ) ship_apnr
						FROM bsicrm.bsi_x_address_mapping ship_ap
							JOIN bsicrm.bsi_address_usage au ON au.address_nr = ship_ap.address_nr
								AND au.usage_uid = 121808 --Adressnutzung von Firmen Korrespondenzadresse EP                     
						WHERE ship_ap.join_type_uid = 318594
							AND ship_ap.channel_uid = 113688
							-- 108240:	Postfach
							-- 108364:	LcmAddressTypeCodeType.CompanyMailingAddressMutatedPoBoxCode
							AND (ship_ap.type_uid = 108240 OR  ship_ap.type_uid = 108364)
						GROUP BY ship_ap.join_nr
					) ship_ap ON  ship_ap.join_nr = ejj.join_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(kd ej2 ejj2) full(kd) full(ej2) full(ejj2) */
							max (kd.join_nr) kuba_join_nr, 
							ejj2.join_nr             
						FROM bsicrm.bsi_x_ext_kuba_data kd
						JOIN bsicrm.bsi_x_ext_join ej2 ON ej2.ext_join_nr = kd.join_nr 
							AND ej2.ext_join_type_uid = kd.join_type_uid AND ej2.active = 1
						JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr 
							AND ejj2.ext_join_type_uid = ej2.ext_join_type_uid
						WHERE kd.status_uid = 4800511372 --aktiv  
						GROUP BY ejj2.join_nr
					) kuba_data ON kuba_data.join_nr = company.company_nr    
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(coll ejinner ejjinner) full(coll) full(ejinner) full(ejjinner) */
							DISTINCT ejjinner.join_nr 
						FROM bsicrm.bsi_x_collection coll 
							JOIN bsicrm.bsi_x_ext_join ejinner ON ejinner.ext_join_nr = coll.ext_company_nr 
								AND ejinner.active = 1
							JOIN bsicrm.bsi_x_ext_join_join ejjinner ON ejjinner.ext_join_nr = ejinner.ext_join_nr
						WHERE coll.status_uid <> 137824
					) collection ON collection.join_nr = company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_samba
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108187
						GROUP BY ejj2.join_nr
					) comp_samba ON comp_samba.join_nr =  company.company_nr 
					LEFT OUTER JOIN (
						SELECT /*+ ordered use_hash(ej2 ejj2) full(ej2) full(ejj2) */
							ejj2.join_nr, 
							RTRIM (XMLAGG(XMLELEMENT(E,ej2.join_no,CHR(44)).EXTRACT('//text()') ORDER BY ej2.join_no).getclobval(),',') join_nos_nx
						FROM bsicrm.bsi_x_ext_join ej2
							JOIN bsicrm.bsi_x_ext_join_join ejj2 ON ejj2.ext_join_nr = ej2.ext_join_nr
						WHERE ej2.active = 1
							AND ejj2.ext_join_type_uid = 108224
							AND ej2.interface_uid = 108205
						GROUP BY ejj2.join_nr
					) comp_nx ON comp_nx.join_nr =  company.company_nr  
				WHERE  ejj.is_master = 1
					AND    ejj.ext_join_type_uid = 108224
					AND    ej.interface_uid  = 108187 --samba      
			),
			dunning AS (
				SELECT /*+ ordered use_hash(xrcp ej ejj) full(xrcp) full(ej) full(ejj) */
					distinct ejj.join_nr -- company.x_complex_no                    
				FROM bsicrm.bsi_x_ext_receipt xrcp
					JOIN bsicrm.bsi_x_ext_join ej ON ej.ext_join_nr = xrcp.join_nr
						AND  ej.ext_join_type_uid = xrcp.join_type_uid    -- ??? ej.active = 1
					JOIN bsicrm.bsi_x_ext_join_join ejj ON ejj.ext_join_nr = ej.ext_join_nr 
						AND ejj.ext_join_type_uid = ej.ext_join_type_uid
				WHERE xrcp.overdue_level_uid IN (137663,137664,137665) 
			)  
			SELECT /*+ ordered use_hash(kuba dnng legaladdr cy ap gt cyp shipping_addr shipping_apo cy_sh_po gt_sh_po cy_shipping tkam tlf tnc tne) 
                   full(kuba) full(dnng) full(legaladdr) full(cy) full(ap) full(gt) full(cyp) full(shipping_addr) full(shipping_apo) full(cy_sh_po) full(gt_sh_po) full(cy_shipping) full(tkam) full(tlf) full(tnc) full(tne) */
				distinct ec.x_complex_no uk_LCM_X_COMPLEX_NO__c,
				ec.NAME,
				ec.join_nos_samba LCM_Samba_MergeIDs__c,
				ec.join_nos_nx LCM_NX_MergeIDs__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,
				CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
				    ELSE NULL           
				END clientrating__prior,

				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%'  
				THEN  NULL
				ELSE ec.fone           
				END Phone,
				CASE WHEN ec.fone LIKE '%+4175%' 
					OR ec.fone LIKE '%+4176%'  
					OR ec.fone LIKE '%+4177%'  
					OR ec.fone LIKE '%+4178%'  
					OR ec.fone LIKE '%+4179%' 
				THEN  ec.fone
				ELSE ec.handy           
				END MobilePhone, 
				ec.fax fax, 
				CASE WHEN ec.email LIKE 'etv@%' THEN  NULL
				ELSE ec.email           
				END email__c,
				ec.www website,
				NVL(RTRIM (legaladdr.x_street_name||' '||legaladdr.x_street_house_no), legaladdr.postal_display_street) legalstreet, 
				cy.zip_code LegalPostalCode,
				cy.city legalcity,
				CASE WHEN cy.state IS NULL THEN 
					cyp.state
				ELSE 
					cy.state 
				END LegalState,  
				CASE WHEN cy.country_uid IS NULL THEN 
					DECODE (cyp.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein')
				else 
					DECODE (cy.country_uid, 
						1001148, 'Schweiz', 
						1001161, 'Deutschland', 
						1001179, 'Frankreich', 
						1001215, 'Italien', 
						1001234, 'Liechtenstein') 
				END legalcountry, 
				gt.text P_O_Box__c,
				cyp.zip_code P_O_BoxPostalCode__c,
				cyp.city p_o_boxcity__c, 
				DECODE (ec.language_uid, 
					246, 'German', 
					1303, 'English', 
					7770, 'French', 
					7771, 'Italian', '?'
				) PreferedLanguage__c,
				ec.structure__c,
				CASE
					WHEN ec.x_is_locked = 1 THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
					ELSE NULL           
				END clientrating__c,
				CASE WHEN ec.coll_join_nr IS NOT NULL THEN 'D'
					WHEN dnng.join_nr IS NOT NULL THEN 'C'
				    ELSE NULL           
				END clientrating__prior,
				regexp_replace(
					coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), '^([^0-9]*) (\d+[a-zA-Z]{0,3})?$', '\1') 
					||  ' ' 
					|| nvl(shipping_addr.x_street_house_no, 
						ltrim(regexp_substr(
							coalesce(shipping_addr.x_street_name, shipping_addr.postal_display_street), ' (\d+[a-zA-Z]{0,3})?$')
						)
				)  Shippingstreet, 
				cy_shipping.zip_code Shippingpostalcode,
				cy_shipping.city shippingcity, 
				cy_shipping.state ShippingState,
				DECODE (cy_shipping.country_uid, 
					1001148, 'Schweiz', 
					1001161, 'Deutschland', 
					1001179, 'Frankreich', 
					1001215, 'Italien', 
					1001234, 'Liechtenstein'
				) ShippingCountry,
				gt_sh_po.text ShippingP_O_Box__c,
				cy_sh_po.zip_code ShippingP_O_Box_PostalCode__c, 
				cy_sh_po.city ShippingP_O_BoxCity__c,
				DECODE (ec.x_advisory_status_uid, 
					117411, 'Fieldsales', 
					117413, 'KAM-Fieldsales'
				) SalesChannel__c,
				tkam.text KAMType__c, 
				CASE 
					WHEN kuba.legal_form_uid IS NOT NULL THEN
						REPLACE (tlf.text, 'K' || chr(50108) || 'Ba: ', '') 
					WHEN ec.y_legal_status_uid  <> 0 THEN 
						DECODE (ec.y_legal_status_uid, 
							875976469, 'AG', 
							875976471, 'Einzelunternehmen', 
							875976476, 'Genossenschaft', 
							875976472, 'GmbH', 
							875976474, 'Kollektivgesellschaft', 
							5714572491, 'Kommanditgesellschaft', 
							875976464, 'Stiftung', 
							875976459, 'Verein', 
							null
						)  
				END legalentity__c, 
				kuba.federal_company_id UID__c,
				tnc.text noga1__c,
				CASE WHEN kuba.founding_year = 0 THEN NULL
				ELSE kuba.founding_year
				END  CompanySince__c,
				CASE 
					WHEN kuba.turnover BETWEEN 2000001 AND 99999999 THEN  'A'
					WHEN kuba.turnover BETWEEN 1000001 AND 2000000 THEN  'B'
					WHEN kuba.turnover BETWEEN 200001 AND 1000000 THEN  'C'           
					WHEN kuba.turnover BETWEEN 5001 AND 200000 THEN  'D'             
				END TurnoverClass__c,
				tne.text NumberOfEmployees,
				EC.Allowed_comm_channel__c,
				EC.Communication_Channel__c
			FROM exported_companies ec
				LEFT JOIN bsicrm.bsi_x_ext_kuba_data kuba ON kuba.join_nr = ec.kuba_join_nr
				LEFT JOIN dunning dnng ON dnng.join_nr = ec.join_nr
				LEFT JOIN bsicrm.bsi_address legaladdr ON legaladdr.address_nr = ec.address_nr
				LEFT JOIN bsicrm.bsi_city cy ON cy.city_nr = legaladdr.city_nr
				LEFT JOIN bsicrm.bsi_address ap ON ap.address_nr = ec.pobox_address_nr
				LEFT JOIN bsicrm.bsi_global_text gt ON gt.global_text_nr = AP.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cyp ON cyp.city_nr = AP.city_nr
				LEFT JOIN bsicrm.bsi_address shipping_addr ON shipping_addr.address_nr = ec.ship_address_nr
				LEFT JOIN bsicrm.bsi_address shipping_apo ON shipping_apo.address_nr = ec.ship_apo_nr
				LEFT JOIN bsicrm.bsi_city cy_sh_po ON cy_sh_po.city_nr = shipping_apo.city_nr
				LEFT JOIN bsicrm.bsi_global_text gt_sh_po ON gt_sh_po.global_text_nr = shipping_apo.postal_po_box_global_text_nr
				LEFT JOIN bsicrm.bsi_city cy_shipping ON cy_shipping.city_nr = shipping_addr.city_nr
				LEFT JOIN bsicrm.bsi_uc_text tkam ON tkam.uc_uid = ec.kamtyp and tkam.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tlf ON tlf.uc_uid = kuba.legal_form_uid and tlf.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tnc ON tnc.uc_uid = kuba.noga_code1_uid and tnc.language_uid = 246
				LEFT JOIN bsicrm.bsi_uc_text tne ON tne.uc_uid = kuba.number_of_employees_uid and tne.language_uid = 246
, Error Msg = ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-03 21:14:37.860
!MESSAGE Can't close statement
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-03 21:14:37.860
!MESSAGE Getrennte Verbindung
!STACK 0
java.sql.SQLRecoverableException: Getrennte Verbindung
	at oracle.jdbc.driver.PhysicalConnection.needLine(PhysicalConnection.java:3305)
	at oracle.jdbc.driver.OracleStatement.closeOrCache(OracleStatement.java:1409)
	at oracle.jdbc.driver.OracleStatement.close(OracleStatement.java:1392)
	at oracle.jdbc.driver.OracleStatementWrapper.close(OracleStatementWrapper.java:119)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.close(JDBCStatementImpl.java:512)
	at org.jkiss.dbeaver.model.impl.jdbc.struct.JDBCTable.readData(JDBCTable.java:230)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-03 21:14:39.455
!MESSAGE Operation failed. Retry count remains = 1
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-03 21:14:39.455
!MESSAGE SQL-Fehler [17002] [08006]: I/O-Fehler: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!SUBENTRY 2 org.jkiss.dbeaver.model 4 0 2019-11-03 21:14:39.455
!MESSAGE I/O-Fehler: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!STACK 0
java.sql.SQLRecoverableException: I/O-Fehler: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:738)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.doScrollExecuteCommon(OracleStatement.java:4699)
	at oracle.jdbc.driver.OracleStatement.doScrollStmtExecuteQuery(OracleStatement.java:4815)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1758)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.model.impl.jdbc.struct.JDBCTable.readData(JDBCTable.java:189)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)
Caused by: java.io.IOException: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:51)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:113)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:79)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:50)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:463)
	at oracle.net.nt.TimeoutSocketChannel.write(TimeoutSocketChannel.java:207)
	at oracle.net.ns.NIOPacket.writeToSocketChannel(NIOPacket.java:308)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:182)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:133)
	at oracle.jdbc.driver.T4CMAREngineNIO.flush(T4CMAREngineNIO.java:741)
	at oracle.jdbc.driver.T4CMAREngineNIO.prepareForUnmarshall(T4CMAREngineNIO.java:754)
	at oracle.jdbc.driver.T4CMAREngineNIO.unmarshalUB1(T4CMAREngineNIO.java:427)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:394)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	... 15 more
!SUBENTRY 3 org.jkiss.dbeaver.model 4 0 2019-11-03 21:14:39.455
!MESSAGE Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!STACK 0
java.io.IOException: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:51)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:113)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:79)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:50)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:463)
	at oracle.net.nt.TimeoutSocketChannel.write(TimeoutSocketChannel.java:207)
	at oracle.net.ns.NIOPacket.writeToSocketChannel(NIOPacket.java:308)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:182)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:133)
	at oracle.jdbc.driver.T4CMAREngineNIO.flush(T4CMAREngineNIO.java:741)
	at oracle.jdbc.driver.T4CMAREngineNIO.prepareForUnmarshall(T4CMAREngineNIO.java:754)
	at oracle.jdbc.driver.T4CMAREngineNIO.unmarshalUB1(T4CMAREngineNIO.java:427)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:394)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.doScrollExecuteCommon(OracleStatement.java:4699)
	at oracle.jdbc.driver.OracleStatement.doScrollStmtExecuteQuery(OracleStatement.java:4815)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1758)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.model.impl.jdbc.struct.JDBCTable.readData(JDBCTable.java:189)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 2 0 2019-11-04 15:09:42.142
!MESSAGE Some data source listeners are still registered: [org.jkiss.dbeaver.ui.editors.sql.syntax.SQLContextInformer$1@1c808121]
!SESSION 2019-11-05 15:14:32.218 -----------------------------------------------
eclipse.buildId=4.9.0.I20180906-0745
java.version=11.0.3
java.vendor=Oracle Corporation
BootLoader constants: OS=win32, ARCH=x86_64, WS=win32, NL=de_CH
Framework arguments:  -product org.eclipse.epp.package.jee.product
Command-line arguments:  -os win32 -ws win32 -arch x86_64 -product org.eclipse.epp.package.jee.product

!ENTRY org.eclipse.jface 2 0 2019-11-05 15:15:57.814
!MESSAGE Keybinding conflicts occurred.  They may interfere with normal accelerator operation.
!SUBENTRY 1 org.eclipse.jface 2 0 2019-11-05 15:15:57.814
!MESSAGE A conflict occurred for CTRL+SHIFT+V:
Binding(CTRL+SHIFT+V,
	ParameterizedCommand(Command(org.eclipse.jdt.debug.ui.command.OpenFromClipboard,Open from Clipboard,
		Opens a Java element or a Java stack trace from clipboard,
		Category(org.eclipse.ui.category.navigate,Navigate,null,true),
		org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@79beb8a0,
		,,true),null),
	org.eclipse.ui.defaultAcceleratorConfiguration,
	org.eclipse.ui.contexts.window,,,system)
Binding(CTRL+SHIFT+V,
	ParameterizedCommand(Command(org.jkiss.dbeaver.core.edit.paste.special,Erweitertes Einfügen,
		Einfügen mit zusätzlichen Einstellungen,
		Category(org.jkiss.dbeaver.core.util,Werkzeuge,Werkzeugebefehle,true),
		org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@b6a20ce,
		,,true),null),
	org.eclipse.ui.defaultAcceleratorConfiguration,
	org.eclipse.ui.contexts.window,,,system)
!SUBENTRY 1 org.eclipse.jface 2 0 2019-11-05 15:15:57.814
!MESSAGE A conflict occurred for CTRL+SHIFT+A:
Binding(CTRL+SHIFT+A,
	ParameterizedCommand(Command(org.eclipse.pde.ui.openPluginArtifact,Open Plug-in Artifact,
		Open a plug-in artifact in the manifest editor,
		Category(org.eclipse.ui.category.navigate,Navigate,null,true),
		org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@79296ce0,
		,,true),null),
	org.eclipse.ui.defaultAcceleratorConfiguration,
	org.eclipse.ui.contexts.window,,,system)
Binding(CTRL+SHIFT+A,
	ParameterizedCommand(Command(org.jkiss.dbeaver.core.navigator.set.active,Aktives Objekt festlegen,
		Aktives Objekt festlegen,
		Category(org.jkiss.dbeaver.core.navigator,Datenbanknavigator,Datenbanknavigatorbefehle,true),
		org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@19c28c97,
		,,true),null),
	org.eclipse.ui.defaultAcceleratorConfiguration,
	org.eclipse.ui.contexts.window,,,system)

!ENTRY org.eclipse.jface 2 0 2019-11-05 15:16:07.822
!MESSAGE Keybinding conflicts occurred.  They may interfere with normal accelerator operation.
!SUBENTRY 1 org.eclipse.jface 2 0 2019-11-05 15:16:07.822
!MESSAGE A conflict occurred for CTRL+D:
Binding(CTRL+D,
	ParameterizedCommand(Command(org.eclipse.ui.edit.text.delete.line,Delete Line,
		Delete a line of text,
		Category(org.eclipse.ui.category.textEditor,Text Editing,Text Editing Commands,true),
		org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@2c283221,
		,,true),null),
	org.eclipse.ui.defaultAcceleratorConfiguration,
	org.eclipse.ui.textEditorScope,,,system)
Binding(CTRL+D,
	ParameterizedCommand(Command(org.jkiss.dbeaver.core.navigator.bookmark.add,Lesezeichen hinufügen,
		Lesezeichen hinufügen,
		Category(org.jkiss.dbeaver.core.navigator,Datenbanknavigator,Datenbanknavigatorbefehle,true),
		org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@17dee9f9,
		,,true),null),
	org.eclipse.ui.defaultAcceleratorConfiguration,
	org.jkiss.dbeaver.ui.context.navigator,,,system)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-05 15:18:48.505
!MESSAGE SQL-Fehler [942] [42000]: ORA-00942: Tabelle oder View nicht vorhanden

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-05 15:18:48.505
!MESSAGE Error : 942, Position : 868, Sql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
from bsicrm.bsi_x_complaint XCPL
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
where XCPL.status_uid in
('109053','119170')
and XCPL.company_nr is not null
and TO_DATE(XCPL.evt_issued, 'dd.mm.yyyy') > to_date('31.12.14', 'dd.mm.yyyy')
, OriginalSql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
from bsicrm.bsi_x_complaint XCPL
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
where XCPL.status_uid in
('109053','119170')
and XCPL.company_nr is not null
and TO_DATE(XCPL.evt_issued, 'dd.mm.yyyy') > to_date('31.12.14', 'dd.mm.yyyy')
, Error Msg = ORA-00942: Tabelle oder View nicht vorhanden

!STACK 0
Error : 942, Position : 868, Sql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
from bsicrm.bsi_x_complaint XCPL
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
where XCPL.status_uid in
('109053','119170')
and XCPL.company_nr is not null
and TO_DATE(XCPL.evt_issued, 'dd.mm.yyyy') > to_date('31.12.14', 'dd.mm.yyyy')
, OriginalSql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
--	xcpl.COMPLAINT_CATEGORY_UID
	uc_cp_cat.text case_reason,
--	XCPL.STATUS_UID,
	'Closed' Status,
	XCPL.SUBJECT,
--	XCPL.RESPONSIBLE_UID,
--	XCPL.EVT_DUE,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
from bsicrm.bsi_x_complaint XCPL
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
where XCPL.status_uid in
('109053','119170')
and XCPL.company_nr is not null
and TO_DATE(XCPL.evt_issued, 'dd.mm.yyyy') > to_date('31.12.14', 'dd.mm.yyyy')
, Error Msg = ORA-00942: Tabelle oder View nicht vorhanden

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.doScrollExecuteCommon(OracleStatement.java:4699)
	at oracle.jdbc.driver.OracleStatement.doScrollStmtExecuteQuery(OracleStatement.java:4815)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1758)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.eclipse.core.expressions 4 201 2019-11-05 15:20:30.879
!MESSAGE No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource
!STACK 1
org.eclipse.core.runtime.CoreException: No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource
	at org.eclipse.core.internal.expressions.TypeExtensionManager.getProperty(TypeExtensionManager.java:130)
	at org.eclipse.core.internal.expressions.TestExpression.evaluate(TestExpression.java:100)
	at org.eclipse.core.internal.expressions.CompositeExpression.evaluateAnd(CompositeExpression.java:55)
	at org.eclipse.core.internal.expressions.AndExpression.evaluate(AndExpression.java:34)
	at org.eclipse.ui.internal.dialogs.RegistryPageContributor.failsEnablement(RegistryPageContributor.java:309)
	at org.eclipse.ui.internal.dialogs.RegistryPageContributor.isApplicableTo(RegistryPageContributor.java:251)
	at org.eclipse.ui.internal.dialogs.PropertyPageContributorManager.getApplicableContributors(PropertyPageContributorManager.java:218)
	at org.eclipse.ui.dialogs.PreferencesUtil.hasPropertiesContributors(PreferencesUtil.java:305)
	at org.jkiss.dbeaver.ui.navigator.NavigatorUtils.lambda$0(NavigatorUtils.java:223)
	at org.eclipse.jface.action.MenuManager.fireAboutToShow(MenuManager.java:342)
	at org.eclipse.jface.action.MenuManager.handleAboutToShow(MenuManager.java:473)
	at org.eclipse.jface.action.MenuManager.access$1(MenuManager.java:468)
	at org.eclipse.jface.action.MenuManager$2.menuShown(MenuManager.java:500)
	at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:259)
	at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:89)
	at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4145)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1055)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1079)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1060)
	at org.eclipse.swt.widgets.Control.WM_INITMENUPOPUP(Control.java:5148)
	at org.eclipse.swt.widgets.Control.windowProc(Control.java:4797)
	at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:348)
	at org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1502)
	at org.eclipse.swt.widgets.Shell.windowProc(Shell.java:2162)
	at org.eclipse.swt.widgets.Display.windowProc(Display.java:4784)
	at org.eclipse.swt.internal.win32.OS.TrackPopupMenu(Native Method)
	at org.eclipse.swt.widgets.Menu._setVisible(Menu.java:253)
	at org.eclipse.swt.widgets.Display.runPopups(Display.java:3999)
	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3555)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$5.run(PartRenderingEngine.java:1173)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1062)
	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156)
	at org.eclipse.ui.internal.Workbench.lambda$3(Workbench.java:628)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:563)
	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:151)
	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:155)
	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:199)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:137)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:107)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:391)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:246)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:659)
	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:595)
	at org.eclipse.equinox.launcher.Main.run(Main.java:1501)
	at org.eclipse.equinox.launcher.Main.main(Main.java:1474)
!SUBENTRY 1 org.eclipse.core.expressions 4 201 2019-11-05 15:20:30.880
!MESSAGE No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource

!ENTRY org.eclipse.equinox.p2.metadata.repository 4 1000 2019-11-05 15:42:13.199
!MESSAGE No repository found at http://download.eclipse.org/usssdk/drops/nightly/N923.
!SESSION 2019-11-07 08:01:42.695 -----------------------------------------------
eclipse.buildId=4.9.0.I20180906-0745
java.version=11.0.3
java.vendor=Oracle Corporation
BootLoader constants: OS=win32, ARCH=x86_64, WS=win32, NL=de_CH
Framework arguments:  -product org.eclipse.epp.package.jee.product
Command-line arguments:  -os win32 -ws win32 -arch x86_64 -product org.eclipse.epp.package.jee.product

!ENTRY org.eclipse.jface 2 0 2019-11-07 08:02:51.237
!MESSAGE Keybinding conflicts occurred.  They may interfere with normal accelerator operation.
!SUBENTRY 1 org.eclipse.jface 2 0 2019-11-07 08:02:51.237
!MESSAGE A conflict occurred for CTRL+SHIFT+V:
Binding(CTRL+SHIFT+V,
	ParameterizedCommand(Command(org.eclipse.jdt.debug.ui.command.OpenFromClipboard,Open from Clipboard,
		Opens a Java element or a Java stack trace from clipboard,
		Category(org.eclipse.ui.category.navigate,Navigate,null,true),
		org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@3a35a792,
		,,true),null),
	org.eclipse.ui.defaultAcceleratorConfiguration,
	org.eclipse.ui.contexts.window,,,system)
Binding(CTRL+SHIFT+V,
	ParameterizedCommand(Command(org.jkiss.dbeaver.core.edit.paste.special,Erweitertes Einfügen,
		Einfügen mit zusätzlichen Einstellungen,
		Category(org.jkiss.dbeaver.core.util,Werkzeuge,Werkzeugebefehle,true),
		org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@254dfd34,
		,,true),null),
	org.eclipse.ui.defaultAcceleratorConfiguration,
	org.eclipse.ui.contexts.window,,,system)
!SUBENTRY 1 org.eclipse.jface 2 0 2019-11-07 08:02:51.237
!MESSAGE A conflict occurred for CTRL+SHIFT+A:
Binding(CTRL+SHIFT+A,
	ParameterizedCommand(Command(org.eclipse.pde.ui.openPluginArtifact,Open Plug-in Artifact,
		Open a plug-in artifact in the manifest editor,
		Category(org.eclipse.ui.category.navigate,Navigate,null,true),
		org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@72f4232,
		,,true),null),
	org.eclipse.ui.defaultAcceleratorConfiguration,
	org.eclipse.ui.contexts.window,,,system)
Binding(CTRL+SHIFT+A,
	ParameterizedCommand(Command(org.jkiss.dbeaver.core.navigator.set.active,Aktives Objekt festlegen,
		Aktives Objekt festlegen,
		Category(org.jkiss.dbeaver.core.navigator,Datenbanknavigator,Datenbanknavigatorbefehle,true),
		org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@1c74eeb7,
		,,true),null),
	org.eclipse.ui.defaultAcceleratorConfiguration,
	org.eclipse.ui.contexts.window,,,system)

!ENTRY org.jkiss.dbeaver.model 2 0 2019-11-07 08:04:59.303
!MESSAGE Error reading Windows registry
!SUBENTRY 1 org.jkiss.dbeaver.model 2 0 2019-11-07 08:04:59.303
!MESSAGE 
!STACK 0
java.lang.NullPointerException
	at org.jkiss.dbeaver.utils.WinRegistry.readStringSubKeys(WinRegistry.java:337)
	at org.jkiss.dbeaver.utils.WinRegistry.readStringSubKeys(WinRegistry.java:162)
	at org.jkiss.dbeaver.ext.oracle.oci.OCIUtils.findOraHomes(OCIUtils.java:170)
	at org.jkiss.dbeaver.ext.oracle.oci.OCIUtils.checkOraHomes(OCIUtils.java:68)
	at org.jkiss.dbeaver.ext.oracle.oci.OCIUtils.getOraHomes(OCIUtils.java:62)
	at org.jkiss.dbeaver.ext.oracle.OracleDataSourceProvider.getDefaultLocalClientLocation(OracleDataSourceProvider.java:149)
	at org.jkiss.dbeaver.registry.driver.DriverDescriptor.getDefaultClientLocation(DriverDescriptor.java:1271)
	at org.jkiss.dbeaver.ui.dialogs.connection.ConnectionWizard.getActiveDataSource(ConnectionWizard.java:114)
	at org.jkiss.dbeaver.ui.dialogs.connection.ConnectionPageSettings.getActiveDataSource(ConnectionPageSettings.java:292)
	at org.jkiss.dbeaver.ui.dialogs.connection.ConnectionPageSettings.getActiveDataSource(ConnectionPageSettings.java:1)
	at org.jkiss.dbeaver.ui.dialogs.connection.ConnectionPageAbstract.createSavePasswordButton(ConnectionPageAbstract.java:226)
	at org.jkiss.dbeaver.ext.oracle.views.OracleConnectionPage.createSecurityGroup(OracleConnectionPage.java:310)
	at org.jkiss.dbeaver.ext.oracle.views.OracleConnectionPage.createControl(OracleConnectionPage.java:115)
	at org.jkiss.dbeaver.ui.dialogs.connection.ConnectionPageSettings.createProviderPage(ConnectionPageSettings.java:211)
	at org.jkiss.dbeaver.ui.dialogs.connection.ConnectionPageSettings.activatePage(ConnectionPageSettings.java:108)
	at org.jkiss.dbeaver.ui.dialogs.ActiveWizardPage.setVisible(ActiveWizardPage.java:57)
	at org.eclipse.jface.wizard.WizardDialog.updateForPage(WizardDialog.java:1196)
	at org.eclipse.jface.wizard.WizardDialog.lambda$3(WizardDialog.java:1166)
	at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:72)
	at org.eclipse.jface.wizard.WizardDialog.showPage(WizardDialog.java:1166)
	at org.eclipse.jface.wizard.WizardDialog.nextPressed(WizardDialog.java:861)
	at org.eclipse.jface.wizard.WizardDialog.buttonPressed(WizardDialog.java:410)
	at org.eclipse.jface.dialogs.Dialog.lambda$0(Dialog.java:622)
	at org.eclipse.swt.events.SelectionListener$1.widgetSelected(SelectionListener.java:84)
	at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:252)
	at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:89)
	at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4145)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1055)
	at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3958)
	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3561)
	at org.eclipse.jface.window.Window.runEventLoop(Window.java:821)
	at org.eclipse.jface.window.Window.open(Window.java:797)
	at org.eclipse.ui.internal.actions.NewWizardShortcutAction.run(NewWizardShortcutAction.java:136)
	at org.eclipse.jface.action.Action.runWithEvent(Action.java:476)
	at org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:568)
	at org.eclipse.jface.action.ActionContributionItem.lambda$4(ActionContributionItem.java:400)
	at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:89)
	at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4145)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1055)
	at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3958)
	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3561)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$5.run(PartRenderingEngine.java:1173)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1062)
	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156)
	at org.eclipse.ui.internal.Workbench.lambda$3(Workbench.java:628)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:563)
	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:151)
	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:155)
	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:199)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:137)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:107)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:391)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:246)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:659)
	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:595)
	at org.eclipse.equinox.launcher.Main.run(Main.java:1501)
	at org.eclipse.equinox.launcher.Main.main(Main.java:1474)

!ENTRY org.eclipse.ui.workbench 4 0 2019-11-07 08:05:38.592
!MESSAGE Invalid thread access
!STACK 0
org.eclipse.swt.SWTException: Invalid thread access
	at org.eclipse.swt.SWT.error(SWT.java:4595)
	at org.eclipse.swt.SWT.error(SWT.java:4510)
	at org.eclipse.swt.SWT.error(SWT.java:4481)
	at org.eclipse.swt.widgets.Widget.error(Widget.java:451)
	at org.eclipse.swt.widgets.Widget.checkWidget(Widget.java:369)
	at org.eclipse.swt.widgets.Decorations.getText(Decorations.java:683)
	at org.eclipse.ui.internal.WorkbenchWindowConfigurer.getTitle(WorkbenchWindowConfigurer.java:271)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor.recomputeTitle(IDEWorkbenchWindowAdvisor.java:435)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor.access$2(IDEWorkbenchWindowAdvisor.java:433)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor$1.propertyChanged(IDEWorkbenchWindowAdvisor.java:116)
	at org.eclipse.ui.part.WorkbenchPart.firePropertyChange(WorkbenchPart.java:122)
	at org.eclipse.ui.texteditor.AbstractTextEditor.firePropertyChange(AbstractTextEditor.java:6345)
	at org.eclipse.ui.part.WorkbenchPart.setTitle(WorkbenchPart.java:288)
	at org.eclipse.ui.part.EditorPart.setDefaultTitle(EditorPart.java:288)
	at org.eclipse.ui.part.WorkbenchPart.setPartName(WorkbenchPart.java:368)
	at org.eclipse.ui.part.EditorPart.setPartName(EditorPart.java:263)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor.setDataSourceContainer(SQLEditor.java:323)
	at org.jkiss.dbeaver.ui.perspective.DataSourceManagementToolbar$4.run(DataSourceManagementToolbar.java:627)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.eclipse.ui 4 0 2019-11-07 08:05:38.647
!MESSAGE Unhandled event loop exception
!STACK 0
java.util.ConcurrentModificationException
	at java.base/java.util.TreeMap$PrivateEntryIterator.nextEntry(TreeMap.java:1208)
	at java.base/java.util.TreeMap$KeyIterator.next(TreeMap.java:1262)
	at org.jkiss.dbeaver.ui.editors.sql.syntax.SQLRuleManager.refreshRules(SQLRuleManager.java:285)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditorBase.reloadSyntaxRules(SQLEditorBase.java:577)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor.reloadSyntaxRules(SQLEditor.java:2157)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor.onDataSourceChange(SQLEditor.java:1879)
	at org.eclipse.ui.internal.PendingSyncExec.run(PendingSyncExec.java:61)
	at org.eclipse.ui.internal.UILockListener.doPendingWork(UILockListener.java:171)
	at org.eclipse.ui.internal.UISynchronizer.lambda$0(UISynchronizer.java:153)
	at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:40)
	at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:185)
	at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3933)
	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3564)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$5.run(PartRenderingEngine.java:1173)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1062)
	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156)
	at org.eclipse.ui.internal.Workbench.lambda$3(Workbench.java:628)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:563)
	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:151)
	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:155)
	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:199)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:137)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:107)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:391)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:246)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:659)
	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:595)
	at org.eclipse.equinox.launcher.Main.run(Main.java:1501)
	at org.eclipse.equinox.launcher.Main.main(Main.java:1474)

!ENTRY org.eclipse.ui.workbench 4 0 2019-11-07 08:05:49.342
!MESSAGE Invalid thread access
!STACK 0
org.eclipse.swt.SWTException: Invalid thread access
	at org.eclipse.swt.SWT.error(SWT.java:4595)
	at org.eclipse.swt.SWT.error(SWT.java:4510)
	at org.eclipse.swt.SWT.error(SWT.java:4481)
	at org.eclipse.swt.widgets.Widget.error(Widget.java:451)
	at org.eclipse.swt.widgets.Widget.checkWidget(Widget.java:369)
	at org.eclipse.swt.widgets.Decorations.getText(Decorations.java:683)
	at org.eclipse.ui.internal.WorkbenchWindowConfigurer.getTitle(WorkbenchWindowConfigurer.java:271)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor.recomputeTitle(IDEWorkbenchWindowAdvisor.java:435)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor.access$2(IDEWorkbenchWindowAdvisor.java:433)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor$1.propertyChanged(IDEWorkbenchWindowAdvisor.java:116)
	at org.eclipse.ui.part.WorkbenchPart.firePropertyChange(WorkbenchPart.java:122)
	at org.eclipse.ui.texteditor.AbstractTextEditor.firePropertyChange(AbstractTextEditor.java:6345)
	at org.eclipse.ui.part.WorkbenchPart.setTitle(WorkbenchPart.java:288)
	at org.eclipse.ui.part.EditorPart.setDefaultTitle(EditorPart.java:288)
	at org.eclipse.ui.part.WorkbenchPart.setPartName(WorkbenchPart.java:368)
	at org.eclipse.ui.part.EditorPart.setPartName(EditorPart.java:263)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor.setDataSourceContainer(SQLEditor.java:323)
	at org.jkiss.dbeaver.ui.perspective.DataSourceManagementToolbar$4.run(DataSourceManagementToolbar.java:627)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.eclipse.ui.workbench 4 0 2019-11-07 08:09:30.134
!MESSAGE Invalid thread access
!STACK 0
org.eclipse.swt.SWTException: Invalid thread access
	at org.eclipse.swt.SWT.error(SWT.java:4595)
	at org.eclipse.swt.SWT.error(SWT.java:4510)
	at org.eclipse.swt.SWT.error(SWT.java:4481)
	at org.eclipse.swt.widgets.Widget.error(Widget.java:451)
	at org.eclipse.swt.widgets.Widget.checkWidget(Widget.java:369)
	at org.eclipse.swt.widgets.Decorations.getText(Decorations.java:683)
	at org.eclipse.ui.internal.WorkbenchWindowConfigurer.getTitle(WorkbenchWindowConfigurer.java:271)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor.recomputeTitle(IDEWorkbenchWindowAdvisor.java:435)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor.access$2(IDEWorkbenchWindowAdvisor.java:433)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor$1.propertyChanged(IDEWorkbenchWindowAdvisor.java:116)
	at org.eclipse.ui.part.WorkbenchPart.firePropertyChange(WorkbenchPart.java:122)
	at org.eclipse.ui.texteditor.AbstractTextEditor.firePropertyChange(AbstractTextEditor.java:6345)
	at org.eclipse.ui.part.WorkbenchPart.setTitle(WorkbenchPart.java:288)
	at org.eclipse.ui.part.EditorPart.setDefaultTitle(EditorPart.java:288)
	at org.eclipse.ui.part.WorkbenchPart.setPartName(WorkbenchPart.java:368)
	at org.eclipse.ui.part.EditorPart.setPartName(EditorPart.java:263)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor.setDataSourceContainer(SQLEditor.java:323)
	at org.jkiss.dbeaver.ui.perspective.DataSourceManagementToolbar$4.run(DataSourceManagementToolbar.java:627)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.eclipse.ui.workbench 4 0 2019-11-07 08:11:24.191
!MESSAGE Invalid thread access
!STACK 0
org.eclipse.swt.SWTException: Invalid thread access
	at org.eclipse.swt.SWT.error(SWT.java:4595)
	at org.eclipse.swt.SWT.error(SWT.java:4510)
	at org.eclipse.swt.SWT.error(SWT.java:4481)
	at org.eclipse.swt.widgets.Widget.error(Widget.java:451)
	at org.eclipse.swt.widgets.Widget.checkWidget(Widget.java:369)
	at org.eclipse.swt.widgets.Decorations.getText(Decorations.java:683)
	at org.eclipse.ui.internal.WorkbenchWindowConfigurer.getTitle(WorkbenchWindowConfigurer.java:271)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor.recomputeTitle(IDEWorkbenchWindowAdvisor.java:435)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor.access$2(IDEWorkbenchWindowAdvisor.java:433)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor$1.propertyChanged(IDEWorkbenchWindowAdvisor.java:116)
	at org.eclipse.ui.part.WorkbenchPart.firePropertyChange(WorkbenchPart.java:122)
	at org.eclipse.ui.texteditor.AbstractTextEditor.firePropertyChange(AbstractTextEditor.java:6345)
	at org.eclipse.ui.part.WorkbenchPart.setTitle(WorkbenchPart.java:288)
	at org.eclipse.ui.part.EditorPart.setDefaultTitle(EditorPart.java:288)
	at org.eclipse.ui.part.WorkbenchPart.setPartName(WorkbenchPart.java:368)
	at org.eclipse.ui.part.EditorPart.setPartName(EditorPart.java:263)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor.setDataSourceContainer(SQLEditor.java:323)
	at org.jkiss.dbeaver.ui.perspective.DataSourceManagementToolbar$4.run(DataSourceManagementToolbar.java:627)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.eclipse.ui.workbench 4 0 2019-11-07 08:15:34.028
!MESSAGE Invalid thread access
!STACK 0
org.eclipse.swt.SWTException: Invalid thread access
	at org.eclipse.swt.SWT.error(SWT.java:4595)
	at org.eclipse.swt.SWT.error(SWT.java:4510)
	at org.eclipse.swt.SWT.error(SWT.java:4481)
	at org.eclipse.swt.widgets.Widget.error(Widget.java:451)
	at org.eclipse.swt.widgets.Widget.checkWidget(Widget.java:369)
	at org.eclipse.swt.widgets.Decorations.getText(Decorations.java:683)
	at org.eclipse.ui.internal.WorkbenchWindowConfigurer.getTitle(WorkbenchWindowConfigurer.java:271)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor.recomputeTitle(IDEWorkbenchWindowAdvisor.java:435)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor.access$2(IDEWorkbenchWindowAdvisor.java:433)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor$1.propertyChanged(IDEWorkbenchWindowAdvisor.java:116)
	at org.eclipse.ui.part.WorkbenchPart.firePropertyChange(WorkbenchPart.java:122)
	at org.eclipse.ui.texteditor.AbstractTextEditor.firePropertyChange(AbstractTextEditor.java:6345)
	at org.eclipse.ui.part.WorkbenchPart.setTitle(WorkbenchPart.java:288)
	at org.eclipse.ui.part.EditorPart.setDefaultTitle(EditorPart.java:288)
	at org.eclipse.ui.part.WorkbenchPart.setPartName(WorkbenchPart.java:368)
	at org.eclipse.ui.part.EditorPart.setPartName(EditorPart.java:263)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor.setDataSourceContainer(SQLEditor.java:323)
	at org.jkiss.dbeaver.ui.perspective.DataSourceManagementToolbar$4.run(DataSourceManagementToolbar.java:627)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-07 08:15:40.285
!MESSAGE SQL-Fehler [942] [42000]: ORA-00942: Tabelle oder View nicht vorhanden

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-07 08:15:40.285
!MESSAGE Error : 942, Position : 54, Sql = select owner
 	, object_type
	, status
FROM SYSTEM.all_objects
where object_name = 'UTL_FILE'
, OriginalSql = select owner
 	, object_type
	, status
FROM SYSTEM.all_objects
where object_name = 'UTL_FILE'
, Error Msg = ORA-00942: Tabelle oder View nicht vorhanden

!STACK 0
Error : 942, Position : 54, Sql = select owner
 	, object_type
	, status
FROM SYSTEM.all_objects
where object_name = 'UTL_FILE'
, OriginalSql = select owner
 	, object_type
	, status
FROM SYSTEM.all_objects
where object_name = 'UTL_FILE'
, Error Msg = ORA-00942: Tabelle oder View nicht vorhanden

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.doScrollExecuteCommon(OracleStatement.java:4699)
	at oracle.jdbc.driver.OracleStatement.doScrollStmtExecuteQuery(OracleStatement.java:4815)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1758)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.eclipse.equinox.p2.metadata.repository 4 1000 2019-11-07 08:51:30.084
!MESSAGE No repository found at http://download.eclipse.org/usssdk/drops/nightly/N923.

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-13 10:41:43.690
!MESSAGE Can't close statement
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-13 10:41:43.690
!MESSAGE Getrennte Verbindung
!STACK 0
java.sql.SQLRecoverableException: Getrennte Verbindung
	at oracle.jdbc.driver.PhysicalConnection.needLine(PhysicalConnection.java:3305)
	at oracle.jdbc.driver.OracleStatement.closeOrCache(OracleStatement.java:1409)
	at oracle.jdbc.driver.OracleStatement.close(OracleStatement.java:1392)
	at oracle.jdbc.driver.OracleStatementWrapper.close(OracleStatementWrapper.java:119)
	at oracle.jdbc.driver.OraclePreparedStatementWrapper.close(OraclePreparedStatementWrapper.java:96)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.close(JDBCStatementImpl.java:512)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCPreparedStatementImpl.close(JDBCPreparedStatementImpl.java:97)
	at org.jkiss.dbeaver.model.impl.jdbc.cache.JDBCObjectCache.loadObjects(JDBCObjectCache.java:129)
	at org.jkiss.dbeaver.model.impl.jdbc.cache.JDBCObjectCache.getAllObjects(JDBCObjectCache.java:70)
	at org.jkiss.dbeaver.model.impl.AbstractObjectCache.getTypedObjects(AbstractObjectCache.java:80)
	at org.jkiss.dbeaver.ext.oracle.model.OracleSchema.getTables(OracleSchema.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.extractPropertyValue(DBNDatabaseNode.java:824)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.access$1(DBNDatabaseNode.java:805)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode$PropertyValueReader.run(DBNDatabaseNode.java:885)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode$PropertyValueReader.run(DBNDatabaseNode.java:1)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.loadTreeItems(DBNDatabaseNode.java:498)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.loadChildren(DBNDatabaseNode.java:421)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.getChildren(DBNDatabaseNode.java:206)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.getChildren(DBNDatabaseNode.java:1)
	at org.jkiss.dbeaver.model.navigator.DBNModel.findNodeByPath(DBNModel.java:310)
	at org.jkiss.dbeaver.model.navigator.DBNModel.findNodeByPath(DBNModel.java:335)
	at org.jkiss.dbeaver.model.navigator.DBNModel.findNodeByPath(DBNModel.java:335)
	at org.jkiss.dbeaver.model.navigator.DBNModel.findNodeByPath(DBNModel.java:335)
	at org.jkiss.dbeaver.model.navigator.DBNModel.getNodeByPath(DBNModel.java:281)
	at org.jkiss.dbeaver.ui.editors.DatabaseLazyEditorInput.initializeRealInput(DatabaseLazyEditorInput.java:223)
	at org.jkiss.dbeaver.ui.editors.ProgressEditorPart$InitNodeService.evaluate(ProgressEditorPart.java:133)
	at org.jkiss.dbeaver.ui.editors.ProgressEditorPart$InitNodeService.evaluate(ProgressEditorPart.java:1)
	at org.jkiss.dbeaver.ui.LoadingJob.run(LoadingJob.java:86)
	at org.jkiss.dbeaver.ui.LoadingJob.run(LoadingJob.java:71)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-13 10:41:43.919
!MESSAGE Operation failed. Retry count remains = 1
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-13 10:41:43.919
!MESSAGE SQL-Fehler [17002] [08006]: I/O-Fehler: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!SUBENTRY 2 org.jkiss.dbeaver.model 4 0 2019-11-13 10:41:43.919
!MESSAGE I/O-Fehler: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!STACK 0
java.sql.SQLRecoverableException: I/O-Fehler: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
	at oracle.jdbc.driver.T4CPreparedStatement.executeForDescribe(T4CPreparedStatement.java:779)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3640)
	at oracle.jdbc.driver.T4CPreparedStatement.executeInternal(T4CPreparedStatement.java:1384)
	at oracle.jdbc.driver.OraclePreparedStatement.execute(OraclePreparedStatement.java:3752)
	at oracle.jdbc.driver.OraclePreparedStatementWrapper.execute(OraclePreparedStatementWrapper.java:1079)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCPreparedStatementImpl.execute(JDBCPreparedStatementImpl.java:260)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCPreparedStatementImpl.executeStatement(JDBCPreparedStatementImpl.java:204)
	at org.jkiss.dbeaver.model.impl.jdbc.cache.JDBCObjectCache.loadObjects(JDBCObjectCache.java:103)
	at org.jkiss.dbeaver.model.impl.jdbc.cache.JDBCObjectCache.getAllObjects(JDBCObjectCache.java:70)
	at org.jkiss.dbeaver.model.impl.AbstractObjectCache.getTypedObjects(AbstractObjectCache.java:80)
	at org.jkiss.dbeaver.ext.oracle.model.OracleSchema.getTables(OracleSchema.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.extractPropertyValue(DBNDatabaseNode.java:824)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.access$1(DBNDatabaseNode.java:805)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode$PropertyValueReader.run(DBNDatabaseNode.java:885)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode$PropertyValueReader.run(DBNDatabaseNode.java:1)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.loadTreeItems(DBNDatabaseNode.java:498)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.loadChildren(DBNDatabaseNode.java:421)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.getChildren(DBNDatabaseNode.java:206)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.getChildren(DBNDatabaseNode.java:1)
	at org.jkiss.dbeaver.model.navigator.DBNModel.findNodeByPath(DBNModel.java:310)
	at org.jkiss.dbeaver.model.navigator.DBNModel.findNodeByPath(DBNModel.java:335)
	at org.jkiss.dbeaver.model.navigator.DBNModel.findNodeByPath(DBNModel.java:335)
	at org.jkiss.dbeaver.model.navigator.DBNModel.findNodeByPath(DBNModel.java:335)
	at org.jkiss.dbeaver.model.navigator.DBNModel.getNodeByPath(DBNModel.java:281)
	at org.jkiss.dbeaver.ui.editors.DatabaseLazyEditorInput.initializeRealInput(DatabaseLazyEditorInput.java:223)
	at org.jkiss.dbeaver.ui.editors.ProgressEditorPart$InitNodeService.evaluate(ProgressEditorPart.java:133)
	at org.jkiss.dbeaver.ui.editors.ProgressEditorPart$InitNodeService.evaluate(ProgressEditorPart.java:1)
	at org.jkiss.dbeaver.ui.LoadingJob.run(LoadingJob.java:86)
	at org.jkiss.dbeaver.ui.LoadingJob.run(LoadingJob.java:71)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)
Caused by: java.io.IOException: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:51)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:113)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:79)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:50)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:463)
	at oracle.net.nt.TimeoutSocketChannel.write(TimeoutSocketChannel.java:207)
	at oracle.net.ns.NIOPacket.writeToSocketChannel(NIOPacket.java:308)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:182)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:133)
	at oracle.jdbc.driver.T4CMAREngineNIO.flush(T4CMAREngineNIO.java:741)
	at oracle.jdbc.driver.T4CMAREngineNIO.prepareForUnmarshall(T4CMAREngineNIO.java:754)
	at oracle.jdbc.driver.T4CMAREngineNIO.unmarshalUB1(T4CMAREngineNIO.java:427)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:394)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:253)
	at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:86)
	at oracle.jdbc.driver.T4CPreparedStatement.executeForDescribe(T4CPreparedStatement.java:765)
	... 37 more
!SUBENTRY 3 org.jkiss.dbeaver.model 4 0 2019-11-13 10:41:43.920
!MESSAGE Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!STACK 0
java.io.IOException: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:51)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:113)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:79)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:50)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:463)
	at oracle.net.nt.TimeoutSocketChannel.write(TimeoutSocketChannel.java:207)
	at oracle.net.ns.NIOPacket.writeToSocketChannel(NIOPacket.java:308)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:182)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:133)
	at oracle.jdbc.driver.T4CMAREngineNIO.flush(T4CMAREngineNIO.java:741)
	at oracle.jdbc.driver.T4CMAREngineNIO.prepareForUnmarshall(T4CMAREngineNIO.java:754)
	at oracle.jdbc.driver.T4CMAREngineNIO.unmarshalUB1(T4CMAREngineNIO.java:427)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:394)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:253)
	at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:86)
	at oracle.jdbc.driver.T4CPreparedStatement.executeForDescribe(T4CPreparedStatement.java:765)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3640)
	at oracle.jdbc.driver.T4CPreparedStatement.executeInternal(T4CPreparedStatement.java:1384)
	at oracle.jdbc.driver.OraclePreparedStatement.execute(OraclePreparedStatement.java:3752)
	at oracle.jdbc.driver.OraclePreparedStatementWrapper.execute(OraclePreparedStatementWrapper.java:1079)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCPreparedStatementImpl.execute(JDBCPreparedStatementImpl.java:260)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCPreparedStatementImpl.executeStatement(JDBCPreparedStatementImpl.java:204)
	at org.jkiss.dbeaver.model.impl.jdbc.cache.JDBCObjectCache.loadObjects(JDBCObjectCache.java:103)
	at org.jkiss.dbeaver.model.impl.jdbc.cache.JDBCObjectCache.getAllObjects(JDBCObjectCache.java:70)
	at org.jkiss.dbeaver.model.impl.AbstractObjectCache.getTypedObjects(AbstractObjectCache.java:80)
	at org.jkiss.dbeaver.ext.oracle.model.OracleSchema.getTables(OracleSchema.java:160)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.extractPropertyValue(DBNDatabaseNode.java:824)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.access$1(DBNDatabaseNode.java:805)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode$PropertyValueReader.run(DBNDatabaseNode.java:885)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode$PropertyValueReader.run(DBNDatabaseNode.java:1)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.loadTreeItems(DBNDatabaseNode.java:498)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.loadChildren(DBNDatabaseNode.java:421)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.getChildren(DBNDatabaseNode.java:206)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.getChildren(DBNDatabaseNode.java:1)
	at org.jkiss.dbeaver.model.navigator.DBNModel.findNodeByPath(DBNModel.java:310)
	at org.jkiss.dbeaver.model.navigator.DBNModel.findNodeByPath(DBNModel.java:335)
	at org.jkiss.dbeaver.model.navigator.DBNModel.findNodeByPath(DBNModel.java:335)
	at org.jkiss.dbeaver.model.navigator.DBNModel.findNodeByPath(DBNModel.java:335)
	at org.jkiss.dbeaver.model.navigator.DBNModel.getNodeByPath(DBNModel.java:281)
	at org.jkiss.dbeaver.ui.editors.DatabaseLazyEditorInput.initializeRealInput(DatabaseLazyEditorInput.java:223)
	at org.jkiss.dbeaver.ui.editors.ProgressEditorPart$InitNodeService.evaluate(ProgressEditorPart.java:133)
	at org.jkiss.dbeaver.ui.editors.ProgressEditorPart$InitNodeService.evaluate(ProgressEditorPart.java:1)
	at org.jkiss.dbeaver.ui.LoadingJob.run(LoadingJob.java:86)
	at org.jkiss.dbeaver.ui.LoadingJob.run(LoadingJob.java:71)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.eclipse.jface 2 0 2019-11-13 10:41:45.233
!MESSAGE Keybinding conflicts occurred.  They may interfere with normal accelerator operation.
!SUBENTRY 1 org.eclipse.jface 2 0 2019-11-13 10:41:45.233
!MESSAGE A conflict occurred for CTRL+D:
Binding(CTRL+D,
	ParameterizedCommand(Command(org.eclipse.ui.edit.text.delete.line,Delete Line,
		Delete a line of text,
		Category(org.eclipse.ui.category.textEditor,Text Editing,Text Editing Commands,true),
		org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@30f20d19,
		,,true),null),
	org.eclipse.ui.defaultAcceleratorConfiguration,
	org.eclipse.ui.textEditorScope,,,system)
Binding(CTRL+D,
	ParameterizedCommand(Command(org.jkiss.dbeaver.core.navigator.bookmark.add,Lesezeichen hinufügen,
		Lesezeichen hinufügen,
		Category(org.jkiss.dbeaver.core.navigator,Datenbanknavigator,Datenbanknavigatorbefehle,true),
		org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@3d120fd3,
		,,true),null),
	org.eclipse.ui.defaultAcceleratorConfiguration,
	org.jkiss.dbeaver.ui.context.navigator,,,system)

!ENTRY org.jkiss.dbeaver.model 2 0 2019-11-13 13:40:39.217
!MESSAGE Can't read execution warnings
!SUBENTRY 1 org.jkiss.dbeaver.model 2 0 2019-11-13 13:40:39.218
!MESSAGE SQL-Fehler [17008] [08003]: Getrennte Verbindung
!SUBENTRY 2 org.jkiss.dbeaver.model 2 0 2019-11-13 13:40:39.218
!MESSAGE Getrennte Verbindung
!STACK 0
java.sql.SQLRecoverableException: Getrennte Verbindung
	at oracle.jdbc.driver.OracleStatement.ensureOpen(OracleStatement.java:4114)
	at oracle.jdbc.driver.OracleStatement.getWarnings(OracleStatement.java:3113)
	at oracle.jdbc.driver.OracleStatementWrapper.getWarnings(OracleStatementWrapper.java:348)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.getWarnings(JDBCStatementImpl.java:582)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.getStatementWarnings(JDBCStatementImpl.java:612)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:524)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-13 13:40:39.232
!MESSAGE Can't close statement
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-13 13:40:39.232
!MESSAGE Getrennte Verbindung
!STACK 0
java.sql.SQLRecoverableException: Getrennte Verbindung
	at oracle.jdbc.driver.PhysicalConnection.needLine(PhysicalConnection.java:3305)
	at oracle.jdbc.driver.OracleStatement.closeOrCache(OracleStatement.java:1409)
	at oracle.jdbc.driver.OracleStatement.close(OracleStatement.java:1392)
	at oracle.jdbc.driver.OracleStatementWrapper.close(OracleStatementWrapper.java:119)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.close(JDBCStatementImpl.java:512)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.closeStatement(SQLQueryJob.java:797)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:530)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-13 13:40:39.428
!MESSAGE Operation failed. Retry count remains = 1
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-13 13:40:39.428
!MESSAGE SQL-Fehler [17002] [08006]: I/O-Fehler: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!SUBENTRY 2 org.jkiss.dbeaver.model 4 0 2019-11-13 13:40:39.428
!MESSAGE I/O-Fehler: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!STACK 0
java.sql.SQLRecoverableException: I/O-Fehler: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:738)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.doScrollExecuteCommon(OracleStatement.java:4699)
	at oracle.jdbc.driver.OracleStatement.doScrollStmtExecuteQuery(OracleStatement.java:4815)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1758)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)
Caused by: java.io.IOException: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:51)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:113)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:79)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:50)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:463)
	at oracle.net.nt.TimeoutSocketChannel.write(TimeoutSocketChannel.java:207)
	at oracle.net.ns.NIOPacket.writeToSocketChannel(NIOPacket.java:308)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:182)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:133)
	at oracle.jdbc.driver.T4CMAREngineNIO.flush(T4CMAREngineNIO.java:741)
	at oracle.jdbc.driver.T4CMAREngineNIO.prepareForUnmarshall(T4CMAREngineNIO.java:754)
	at oracle.jdbc.driver.T4CMAREngineNIO.unmarshalUB1(T4CMAREngineNIO.java:427)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:394)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	... 20 more
!SUBENTRY 3 org.jkiss.dbeaver.model 4 0 2019-11-13 13:40:39.429
!MESSAGE Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!STACK 0
java.io.IOException: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:51)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:113)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:79)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:50)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:463)
	at oracle.net.nt.TimeoutSocketChannel.write(TimeoutSocketChannel.java:207)
	at oracle.net.ns.NIOPacket.writeToSocketChannel(NIOPacket.java:308)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:182)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:133)
	at oracle.jdbc.driver.T4CMAREngineNIO.flush(T4CMAREngineNIO.java:741)
	at oracle.jdbc.driver.T4CMAREngineNIO.prepareForUnmarshall(T4CMAREngineNIO.java:754)
	at oracle.jdbc.driver.T4CMAREngineNIO.unmarshalUB1(T4CMAREngineNIO.java:427)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:394)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.doScrollExecuteCommon(OracleStatement.java:4699)
	at oracle.jdbc.driver.OracleStatement.doScrollStmtExecuteQuery(OracleStatement.java:4815)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1758)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-13 13:53:00.584
!MESSAGE SQL-Fehler [904] [42000]: ORA-00904: "EJJ"."EXT_JOIN_TYPE_UID": ungültige ID

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-13 13:53:00.584
!MESSAGE Error : 904, Position : 862, Sql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN (SELECT MAX(XJJ.JOIN_NR) AS max_join_nr FROM BSI_X_EXT_JOIN_JOIN xjj) ejj 
--	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
, OriginalSql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN (SELECT MAX(XJJ.JOIN_NR) AS max_join_nr FROM BSI_X_EXT_JOIN_JOIN xjj) ejj 
--	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
, Error Msg = ORA-00904: "EJJ"."EXT_JOIN_TYPE_UID": ungültige ID

!STACK 0
Error : 904, Position : 862, Sql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN (SELECT MAX(XJJ.JOIN_NR) AS max_join_nr FROM BSI_X_EXT_JOIN_JOIN xjj) ejj 
--	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
, OriginalSql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN (SELECT MAX(XJJ.JOIN_NR) AS max_join_nr FROM BSI_X_EXT_JOIN_JOIN xjj) ejj 
--	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
, Error Msg = ORA-00904: "EJJ"."EXT_JOIN_TYPE_UID": ungültige ID

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-13 13:54:56.761
!MESSAGE SQL-Fehler [904] [42000]: ORA-00904: "EJJ"."EXT_JOIN_NR": ungültige ID

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-13 13:54:56.761
!MESSAGE Error : 904, Position : 887, Sql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN (
		SELECT 
			MAX(XJJ.JOIN_NR) AS max_join_nr,
			xjj.EXT_JOIN_TYPE_UID
		FROM BSI_X_EXT_JOIN_JOIN xjj
		GROUP BY XJJ.EXT_JOIN_TYPE_UID) ejj
--	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
, OriginalSql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN (
		SELECT 
			MAX(XJJ.JOIN_NR) AS max_join_nr,
			xjj.EXT_JOIN_TYPE_UID
		FROM BSI_X_EXT_JOIN_JOIN xjj
		GROUP BY XJJ.EXT_JOIN_TYPE_UID) ejj
--	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
, Error Msg = ORA-00904: "EJJ"."EXT_JOIN_NR": ungültige ID

!STACK 0
Error : 904, Position : 887, Sql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN (
		SELECT 
			MAX(XJJ.JOIN_NR) AS max_join_nr,
			xjj.EXT_JOIN_TYPE_UID
		FROM BSI_X_EXT_JOIN_JOIN xjj
		GROUP BY XJJ.EXT_JOIN_TYPE_UID) ejj
--	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
, OriginalSql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN (
		SELECT 
			MAX(XJJ.JOIN_NR) AS max_join_nr,
			xjj.EXT_JOIN_TYPE_UID
		FROM BSI_X_EXT_JOIN_JOIN xjj
		GROUP BY XJJ.EXT_JOIN_TYPE_UID) ejj
--	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
, Error Msg = ORA-00904: "EJJ"."EXT_JOIN_NR": ungültige ID

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-13 14:00:20.069
!MESSAGE SQL-Fehler [905] [42000]: ORA-00905: Schlüsselwort fehlt

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-13 14:00:20.069
!MESSAGE Error : 905, Position : 1149, Sql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN (SELECT DISTINCT JOIN_NR, EXT_JOIN_TYPE_UID FROM BSI_X_EXT_JOIN_JOIN)
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
, OriginalSql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN (SELECT DISTINCT JOIN_NR, EXT_JOIN_TYPE_UID FROM BSI_X_EXT_JOIN_JOIN)
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
, Error Msg = ORA-00905: Schlüsselwort fehlt

!STACK 0
Error : 905, Position : 1149, Sql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN (SELECT DISTINCT JOIN_NR, EXT_JOIN_TYPE_UID FROM BSI_X_EXT_JOIN_JOIN)
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
, OriginalSql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN (SELECT DISTINCT JOIN_NR, EXT_JOIN_TYPE_UID FROM BSI_X_EXT_JOIN_JOIN)
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
, Error Msg = ORA-00905: Schlüsselwort fehlt

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-13 14:00:37.739
!MESSAGE SQL-Fehler [904] [42000]: ORA-00904: "EJJ"."EXT_JOIN_NR": ungültige ID

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-13 14:00:37.739
!MESSAGE Error : 904, Position : 815, Sql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN (SELECT DISTINCT JOIN_NR, EXT_JOIN_TYPE_UID FROM BSI_X_EXT_JOIN_JOIN) ejj 
--	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
, OriginalSql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN (SELECT DISTINCT JOIN_NR, EXT_JOIN_TYPE_UID FROM BSI_X_EXT_JOIN_JOIN) ejj 
--	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
, Error Msg = ORA-00904: "EJJ"."EXT_JOIN_NR": ungültige ID

!STACK 0
Error : 904, Position : 815, Sql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN (SELECT DISTINCT JOIN_NR, EXT_JOIN_TYPE_UID FROM BSI_X_EXT_JOIN_JOIN) ejj 
--	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
, OriginalSql = SELECT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN (SELECT DISTINCT JOIN_NR, EXT_JOIN_TYPE_UID FROM BSI_X_EXT_JOIN_JOIN) ejj 
--	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
, Error Msg = ORA-00904: "EJJ"."EXT_JOIN_NR": ungültige ID

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-13 14:08:45.121
!MESSAGE SQL-Fehler [1791] [42000]: ORA-01791: Kein mit SELECT ausgewählter Ausdruck

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-13 14:08:45.121
!MESSAGE Error : 1791, Position : 1323, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-01791: Kein mit SELECT ausgewählter Ausdruck

!STACK 0
Error : 1791, Position : 1323, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), '\t', ' ') description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	XCPL.SUBJECT,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-01791: Kein mit SELECT ausgewählter Ausdruck

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-13 14:47:07.685
!MESSAGE SQL-Fehler [932] [42000]: ORA-00932: Inkonsistente Datentypen: - erwartet, CLOB erhalten

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-13 14:47:07.685
!MESSAGE Error : 932, Position : 258, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), 
			chr(13), ' '), 
			chr(10), ' '), 
			chr(11), ' '),
			chr(9), ' '),
			CHR(32), ' '),
			description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), 
			chr(13), ' '), 
			chr(10), ' '), 
			chr(11), ' '),
			chr(9), ' '),
			CHR(32), ' '),
			description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00932: Inkonsistente Datentypen: - erwartet, CLOB erhalten

!STACK 0
Error : 932, Position : 258, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), 
			chr(13), ' '), 
			chr(10), ' '), 
			chr(11), ' '),
			chr(9), ' '),
			CHR(32), ' '),
			description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), 
			chr(13), ' '), 
			chr(10), ' '), 
			chr(11), ' '),
			chr(9), ' '),
			CHR(32), ' '),
			description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00932: Inkonsistente Datentypen: - erwartet, CLOB erhalten

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-13 14:47:39.134
!MESSAGE SQL-Fehler [932] [42000]: ORA-00932: Inkonsistente Datentypen: - erwartet, CLOB erhalten

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-13 14:47:39.134
!MESSAGE Error : 932, Position : 258, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), 
			chr(13), ' '), 
			chr(10), ' '), 
			chr(11), ' '),
			chr(9), ' '),
			CHR(32), ' '),
			description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), 
			chr(13), ' '), 
			chr(10), ' '), 
			chr(11), ' '),
			chr(9), ' '),
			CHR(32), ' '),
			description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00932: Inkonsistente Datentypen: - erwartet, CLOB erhalten

!STACK 0
Error : 932, Position : 258, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), 
			chr(13), ' '), 
			chr(10), ' '), 
			chr(11), ' '),
			chr(9), ' '),
			CHR(32), ' '),
			description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), 
			chr(13), ' '), 
			chr(10), ' '), 
			chr(11), ' '),
			chr(9), ' '),
			CHR(32), ' '),
			description,
	1 Closed,
	uc_cp_cat.text case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00932: Inkonsistente Datentypen: - erwartet, CLOB erhalten

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-13 15:25:59.178
!MESSAGE SQL-Fehler [923] [42000]: ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-13 15:25:59.178
!MESSAGE Error : 923, Position : 280, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), chr(10), ' '), chr(11), ' '), chr(9), ' '), chr(32), ' ') description,
	1 Closed,
	uc_cp_cat.text to_upper(case_reason),
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), chr(10), ' '), chr(11), ' '), chr(9), ' '), chr(32), ' ') description,
	1 Closed,
	uc_cp_cat.text to_upper(case_reason),
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

!STACK 0
Error : 923, Position : 280, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), chr(10), ' '), chr(11), ' '), chr(9), ' '), chr(32), ' ') description,
	1 Closed,
	uc_cp_cat.text to_upper(case_reason),
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), chr(10), ' '), chr(11), ' '), chr(9), ' '), chr(32), ' ') description,
	1 Closed,
	uc_cp_cat.text to_upper(case_reason),
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-13 15:26:26.124
!MESSAGE SQL-Fehler [904] [42000]: ORA-00904: "TO_UPPER": ungültige ID

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-13 15:26:26.124
!MESSAGE Error : 904, Position : 257, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), chr(10), ' '), chr(11), ' '), chr(9), ' '), chr(32), ' ') description,
	1 Closed,
	to_upper(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), chr(10), ' '), chr(11), ' '), chr(9), ' '), chr(32), ' ') description,
	1 Closed,
	to_upper(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00904: "TO_UPPER": ungültige ID

!STACK 0
Error : 904, Position : 257, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), chr(10), ' '), chr(11), ' '), chr(9), ' '), chr(32), ' ') description,
	1 Closed,
	to_upper(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), chr(10), ' '), chr(11), ' '), chr(9), ' '), chr(32), ' ') description,
	1 Closed,
	to_upper(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00904: "TO_UPPER": ungültige ID

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-13 15:26:45.116
!MESSAGE SQL-Fehler [904] [42000]: ORA-00904: "UCASE": ungültige ID

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-13 15:26:45.116
!MESSAGE Error : 904, Position : 257, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), chr(10), ' '), chr(11), ' '), chr(9), ' '), chr(32), ' ') description,
	1 Closed,
	UCASE(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), chr(10), ' '), chr(11), ' '), chr(9), ' '), chr(32), ' ') description,
	1 Closed,
	UCASE(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00904: "UCASE": ungültige ID

!STACK 0
Error : 904, Position : 257, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), chr(10), ' '), chr(11), ' '), chr(9), ' '), chr(32), ' ') description,
	1 Closed,
	UCASE(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), chr(10), ' '), chr(11), ' '), chr(9), ' '), chr(32), ' ') description,
	1 Closed,
	UCASE(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), chr(10), ' '), chr(11), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00904: "UCASE": ungültige ID

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-13 15:35:05.926
!MESSAGE SQL-Fehler [923] [42000]: ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-13 15:35:05.926
!MESSAGE Error : 923, Position : 490, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), 
		chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), 
		chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

!STACK 0
Error : 923, Position : 490, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), 
		chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), 
		chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-13 15:36:24.114
!MESSAGE SQL-Fehler [907] [42000]: ORA-00907: Rechte Klammer fehlt

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-13 15:36:24.114
!MESSAGE Error : 907, Position : 257, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), 
		chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
;
-- 44’763 ohne "INNER JOIN BSI_X_EXT_JOIN_JOIN ejj" usw.
-- 41’414
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), 
		chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
;
-- 44’763 ohne "INNER JOIN BSI_X_EXT_JOIN_JOIN ejj" usw.
-- 41’414
, Error Msg = ORA-00907: Rechte Klammer fehlt

!STACK 0
Error : 907, Position : 257, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), 
		chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
;
-- 44’763 ohne "INNER JOIN BSI_X_EXT_JOIN_JOIN ejj" usw.
-- 41’414
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), 
		chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
;
-- 44’763 ohne "INNER JOIN BSI_X_EXT_JOIN_JOIN ejj" usw.
-- 41’414
, Error Msg = ORA-00907: Rechte Klammer fehlt

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.eclipse.core.expressions 4 201 2019-11-13 15:45:53.797
!MESSAGE No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource
!STACK 1
org.eclipse.core.runtime.CoreException: No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource
	at org.eclipse.core.internal.expressions.TypeExtensionManager.getProperty(TypeExtensionManager.java:130)
	at org.eclipse.core.internal.expressions.TestExpression.evaluate(TestExpression.java:100)
	at org.eclipse.core.internal.expressions.CompositeExpression.evaluateAnd(CompositeExpression.java:55)
	at org.eclipse.core.internal.expressions.AndExpression.evaluate(AndExpression.java:34)
	at org.eclipse.ui.internal.dialogs.RegistryPageContributor.failsEnablement(RegistryPageContributor.java:309)
	at org.eclipse.ui.internal.dialogs.RegistryPageContributor.isApplicableTo(RegistryPageContributor.java:251)
	at org.eclipse.ui.internal.dialogs.PropertyPageContributorManager.getApplicableContributors(PropertyPageContributorManager.java:218)
	at org.eclipse.ui.dialogs.PreferencesUtil.hasPropertiesContributors(PreferencesUtil.java:305)
	at org.jkiss.dbeaver.ui.navigator.NavigatorUtils.lambda$0(NavigatorUtils.java:223)
	at org.eclipse.jface.action.MenuManager.fireAboutToShow(MenuManager.java:342)
	at org.eclipse.jface.action.MenuManager.handleAboutToShow(MenuManager.java:473)
	at org.eclipse.jface.action.MenuManager.access$1(MenuManager.java:468)
	at org.eclipse.jface.action.MenuManager$2.menuShown(MenuManager.java:500)
	at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:259)
	at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:89)
	at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4145)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1055)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1079)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1060)
	at org.eclipse.swt.widgets.Control.WM_INITMENUPOPUP(Control.java:5148)
	at org.eclipse.swt.widgets.Control.windowProc(Control.java:4797)
	at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:348)
	at org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1502)
	at org.eclipse.swt.widgets.Shell.windowProc(Shell.java:2162)
	at org.eclipse.swt.widgets.Display.windowProc(Display.java:4784)
	at org.eclipse.swt.internal.win32.OS.TrackPopupMenu(Native Method)
	at org.eclipse.swt.widgets.Menu._setVisible(Menu.java:253)
	at org.eclipse.swt.widgets.Display.runPopups(Display.java:3999)
	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3555)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$5.run(PartRenderingEngine.java:1173)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1062)
	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156)
	at org.eclipse.ui.internal.Workbench.lambda$3(Workbench.java:628)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:563)
	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:151)
	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:155)
	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:199)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:137)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:107)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:391)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:246)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:659)
	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:595)
	at org.eclipse.equinox.launcher.Main.run(Main.java:1501)
	at org.eclipse.equinox.launcher.Main.main(Main.java:1474)
!SUBENTRY 1 org.eclipse.core.expressions 4 201 2019-11-13 15:45:53.798
!MESSAGE No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource

!ENTRY org.jkiss.dbeaver.model 2 0 2019-11-13 15:46:11.856
!MESSAGE Datasource user 'org.jkiss.dbeaver.ui.editors.sql.SQLEditor@42bc8e89' already registered in datasource 'TEP'

!ENTRY org.eclipse.core.expressions 4 201 2019-11-13 16:04:22.965
!MESSAGE No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource
!STACK 1
org.eclipse.core.runtime.CoreException: No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource
	at org.eclipse.core.internal.expressions.TypeExtensionManager.getProperty(TypeExtensionManager.java:130)
	at org.eclipse.core.internal.expressions.TestExpression.evaluate(TestExpression.java:100)
	at org.eclipse.core.internal.expressions.CompositeExpression.evaluateAnd(CompositeExpression.java:55)
	at org.eclipse.core.internal.expressions.AndExpression.evaluate(AndExpression.java:34)
	at org.eclipse.ui.internal.dialogs.RegistryPageContributor.failsEnablement(RegistryPageContributor.java:309)
	at org.eclipse.ui.internal.dialogs.RegistryPageContributor.isApplicableTo(RegistryPageContributor.java:251)
	at org.eclipse.ui.internal.dialogs.PropertyPageContributorManager.getApplicableContributors(PropertyPageContributorManager.java:218)
	at org.eclipse.ui.dialogs.PreferencesUtil.hasPropertiesContributors(PreferencesUtil.java:305)
	at org.jkiss.dbeaver.ui.navigator.NavigatorUtils.lambda$0(NavigatorUtils.java:223)
	at org.eclipse.jface.action.MenuManager.fireAboutToShow(MenuManager.java:342)
	at org.eclipse.jface.action.MenuManager.handleAboutToShow(MenuManager.java:473)
	at org.eclipse.jface.action.MenuManager.access$1(MenuManager.java:468)
	at org.eclipse.jface.action.MenuManager$2.menuShown(MenuManager.java:500)
	at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:259)
	at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:89)
	at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4145)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1055)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1079)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1060)
	at org.eclipse.swt.widgets.Control.WM_INITMENUPOPUP(Control.java:5148)
	at org.eclipse.swt.widgets.Control.windowProc(Control.java:4797)
	at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:348)
	at org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1502)
	at org.eclipse.swt.widgets.Shell.windowProc(Shell.java:2162)
	at org.eclipse.swt.widgets.Display.windowProc(Display.java:4784)
	at org.eclipse.swt.internal.win32.OS.TrackPopupMenu(Native Method)
	at org.eclipse.swt.widgets.Menu._setVisible(Menu.java:253)
	at org.eclipse.swt.widgets.Display.runPopups(Display.java:3999)
	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3555)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$5.run(PartRenderingEngine.java:1173)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1062)
	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156)
	at org.eclipse.ui.internal.Workbench.lambda$3(Workbench.java:628)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:563)
	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:151)
	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:155)
	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:199)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:137)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:107)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:391)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:246)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:659)
	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:595)
	at org.eclipse.equinox.launcher.Main.run(Main.java:1501)
	at org.eclipse.equinox.launcher.Main.main(Main.java:1474)
!SUBENTRY 1 org.eclipse.core.expressions 4 201 2019-11-13 16:04:22.966
!MESSAGE No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource

!ENTRY org.eclipse.core.expressions 4 201 2019-11-13 16:04:57.346
!MESSAGE No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource
!STACK 1
org.eclipse.core.runtime.CoreException: No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource
	at org.eclipse.core.internal.expressions.TypeExtensionManager.getProperty(TypeExtensionManager.java:130)
	at org.eclipse.core.internal.expressions.TestExpression.evaluate(TestExpression.java:100)
	at org.eclipse.core.internal.expressions.CompositeExpression.evaluateAnd(CompositeExpression.java:55)
	at org.eclipse.core.internal.expressions.AndExpression.evaluate(AndExpression.java:34)
	at org.eclipse.ui.internal.dialogs.RegistryPageContributor.failsEnablement(RegistryPageContributor.java:309)
	at org.eclipse.ui.internal.dialogs.RegistryPageContributor.isApplicableTo(RegistryPageContributor.java:251)
	at org.eclipse.ui.internal.dialogs.PropertyPageContributorManager.getApplicableContributors(PropertyPageContributorManager.java:218)
	at org.eclipse.ui.dialogs.PreferencesUtil.hasPropertiesContributors(PreferencesUtil.java:305)
	at org.jkiss.dbeaver.ui.navigator.NavigatorUtils.lambda$0(NavigatorUtils.java:223)
	at org.eclipse.jface.action.MenuManager.fireAboutToShow(MenuManager.java:342)
	at org.eclipse.jface.action.MenuManager.handleAboutToShow(MenuManager.java:473)
	at org.eclipse.jface.action.MenuManager.access$1(MenuManager.java:468)
	at org.eclipse.jface.action.MenuManager$2.menuShown(MenuManager.java:500)
	at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:259)
	at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:89)
	at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4145)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1055)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1079)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1060)
	at org.eclipse.swt.widgets.Control.WM_INITMENUPOPUP(Control.java:5148)
	at org.eclipse.swt.widgets.Control.windowProc(Control.java:4797)
	at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:348)
	at org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1502)
	at org.eclipse.swt.widgets.Shell.windowProc(Shell.java:2162)
	at org.eclipse.swt.widgets.Display.windowProc(Display.java:4784)
	at org.eclipse.swt.internal.win32.OS.TrackPopupMenu(Native Method)
	at org.eclipse.swt.widgets.Menu._setVisible(Menu.java:253)
	at org.eclipse.swt.widgets.Display.runPopups(Display.java:3999)
	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3555)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$5.run(PartRenderingEngine.java:1173)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1062)
	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156)
	at org.eclipse.ui.internal.Workbench.lambda$3(Workbench.java:628)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:563)
	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:151)
	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:155)
	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:199)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:137)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:107)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:391)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:246)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:659)
	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:595)
	at org.eclipse.equinox.launcher.Main.run(Main.java:1501)
	at org.eclipse.equinox.launcher.Main.main(Main.java:1474)
!SUBENTRY 1 org.eclipse.core.expressions 4 201 2019-11-13 16:04:57.347
!MESSAGE No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource

!ENTRY org.eclipse.ui.workbench 4 0 2019-11-13 16:05:17.212
!MESSAGE Invalid thread access
!STACK 0
org.eclipse.swt.SWTException: Invalid thread access
	at org.eclipse.swt.SWT.error(SWT.java:4595)
	at org.eclipse.swt.SWT.error(SWT.java:4510)
	at org.eclipse.swt.SWT.error(SWT.java:4481)
	at org.eclipse.swt.widgets.Widget.error(Widget.java:451)
	at org.eclipse.swt.widgets.Widget.checkWidget(Widget.java:369)
	at org.eclipse.swt.widgets.Decorations.getText(Decorations.java:683)
	at org.eclipse.ui.internal.WorkbenchWindowConfigurer.getTitle(WorkbenchWindowConfigurer.java:271)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor.recomputeTitle(IDEWorkbenchWindowAdvisor.java:435)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor.access$2(IDEWorkbenchWindowAdvisor.java:433)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor$1.propertyChanged(IDEWorkbenchWindowAdvisor.java:116)
	at org.eclipse.ui.part.WorkbenchPart.firePropertyChange(WorkbenchPart.java:122)
	at org.eclipse.ui.texteditor.AbstractTextEditor.firePropertyChange(AbstractTextEditor.java:6345)
	at org.eclipse.ui.part.WorkbenchPart.setTitle(WorkbenchPart.java:288)
	at org.eclipse.ui.part.EditorPart.setDefaultTitle(EditorPart.java:288)
	at org.eclipse.ui.part.WorkbenchPart.setPartName(WorkbenchPart.java:368)
	at org.eclipse.ui.part.EditorPart.setPartName(EditorPart.java:263)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor.setDataSourceContainer(SQLEditor.java:323)
	at org.jkiss.dbeaver.ui.perspective.DataSourceManagementToolbar$4.run(DataSourceManagementToolbar.java:627)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 2 0 2019-11-14 15:31:32.146
!MESSAGE Can't read execution warnings
!SUBENTRY 1 org.jkiss.dbeaver.model 2 0 2019-11-14 15:31:32.146
!MESSAGE SQL-Fehler [17008] [08003]: Getrennte Verbindung
!SUBENTRY 2 org.jkiss.dbeaver.model 2 0 2019-11-14 15:31:32.146
!MESSAGE Getrennte Verbindung
!STACK 0
java.sql.SQLRecoverableException: Getrennte Verbindung
	at oracle.jdbc.driver.OracleStatement.ensureOpen(OracleStatement.java:4114)
	at oracle.jdbc.driver.OracleStatement.getWarnings(OracleStatement.java:3113)
	at oracle.jdbc.driver.OracleStatementWrapper.getWarnings(OracleStatementWrapper.java:348)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.getWarnings(JDBCStatementImpl.java:582)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.getStatementWarnings(JDBCStatementImpl.java:612)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:524)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 15:31:32.159
!MESSAGE Can't close statement
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 15:31:32.159
!MESSAGE Getrennte Verbindung
!STACK 0
java.sql.SQLRecoverableException: Getrennte Verbindung
	at oracle.jdbc.driver.PhysicalConnection.needLine(PhysicalConnection.java:3305)
	at oracle.jdbc.driver.OracleStatement.closeOrCache(OracleStatement.java:1409)
	at oracle.jdbc.driver.OracleStatement.close(OracleStatement.java:1392)
	at oracle.jdbc.driver.OracleStatementWrapper.close(OracleStatementWrapper.java:119)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.close(JDBCStatementImpl.java:512)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.closeStatement(SQLQueryJob.java:797)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:530)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 15:31:32.354
!MESSAGE Operation failed. Retry count remains = 1
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 15:31:32.354
!MESSAGE SQL-Fehler [17002] [08006]: I/O-Fehler: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!SUBENTRY 2 org.jkiss.dbeaver.model 4 0 2019-11-14 15:31:32.354
!MESSAGE I/O-Fehler: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!STACK 0
java.sql.SQLRecoverableException: I/O-Fehler: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
	at oracle.jdbc.driver.T4CStatement.executeForRows(T4CStatement.java:909)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1136)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)
Caused by: java.io.IOException: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:51)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:113)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:79)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:50)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:463)
	at oracle.net.nt.TimeoutSocketChannel.write(TimeoutSocketChannel.java:207)
	at oracle.net.ns.NIOPacket.writeToSocketChannel(NIOPacket.java:308)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:182)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:133)
	at oracle.jdbc.driver.T4CMAREngineNIO.flush(T4CMAREngineNIO.java:741)
	at oracle.jdbc.driver.T4CMAREngineNIO.prepareForUnmarshall(T4CMAREngineNIO.java:754)
	at oracle.jdbc.driver.T4CMAREngineNIO.unmarshalUB1(T4CMAREngineNIO.java:427)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:394)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForRows(T4CStatement.java:887)
	... 17 more
!SUBENTRY 3 org.jkiss.dbeaver.model 4 0 2019-11-14 15:31:32.354
!MESSAGE Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!STACK 0
java.io.IOException: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:51)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:113)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:79)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:50)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:463)
	at oracle.net.nt.TimeoutSocketChannel.write(TimeoutSocketChannel.java:207)
	at oracle.net.ns.NIOPacket.writeToSocketChannel(NIOPacket.java:308)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:182)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:133)
	at oracle.jdbc.driver.T4CMAREngineNIO.flush(T4CMAREngineNIO.java:741)
	at oracle.jdbc.driver.T4CMAREngineNIO.prepareForUnmarshall(T4CMAREngineNIO.java:754)
	at oracle.jdbc.driver.T4CMAREngineNIO.unmarshalUB1(T4CMAREngineNIO.java:427)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:394)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForRows(T4CStatement.java:887)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1136)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 15:31:32.440
!MESSAGE SQL-Fehler [900] [42000]: ORA-00900: Ungültige SQL-Anweisung

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 15:31:32.440
!MESSAGE Error : 900, Position : 0, Sql = vTextLine := REPLACE('"' || r.ClosedDate || '","'
				|| r.description || '","'
				|| r.Closed || '","'
				|| r.case_reason || '","'
				|| r.Status || '","'
				|| r.subject || '","'
				|| r.Company || '","'
				|| r.LCM_Complaint_Number || '","'
				|| r.LCM_Customer_NUMBER || '","'
				|| r.Created_in_LCM || '","'
				|| r.Owner_lcm
				|| '"','""')||cr, OriginalSql = vTextLine := REPLACE('"' || r.ClosedDate || '","'
				|| r.description || '","'
				|| r.Closed || '","'
				|| r.case_reason || '","'
				|| r.Status || '","'
				|| r.subject || '","'
				|| r.Company || '","'
				|| r.LCM_Complaint_Number || '","'
				|| r.LCM_Customer_NUMBER || '","'
				|| r.Created_in_LCM || '","'
				|| r.Owner_lcm
				|| '"','""')||cr, Error Msg = ORA-00900: Ungültige SQL-Anweisung

!STACK 0
Error : 900, Position : 0, Sql = vTextLine := REPLACE('"' || r.ClosedDate || '","'
				|| r.description || '","'
				|| r.Closed || '","'
				|| r.case_reason || '","'
				|| r.Status || '","'
				|| r.subject || '","'
				|| r.Company || '","'
				|| r.LCM_Complaint_Number || '","'
				|| r.LCM_Customer_NUMBER || '","'
				|| r.Created_in_LCM || '","'
				|| r.Owner_lcm
				|| '"','""')||cr, OriginalSql = vTextLine := REPLACE('"' || r.ClosedDate || '","'
				|| r.description || '","'
				|| r.Closed || '","'
				|| r.case_reason || '","'
				|| r.Status || '","'
				|| r.subject || '","'
				|| r.Company || '","'
				|| r.LCM_Complaint_Number || '","'
				|| r.LCM_Customer_NUMBER || '","'
				|| r.Created_in_LCM || '","'
				|| r.Owner_lcm
				|| '"','""')||cr, Error Msg = ORA-00900: Ungültige SQL-Anweisung

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForRows(T4CStatement.java:887)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1136)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 15:32:24.445
!MESSAGE SQL-Fehler [1013] [72000]: ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 15:32:24.445
!MESSAGE Error : 1013, Position : 113, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert

!STACK 0
Error : 1013, Position : 113, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
	XCPL.COMPANY_NR Company,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm,
	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 17:29:12.586
!MESSAGE Can't close statement
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 17:29:12.586
!MESSAGE Getrennte Verbindung
!STACK 0
java.sql.SQLRecoverableException: Getrennte Verbindung
	at oracle.jdbc.driver.PhysicalConnection.needLine(PhysicalConnection.java:3305)
	at oracle.jdbc.driver.OracleStatement.closeOrCache(OracleStatement.java:1409)
	at oracle.jdbc.driver.OracleStatement.close(OracleStatement.java:1392)
	at oracle.jdbc.driver.OracleStatementWrapper.close(OracleStatementWrapper.java:119)
	at oracle.jdbc.driver.OraclePreparedStatementWrapper.close(OraclePreparedStatementWrapper.java:96)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.close(JDBCStatementImpl.java:512)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCPreparedStatementImpl.close(JDBCPreparedStatementImpl.java:97)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCUtils.queryString(JDBCUtils.java:653)
	at org.jkiss.dbeaver.ext.oracle.model.OracleTableBase.queryTableComment(OracleTableBase.java:163)
	at org.jkiss.dbeaver.ext.oracle.model.OracleTableBase.getComment(OracleTableBase.java:151)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.jkiss.dbeaver.runtime.properties.ObjectPropertyDescriptor.readValue(ObjectPropertyDescriptor.java:279)
	at org.jkiss.dbeaver.runtime.properties.PropertySourceAbstract.getPropertyValue(PropertySourceAbstract.java:230)
	at org.jkiss.dbeaver.runtime.properties.PropertySourceAbstract.getPropertyValue(PropertySourceAbstract.java:179)
	at org.jkiss.dbeaver.ui.editors.entity.properties.TabbedFolderPageForm$5.evaluate(TabbedFolderPageForm.java:374)
	at org.jkiss.dbeaver.ui.editors.entity.properties.TabbedFolderPageForm$5.evaluate(TabbedFolderPageForm.java:1)
	at org.jkiss.dbeaver.ui.LoadingJob.run(LoadingJob.java:86)
	at org.jkiss.dbeaver.ui.LoadingJob.run(LoadingJob.java:71)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 2 0 2019-11-14 17:29:12.600
!MESSAGE Can't fetch table 'BSI_X_COMPLAINT_SOLUTION' comment
!SUBENTRY 1 org.jkiss.dbeaver.model 2 0 2019-11-14 17:29:12.600
!MESSAGE I/O-Fehler: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!SUBENTRY 2 org.jkiss.dbeaver.model 2 0 2019-11-14 17:29:12.600
!MESSAGE Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!STACK 0
java.io.IOException: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:51)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:113)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:79)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:50)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:463)
	at oracle.net.nt.TimeoutSocketChannel.write(TimeoutSocketChannel.java:207)
	at oracle.net.ns.NIOPacket.writeToSocketChannel(NIOPacket.java:308)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:182)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:133)
	at oracle.jdbc.driver.T4CMAREngineNIO.flush(T4CMAREngineNIO.java:741)
	at oracle.jdbc.driver.T4CMAREngineNIO.prepareForUnmarshall(T4CMAREngineNIO.java:754)
	at oracle.jdbc.driver.T4CMAREngineNIO.unmarshalUB1(T4CMAREngineNIO.java:427)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:394)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:253)
	at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:86)
	at oracle.jdbc.driver.T4CPreparedStatement.executeForDescribe(T4CPreparedStatement.java:765)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3640)
	at oracle.jdbc.driver.T4CPreparedStatement.executeInternal(T4CPreparedStatement.java:1384)
	at oracle.jdbc.driver.OraclePreparedStatement.executeQuery(OraclePreparedStatement.java:3687)
	at oracle.jdbc.driver.OraclePreparedStatementWrapper.executeQuery(OraclePreparedStatementWrapper.java:1165)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCPreparedStatementImpl.executeQuery(JDBCPreparedStatementImpl.java:232)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCUtils.queryString(JDBCUtils.java:646)
	at org.jkiss.dbeaver.ext.oracle.model.OracleTableBase.queryTableComment(OracleTableBase.java:163)
	at org.jkiss.dbeaver.ext.oracle.model.OracleTableBase.getComment(OracleTableBase.java:151)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.jkiss.dbeaver.runtime.properties.ObjectPropertyDescriptor.readValue(ObjectPropertyDescriptor.java:279)
	at org.jkiss.dbeaver.runtime.properties.PropertySourceAbstract.getPropertyValue(PropertySourceAbstract.java:230)
	at org.jkiss.dbeaver.runtime.properties.PropertySourceAbstract.getPropertyValue(PropertySourceAbstract.java:179)
	at org.jkiss.dbeaver.ui.editors.entity.properties.TabbedFolderPageForm$5.evaluate(TabbedFolderPageForm.java:374)
	at org.jkiss.dbeaver.ui.editors.entity.properties.TabbedFolderPageForm$5.evaluate(TabbedFolderPageForm.java:1)
	at org.jkiss.dbeaver.ui.LoadingJob.run(LoadingJob.java:86)
	at org.jkiss.dbeaver.ui.LoadingJob.run(LoadingJob.java:71)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 2 0 2019-11-14 17:29:12.692
!MESSAGE Can't fetch table 'BSI_X_COMPLAINT_SOLUTION' comment
!SUBENTRY 1 org.jkiss.dbeaver.model 2 0 2019-11-14 17:29:12.692
!MESSAGE Getrennte Verbindung
!STACK 0
java.sql.SQLRecoverableException: Getrennte Verbindung
	at oracle.jdbc.driver.PhysicalConnection.prepareStatementInternal(PhysicalConnection.java:1746)
	at oracle.jdbc.driver.PhysicalConnection.prepareStatement(PhysicalConnection.java:1721)
	at oracle.jdbc.driver.PhysicalConnection.prepareStatement(PhysicalConnection.java:1648)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:248)
	at org.jkiss.dbeaver.model.impl.jdbc.JDBCUtils.queryString(JDBCUtils.java:640)
	at org.jkiss.dbeaver.ext.oracle.model.OracleTableBase.queryTableComment(OracleTableBase.java:163)
	at org.jkiss.dbeaver.ext.oracle.model.OracleTableBase.getComment(OracleTableBase.java:151)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.jkiss.dbeaver.runtime.properties.ObjectPropertyDescriptor.readValue(ObjectPropertyDescriptor.java:279)
	at org.jkiss.dbeaver.runtime.properties.PropertySourceAbstract$PropertySheetLoadService.evaluate(PropertySourceAbstract.java:353)
	at org.jkiss.dbeaver.runtime.properties.PropertySourceAbstract$PropertySheetLoadService.evaluate(PropertySourceAbstract.java:1)
	at org.jkiss.dbeaver.ui.LoadingJob.run(LoadingJob.java:86)
	at org.jkiss.dbeaver.ui.LoadingJob.run(LoadingJob.java:71)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 17:29:12.951
!MESSAGE Operation failed. Retry count remains = 1
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 17:29:12.951
!MESSAGE SQL-Fehler [17008] [08003]: Getrennte Verbindung
!SUBENTRY 2 org.jkiss.dbeaver.model 4 0 2019-11-14 17:29:12.951
!MESSAGE Getrennte Verbindung
!STACK 0
java.sql.SQLRecoverableException: Getrennte Verbindung
	at oracle.jdbc.driver.PhysicalConnection.prepareStatementInternal(PhysicalConnection.java:1746)
	at oracle.jdbc.driver.PhysicalConnection.prepareStatement(PhysicalConnection.java:1721)
	at oracle.jdbc.driver.PhysicalConnection.prepareStatement(PhysicalConnection.java:1648)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCConnectionImpl.prepareStatement(JDBCConnectionImpl.java:248)
	at org.jkiss.dbeaver.ext.oracle.model.OracleSchema$TableCache.prepareChildrenStatement(OracleSchema.java:473)
	at org.jkiss.dbeaver.ext.oracle.model.OracleSchema$TableCache.prepareChildrenStatement(OracleSchema.java:1)
	at org.jkiss.dbeaver.model.impl.jdbc.cache.JDBCStructCache.loadChildren(JDBCStructCache.java:97)
	at org.jkiss.dbeaver.model.impl.jdbc.cache.JDBCStructCache.getChildren(JDBCStructCache.java:222)
	at org.jkiss.dbeaver.ext.oracle.model.OracleTableBase.getAttributes(OracleTableBase.java:217)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.extractPropertyValue(DBNDatabaseNode.java:824)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.access$1(DBNDatabaseNode.java:805)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode$PropertyValueReader.run(DBNDatabaseNode.java:885)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode$PropertyValueReader.run(DBNDatabaseNode.java:1)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.loadTreeItems(DBNDatabaseNode.java:498)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.loadChildren(DBNDatabaseNode.java:421)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.getChildren(DBNDatabaseNode.java:206)
	at org.jkiss.dbeaver.model.navigator.DBNDatabaseNode.getChildren(DBNDatabaseNode.java:1)
	at org.jkiss.dbeaver.ui.navigator.NavigatorUtils.getNodeChildrenFiltered(NavigatorUtils.java:593)
	at org.jkiss.dbeaver.ui.controls.itemlist.ItemListControl$ItemLoadService.evaluate(ItemListControl.java:219)
	at org.jkiss.dbeaver.ui.controls.itemlist.ItemListControl$ItemLoadService.evaluate(ItemListControl.java:1)
	at org.jkiss.dbeaver.ui.LoadingJob.run(LoadingJob.java:86)
	at org.jkiss.dbeaver.ui.LoadingJob.run(LoadingJob.java:71)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 21:47:05.402
!MESSAGE SQL-Fehler [904] [42000]: ORA-00904: "PRS_RESPONSIBLE"."LAST_NAME": ungültige ID

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 21:47:05.402
!MESSAGE Error : 904, Position : 1206, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	uc_caseType.TEXT case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	uc_caseType.TEXT case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR, Error Msg = ORA-00904: "PRS_RESPONSIBLE"."LAST_NAME": ungültige ID

!STACK 0
Error : 904, Position : 1206, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	uc_caseType.TEXT case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	uc_caseType.TEXT case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Customer_NUMBER,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	INNER JOIN BSI_X_CASE_COMPLAINT mcc
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR, Error Msg = ORA-00904: "PRS_RESPONSIBLE"."LAST_NAME": ungültige ID

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 22:17:19.383
!MESSAGE SQL-Fehler [904] [42000]: ORA-00904: "CSE"."PROCESS_UID": ungültige ID

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 22:17:19.383
!MESSAGE Error : 904, Position : 1622, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	CASE WHEN uc_caseType.TEXT IS NOT NULL THEN		
		uc_caseType.TEXT 
	ELSE ''
	END case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
		INNER JOIN (
			SELECT max(CASE_NR) max_case_nr FROM BSI_CASE 
		) CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	CASE WHEN uc_caseType.TEXT IS NOT NULL THEN		
		uc_caseType.TEXT 
	ELSE ''
	END case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
		INNER JOIN (
			SELECT max(CASE_NR) max_case_nr FROM BSI_CASE 
		) CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00904: "CSE"."PROCESS_UID": ungültige ID

!STACK 0
Error : 904, Position : 1622, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	CASE WHEN uc_caseType.TEXT IS NOT NULL THEN		
		uc_caseType.TEXT 
	ELSE ''
	END case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
		INNER JOIN (
			SELECT max(CASE_NR) max_case_nr FROM BSI_CASE 
		) CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	CASE WHEN uc_caseType.TEXT IS NOT NULL THEN		
		uc_caseType.TEXT 
	ELSE ''
	END case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
		INNER JOIN (
			SELECT max(CASE_NR) max_case_nr FROM BSI_CASE 
		) CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00904: "CSE"."PROCESS_UID": ungültige ID

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 22:17:44.120
!MESSAGE SQL-Fehler [904] [42000]: ORA-00904: "CSE"."PROCESS_UID": ungültige ID

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 22:17:44.120
!MESSAGE Error : 904, Position : 1622, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	CASE WHEN uc_caseType.TEXT IS NOT NULL THEN		
		uc_caseType.TEXT 
	ELSE ''
	END case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
		INNER JOIN (
			SELECT max(CASE_NR) max_case_nr FROM BSI_CASE 
		) CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.max_case_nr = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	CASE WHEN uc_caseType.TEXT IS NOT NULL THEN		
		uc_caseType.TEXT 
	ELSE ''
	END case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
		INNER JOIN (
			SELECT max(CASE_NR) max_case_nr FROM BSI_CASE 
		) CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.max_case_nr = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00904: "CSE"."PROCESS_UID": ungültige ID

!STACK 0
Error : 904, Position : 1622, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	CASE WHEN uc_caseType.TEXT IS NOT NULL THEN		
		uc_caseType.TEXT 
	ELSE ''
	END case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
		INNER JOIN (
			SELECT max(CASE_NR) max_case_nr FROM BSI_CASE 
		) CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.max_case_nr = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	CASE WHEN uc_caseType.TEXT IS NOT NULL THEN		
		uc_caseType.TEXT 
	ELSE ''
	END case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
		INNER JOIN (
			SELECT max(CASE_NR) max_case_nr FROM BSI_CASE 
		) CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.max_case_nr = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00904: "CSE"."PROCESS_UID": ungültige ID

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 22:25:30.870
!MESSAGE SQL-Fehler [904] [42000]: ORA-00904: "XCPL"."COMPANY_NR": ungültige ID

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 22:25:30.870
!MESSAGE Error : 904, Position : 1616, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	uc_caseType.TEXT case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
		AND cse.X_COMPANY_NR = XCPL.COMPANY_NR
--		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	uc_caseType.TEXT case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
		AND cse.X_COMPANY_NR = XCPL.COMPANY_NR
--		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00904: "XCPL"."COMPANY_NR": ungültige ID

!STACK 0
Error : 904, Position : 1616, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	uc_caseType.TEXT case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
		AND cse.X_COMPANY_NR = XCPL.COMPANY_NR
--		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	uc_caseType.TEXT case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
		AND cse.X_COMPANY_NR = XCPL.COMPANY_NR
--		AND CSE.STATUS_UID IN (75959)
	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00904: "XCPL"."COMPANY_NR": ungültige ID

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 22:36:13.693
!MESSAGE SQL-Fehler [904] [42000]: ORA-00904: "CSE"."PROCESS_UID": ungültige ID

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 22:36:13.693
!MESSAGE Error : 904, Position : 163, Sql = SELECT * FROM (
	SELECT cse.PROCESS_UID
	FROM BSI_CASE CSE
		INNER JOIN BSI_X_CASE_COMPLAINT mcc
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
	WHERE cse.COMPLAINT_NR = 3433641465
) WHERE rownum = 1
, OriginalSql = SELECT * FROM (
	SELECT cse.PROCESS_UID
	FROM BSI_CASE CSE
		INNER JOIN BSI_X_CASE_COMPLAINT mcc
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
	WHERE cse.COMPLAINT_NR = 3433641465
) WHERE rownum = 1
, Error Msg = ORA-00904: "CSE"."PROCESS_UID": ungültige ID

!STACK 0
Error : 904, Position : 163, Sql = SELECT * FROM (
	SELECT cse.PROCESS_UID
	FROM BSI_CASE CSE
		INNER JOIN BSI_X_CASE_COMPLAINT mcc
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
	WHERE cse.COMPLAINT_NR = 3433641465
) WHERE rownum = 1
, OriginalSql = SELECT * FROM (
	SELECT cse.PROCESS_UID
	FROM BSI_CASE CSE
		INNER JOIN BSI_X_CASE_COMPLAINT mcc
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
	WHERE cse.COMPLAINT_NR = 3433641465
) WHERE rownum = 1
, Error Msg = ORA-00904: "CSE"."PROCESS_UID": ungültige ID

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 22:37:24.772
!MESSAGE SQL-Fehler [904] [42000]: ORA-00904: "CSE"."COMPLAINT_NR": ungültige ID

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 22:37:24.772
!MESSAGE Error : 904, Position : 285, Sql = SELECT * FROM (
	SELECT cse.PROCESS_UID
	FROM BSI_CASE CSE
		INNER JOIN BSI_X_CASE_COMPLAINT mcc ON CSE.CASE_NR = MCC.CASE_NR
		INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		AND CSE.STATUS_UID IN (75959)
	WHERE cse.COMPLAINT_NR = 3433641465
) WHERE rownum = 1
, OriginalSql = SELECT * FROM (
	SELECT cse.PROCESS_UID
	FROM BSI_CASE CSE
		INNER JOIN BSI_X_CASE_COMPLAINT mcc ON CSE.CASE_NR = MCC.CASE_NR
		INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		AND CSE.STATUS_UID IN (75959)
	WHERE cse.COMPLAINT_NR = 3433641465
) WHERE rownum = 1
, Error Msg = ORA-00904: "CSE"."COMPLAINT_NR": ungültige ID

!STACK 0
Error : 904, Position : 285, Sql = SELECT * FROM (
	SELECT cse.PROCESS_UID
	FROM BSI_CASE CSE
		INNER JOIN BSI_X_CASE_COMPLAINT mcc ON CSE.CASE_NR = MCC.CASE_NR
		INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		AND CSE.STATUS_UID IN (75959)
	WHERE cse.COMPLAINT_NR = 3433641465
) WHERE rownum = 1
, OriginalSql = SELECT * FROM (
	SELECT cse.PROCESS_UID
	FROM BSI_CASE CSE
		INNER JOIN BSI_X_CASE_COMPLAINT mcc ON CSE.CASE_NR = MCC.CASE_NR
		INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		AND CSE.STATUS_UID IN (75959)
	WHERE cse.COMPLAINT_NR = 3433641465
) WHERE rownum = 1
, Error Msg = ORA-00904: "CSE"."COMPLAINT_NR": ungültige ID

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.doScrollExecuteCommon(OracleStatement.java:4699)
	at oracle.jdbc.driver.OracleStatement.doScrollStmtExecuteQuery(OracleStatement.java:4815)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1758)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 22:43:17.299
!MESSAGE SQL-Fehler [936] [42000]: ORA-00936: Ausdruck fehlt

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 22:43:17.299
!MESSAGE Error : 936, Position : 109, Sql = SELECT * FROM (
	SELECT 
--		cse.PROCESS_UID
		sum(count(cse.CASE_NR)) AS Anzahl,
--		MCC.COMPLAINT_NR
	FROM BSI_CASE CSE
		INNER JOIN BSI_X_CASE_COMPLAINT mcc ON CSE.CASE_NR = MCC.CASE_NR
--		INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		AND CSE.STATUS_UID IN (75959)
--	WHERE MCC.COMPLAINT_NR = 3433641465
--	GROUP BY MCC.COMPLAINT_NR
	HAVING count(cse.CASE_NR) > 1
) WHERE rownum = 1
, OriginalSql = SELECT * FROM (
	SELECT 
--		cse.PROCESS_UID
		sum(count(cse.CASE_NR)) AS Anzahl,
--		MCC.COMPLAINT_NR
	FROM BSI_CASE CSE
		INNER JOIN BSI_X_CASE_COMPLAINT mcc ON CSE.CASE_NR = MCC.CASE_NR
--		INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		AND CSE.STATUS_UID IN (75959)
--	WHERE MCC.COMPLAINT_NR = 3433641465
--	GROUP BY MCC.COMPLAINT_NR
	HAVING count(cse.CASE_NR) > 1
) WHERE rownum = 1
, Error Msg = ORA-00936: Ausdruck fehlt

!STACK 0
Error : 936, Position : 109, Sql = SELECT * FROM (
	SELECT 
--		cse.PROCESS_UID
		sum(count(cse.CASE_NR)) AS Anzahl,
--		MCC.COMPLAINT_NR
	FROM BSI_CASE CSE
		INNER JOIN BSI_X_CASE_COMPLAINT mcc ON CSE.CASE_NR = MCC.CASE_NR
--		INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		AND CSE.STATUS_UID IN (75959)
--	WHERE MCC.COMPLAINT_NR = 3433641465
--	GROUP BY MCC.COMPLAINT_NR
	HAVING count(cse.CASE_NR) > 1
) WHERE rownum = 1
, OriginalSql = SELECT * FROM (
	SELECT 
--		cse.PROCESS_UID
		sum(count(cse.CASE_NR)) AS Anzahl,
--		MCC.COMPLAINT_NR
	FROM BSI_CASE CSE
		INNER JOIN BSI_X_CASE_COMPLAINT mcc ON CSE.CASE_NR = MCC.CASE_NR
--		INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		AND CSE.STATUS_UID IN (75959)
--	WHERE MCC.COMPLAINT_NR = 3433641465
--	GROUP BY MCC.COMPLAINT_NR
	HAVING count(cse.CASE_NR) > 1
) WHERE rownum = 1
, Error Msg = ORA-00936: Ausdruck fehlt

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 22:43:30.727
!MESSAGE SQL-Fehler [978] [42000]: ORA-00978: Verschachtelte Gruppenfunktion ohne GROUP BY

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 22:43:30.727
!MESSAGE Error : 978, Position : 405, Sql = SELECT 
--		cse.PROCESS_UID
		sum(count(cse.CASE_NR)) AS Anzahl
--		MCC.COMPLAINT_NR
	FROM BSI_CASE CSE
		INNER JOIN BSI_X_CASE_COMPLAINT mcc ON CSE.CASE_NR = MCC.CASE_NR
--		INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		AND CSE.STATUS_UID IN (75959)
--	WHERE MCC.COMPLAINT_NR = 3433641465
--	GROUP BY MCC.COMPLAINT_NR
	HAVING count(cse.CASE_NR) > 1, OriginalSql = SELECT 
--		cse.PROCESS_UID
		sum(count(cse.CASE_NR)) AS Anzahl
--		MCC.COMPLAINT_NR
	FROM BSI_CASE CSE
		INNER JOIN BSI_X_CASE_COMPLAINT mcc ON CSE.CASE_NR = MCC.CASE_NR
--		INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		AND CSE.STATUS_UID IN (75959)
--	WHERE MCC.COMPLAINT_NR = 3433641465
--	GROUP BY MCC.COMPLAINT_NR
	HAVING count(cse.CASE_NR) > 1, Error Msg = ORA-00978: Verschachtelte Gruppenfunktion ohne GROUP BY

!STACK 0
Error : 978, Position : 405, Sql = SELECT 
--		cse.PROCESS_UID
		sum(count(cse.CASE_NR)) AS Anzahl
--		MCC.COMPLAINT_NR
	FROM BSI_CASE CSE
		INNER JOIN BSI_X_CASE_COMPLAINT mcc ON CSE.CASE_NR = MCC.CASE_NR
--		INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		AND CSE.STATUS_UID IN (75959)
--	WHERE MCC.COMPLAINT_NR = 3433641465
--	GROUP BY MCC.COMPLAINT_NR
	HAVING count(cse.CASE_NR) > 1, OriginalSql = SELECT 
--		cse.PROCESS_UID
		sum(count(cse.CASE_NR)) AS Anzahl
--		MCC.COMPLAINT_NR
	FROM BSI_CASE CSE
		INNER JOIN BSI_X_CASE_COMPLAINT mcc ON CSE.CASE_NR = MCC.CASE_NR
--		INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		AND CSE.STATUS_UID IN (75959)
--	WHERE MCC.COMPLAINT_NR = 3433641465
--	GROUP BY MCC.COMPLAINT_NR
	HAVING count(cse.CASE_NR) > 1, Error Msg = ORA-00978: Verschachtelte Gruppenfunktion ohne GROUP BY

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.doScrollExecuteCommon(OracleStatement.java:4699)
	at oracle.jdbc.driver.OracleStatement.doScrollStmtExecuteQuery(OracleStatement.java:4815)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1758)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 22:57:07.023
!MESSAGE SQL-Fehler [923] [42000]: ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 22:57:07.023
!MESSAGE Error : 923, Position : 1252, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
--	uc_caseType.TEXT case_type,
	(SELECT 
		max(cse.PROCESS_UID) max_process_uid,
		uc_caseType.TEXT process_text
	FROM BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
		WHERE MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
		GROUP BY process_text
	).process_text case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
--	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
--		INNER JOIN BSI_CASE CSE
--			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
--	uc_caseType.TEXT case_type,
	(SELECT 
		max(cse.PROCESS_UID) max_process_uid,
		uc_caseType.TEXT process_text
	FROM BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
		WHERE MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
		GROUP BY process_text
	).process_text case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
--	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
--		INNER JOIN BSI_CASE CSE
--			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

!STACK 0
Error : 923, Position : 1252, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
--	uc_caseType.TEXT case_type,
	(SELECT 
		max(cse.PROCESS_UID) max_process_uid,
		uc_caseType.TEXT process_text
	FROM BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
		WHERE MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
		GROUP BY process_text
	).process_text case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
--	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
--		INNER JOIN BSI_CASE CSE
--			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
--	uc_caseType.TEXT case_type,
	(SELECT 
		max(cse.PROCESS_UID) max_process_uid,
		uc_caseType.TEXT process_text
	FROM BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
		WHERE MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
		GROUP BY process_text
	).process_text case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
--	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
--		INNER JOIN BSI_CASE CSE
--			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00923: Schlüsselwort FROM nicht an erwarteter Stelle gefunden

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 22:57:47.167
!MESSAGE SQL-Fehler [904] [42000]: ORA-00904: "PROCESS_TEXT": ungültige ID

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 22:57:47.167
!MESSAGE Error : 904, Position : 339, Sql = SELECT 
		max(cse.PROCESS_UID) max_process_uid,
		uc_caseType.TEXT process_text
	FROM BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
		WHERE MCC.COMPLAINT_NR = 4159592675
		GROUP BY process_text
, OriginalSql = SELECT 
		max(cse.PROCESS_UID) max_process_uid,
		uc_caseType.TEXT process_text
	FROM BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
		WHERE MCC.COMPLAINT_NR = 4159592675
		GROUP BY process_text
, Error Msg = ORA-00904: "PROCESS_TEXT": ungültige ID

!STACK 0
Error : 904, Position : 339, Sql = SELECT 
		max(cse.PROCESS_UID) max_process_uid,
		uc_caseType.TEXT process_text
	FROM BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
		WHERE MCC.COMPLAINT_NR = 4159592675
		GROUP BY process_text
, OriginalSql = SELECT 
		max(cse.PROCESS_UID) max_process_uid,
		uc_caseType.TEXT process_text
	FROM BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
		ON CSE.CASE_NR = MCC.CASE_NR
		WHERE MCC.COMPLAINT_NR = 4159592675
		GROUP BY process_text
, Error Msg = ORA-00904: "PROCESS_TEXT": ungültige ID

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 23:00:27.315
!MESSAGE SQL-Fehler [936] [42000]: ORA-00936: Ausdruck fehlt

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 23:00:27.315
!MESSAGE Error : 936, Position : 7, Sql = SELECT FROM  BSI_UC_TEXT uc_caseType 
INNER JOIN (
	SELECT 
		max(cse.PROCESS_UID) max_process_uid
	FROM BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
		ON CSE.CASE_NR = MCC.CASE_NR
		WHERE MCC.COMPLAINT_NR = 4159592675
) cse 
ON uc_caseType.UC_UID = CSE.max_process_uid AND uc_caseType.LANGUAGE_UID = 246
, OriginalSql = SELECT FROM  BSI_UC_TEXT uc_caseType 
INNER JOIN (
	SELECT 
		max(cse.PROCESS_UID) max_process_uid
	FROM BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
		ON CSE.CASE_NR = MCC.CASE_NR
		WHERE MCC.COMPLAINT_NR = 4159592675
) cse 
ON uc_caseType.UC_UID = CSE.max_process_uid AND uc_caseType.LANGUAGE_UID = 246
, Error Msg = ORA-00936: Ausdruck fehlt

!STACK 0
Error : 936, Position : 7, Sql = SELECT FROM  BSI_UC_TEXT uc_caseType 
INNER JOIN (
	SELECT 
		max(cse.PROCESS_UID) max_process_uid
	FROM BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
		ON CSE.CASE_NR = MCC.CASE_NR
		WHERE MCC.COMPLAINT_NR = 4159592675
) cse 
ON uc_caseType.UC_UID = CSE.max_process_uid AND uc_caseType.LANGUAGE_UID = 246
, OriginalSql = SELECT FROM  BSI_UC_TEXT uc_caseType 
INNER JOIN (
	SELECT 
		max(cse.PROCESS_UID) max_process_uid
	FROM BSI_X_CASE_COMPLAINT mcc 
		INNER JOIN BSI_CASE CSE
		ON CSE.CASE_NR = MCC.CASE_NR
		WHERE MCC.COMPLAINT_NR = 4159592675
) cse 
ON uc_caseType.UC_UID = CSE.max_process_uid AND uc_caseType.LANGUAGE_UID = 246
, Error Msg = ORA-00936: Ausdruck fehlt

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 23:07:20.221
!MESSAGE SQL-Fehler [1013] [72000]: ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 23:07:20.221
!MESSAGE Error : 1013, Position : 924, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
--	uc_caseType.TEXT case_type,
	(
		SELECT uc_caseType.TEXT FROM  BSI_UC_TEXT uc_caseType 
		INNER JOIN (
			SELECT 
				max(cse.PROCESS_UID) max_process_uid
			FROM BSI_X_CASE_COMPLAINT mcc 
				INNER JOIN BSI_CASE CSE
				ON CSE.CASE_NR = MCC.CASE_NR
				WHERE MCC.COMPLAINT_NR = XCPL.COMPANY_NR
		) cse 
		ON uc_caseType.UC_UID = CSE.max_process_uid AND uc_caseType.LANGUAGE_UID = 246
	) case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
--	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
--		INNER JOIN BSI_CASE CSE
--			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
--	uc_caseType.TEXT case_type,
	(
		SELECT uc_caseType.TEXT FROM  BSI_UC_TEXT uc_caseType 
		INNER JOIN (
			SELECT 
				max(cse.PROCESS_UID) max_process_uid
			FROM BSI_X_CASE_COMPLAINT mcc 
				INNER JOIN BSI_CASE CSE
				ON CSE.CASE_NR = MCC.CASE_NR
				WHERE MCC.COMPLAINT_NR = XCPL.COMPANY_NR
		) cse 
		ON uc_caseType.UC_UID = CSE.max_process_uid AND uc_caseType.LANGUAGE_UID = 246
	) case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
--	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
--		INNER JOIN BSI_CASE CSE
--			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert

!STACK 0
Error : 1013, Position : 924, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
--	uc_caseType.TEXT case_type,
	(
		SELECT uc_caseType.TEXT FROM  BSI_UC_TEXT uc_caseType 
		INNER JOIN (
			SELECT 
				max(cse.PROCESS_UID) max_process_uid
			FROM BSI_X_CASE_COMPLAINT mcc 
				INNER JOIN BSI_CASE CSE
				ON CSE.CASE_NR = MCC.CASE_NR
				WHERE MCC.COMPLAINT_NR = XCPL.COMPANY_NR
		) cse 
		ON uc_caseType.UC_UID = CSE.max_process_uid AND uc_caseType.LANGUAGE_UID = 246
	) case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
--	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
--		INNER JOIN BSI_CASE CSE
--			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
--	uc_caseType.TEXT case_type,
	(
		SELECT uc_caseType.TEXT FROM  BSI_UC_TEXT uc_caseType 
		INNER JOIN (
			SELECT 
				max(cse.PROCESS_UID) max_process_uid
			FROM BSI_X_CASE_COMPLAINT mcc 
				INNER JOIN BSI_CASE CSE
				ON CSE.CASE_NR = MCC.CASE_NR
				WHERE MCC.COMPLAINT_NR = XCPL.COMPANY_NR
		) cse 
		ON uc_caseType.UC_UID = CSE.max_process_uid AND uc_caseType.LANGUAGE_UID = 246
	) case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
--	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
--		INNER JOIN BSI_CASE CSE
--			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 23:10:49.321
!MESSAGE SQL-Fehler [1013] [72000]: ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 23:10:49.321
!MESSAGE Error : 1013, Position : 927, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
--	uc_caseType.TEXT case_type,
	(
		SELECT uc_caseType.TEXT 
		FROM BSI_UC_TEXT uc_caseType 
		WHERE uc_caseType.UC_UID = 
		(
			SELECT 
				max(cse.PROCESS_UID) max_process_uid
			FROM BSI_X_CASE_COMPLAINT mcc 
				INNER JOIN BSI_CASE CSE
				ON CSE.CASE_NR = MCC.CASE_NR
				WHERE MCC.COMPLAINT_NR = XCPL.COMPANY_NR
		)
		AND uc_caseType.LANGUAGE_UID = 246
	) case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
--	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
--		INNER JOIN BSI_CASE CSE
--			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
--	uc_caseType.TEXT case_type,
	(
		SELECT uc_caseType.TEXT 
		FROM BSI_UC_TEXT uc_caseType 
		WHERE uc_caseType.UC_UID = 
		(
			SELECT 
				max(cse.PROCESS_UID) max_process_uid
			FROM BSI_X_CASE_COMPLAINT mcc 
				INNER JOIN BSI_CASE CSE
				ON CSE.CASE_NR = MCC.CASE_NR
				WHERE MCC.COMPLAINT_NR = XCPL.COMPANY_NR
		)
		AND uc_caseType.LANGUAGE_UID = 246
	) case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
--	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
--		INNER JOIN BSI_CASE CSE
--			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert

!STACK 0
Error : 1013, Position : 927, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
--	uc_caseType.TEXT case_type,
	(
		SELECT uc_caseType.TEXT 
		FROM BSI_UC_TEXT uc_caseType 
		WHERE uc_caseType.UC_UID = 
		(
			SELECT 
				max(cse.PROCESS_UID) max_process_uid
			FROM BSI_X_CASE_COMPLAINT mcc 
				INNER JOIN BSI_CASE CSE
				ON CSE.CASE_NR = MCC.CASE_NR
				WHERE MCC.COMPLAINT_NR = XCPL.COMPANY_NR
		)
		AND uc_caseType.LANGUAGE_UID = 246
	) case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
--	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
--		INNER JOIN BSI_CASE CSE
--			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
--	uc_caseType.TEXT case_type,
	(
		SELECT uc_caseType.TEXT 
		FROM BSI_UC_TEXT uc_caseType 
		WHERE uc_caseType.UC_UID = 
		(
			SELECT 
				max(cse.PROCESS_UID) max_process_uid
			FROM BSI_X_CASE_COMPLAINT mcc 
				INNER JOIN BSI_CASE CSE
				ON CSE.CASE_NR = MCC.CASE_NR
				WHERE MCC.COMPLAINT_NR = XCPL.COMPANY_NR
		)
		AND uc_caseType.LANGUAGE_UID = 246
	) case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
--	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
--		INNER JOIN BSI_CASE CSE
--			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-14 23:13:54.197
!MESSAGE SQL-Fehler [1013] [72000]: ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-14 23:13:54.197
!MESSAGE Error : 1013, Position : 927, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
--	uc_caseType.TEXT case_type,
	(
		SELECT uc_caseType.TEXT 
		FROM BSI_UC_TEXT uc_caseType 
		WHERE uc_caseType.UC_UID = 
		(
			SELECT 
				max(cse.PROCESS_UID) max_process_uid
			FROM BSI_X_CASE_COMPLAINT mcc 
				INNER JOIN BSI_CASE CSE
			ON CSE.CASE_NR = MCC.CASE_NR
			WHERE MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
		)
		AND uc_caseType.LANGUAGE_UID = 246
	) case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
--	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
--		INNER JOIN BSI_CASE CSE
--			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
--	uc_caseType.TEXT case_type,
	(
		SELECT uc_caseType.TEXT 
		FROM BSI_UC_TEXT uc_caseType 
		WHERE uc_caseType.UC_UID = 
		(
			SELECT 
				max(cse.PROCESS_UID) max_process_uid
			FROM BSI_X_CASE_COMPLAINT mcc 
				INNER JOIN BSI_CASE CSE
			ON CSE.CASE_NR = MCC.CASE_NR
			WHERE MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
		)
		AND uc_caseType.LANGUAGE_UID = 246
	) case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
--	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
--		INNER JOIN BSI_CASE CSE
--			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert

!STACK 0
Error : 1013, Position : 927, Sql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
--	uc_caseType.TEXT case_type,
	(
		SELECT uc_caseType.TEXT 
		FROM BSI_UC_TEXT uc_caseType 
		WHERE uc_caseType.UC_UID = 
		(
			SELECT 
				max(cse.PROCESS_UID) max_process_uid
			FROM BSI_X_CASE_COMPLAINT mcc 
				INNER JOIN BSI_CASE CSE
			ON CSE.CASE_NR = MCC.CASE_NR
			WHERE MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
		)
		AND uc_caseType.LANGUAGE_UID = 246
	) case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
--	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
--		INNER JOIN BSI_CASE CSE
--			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	UPPER(uc_cp_cat.text) case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
--	XCPL.COMPANY_NR Company,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
--	uc_caseType.TEXT case_type,
	(
		SELECT uc_caseType.TEXT 
		FROM BSI_UC_TEXT uc_caseType 
		WHERE uc_caseType.UC_UID = 
		(
			SELECT 
				max(cse.PROCESS_UID) max_process_uid
			FROM BSI_X_CASE_COMPLAINT mcc 
				INNER JOIN BSI_CASE CSE
			ON CSE.CASE_NR = MCC.CASE_NR
			WHERE MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
		)
		AND uc_caseType.LANGUAGE_UID = 246
	) case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
--	XCPL.PERSON_NR LCM_Customer_NUMBER,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
--	LEFT JOIN BSI_X_CASE_COMPLAINT mcc
--		INNER JOIN BSI_CASE CSE
--			INNER JOIN BSI_UC_TEXT uc_caseType ON uc_caseType.UC_UID = CSE.PROCESS_UID AND uc_caseType.LANGUAGE_UID = 246
--		ON CSE.CASE_NR = MCC.CASE_NR
--		AND CSE.STATUS_UID IN (75959)
--	ON MCC.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-01013: Benutzer hat Abbruch des aktuellen Vorgangs angefordert

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.eclipse.ui.workbench 4 0 2019-11-14 23:41:11.727
!MESSAGE Invalid thread access
!STACK 0
org.eclipse.swt.SWTException: Invalid thread access
	at org.eclipse.swt.SWT.error(SWT.java:4595)
	at org.eclipse.swt.SWT.error(SWT.java:4510)
	at org.eclipse.swt.SWT.error(SWT.java:4481)
	at org.eclipse.swt.widgets.Widget.error(Widget.java:451)
	at org.eclipse.swt.widgets.Widget.checkWidget(Widget.java:369)
	at org.eclipse.swt.widgets.Decorations.getText(Decorations.java:683)
	at org.eclipse.ui.internal.WorkbenchWindowConfigurer.getTitle(WorkbenchWindowConfigurer.java:271)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor.recomputeTitle(IDEWorkbenchWindowAdvisor.java:435)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor.access$2(IDEWorkbenchWindowAdvisor.java:433)
	at org.eclipse.ui.internal.ide.application.IDEWorkbenchWindowAdvisor$1.propertyChanged(IDEWorkbenchWindowAdvisor.java:116)
	at org.eclipse.ui.part.WorkbenchPart.firePropertyChange(WorkbenchPart.java:122)
	at org.eclipse.ui.texteditor.AbstractTextEditor.firePropertyChange(AbstractTextEditor.java:6345)
	at org.eclipse.ui.part.WorkbenchPart.setTitle(WorkbenchPart.java:288)
	at org.eclipse.ui.part.EditorPart.setDefaultTitle(EditorPart.java:288)
	at org.eclipse.ui.part.WorkbenchPart.setPartName(WorkbenchPart.java:368)
	at org.eclipse.ui.part.EditorPart.setPartName(EditorPart.java:263)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor.setDataSourceContainer(SQLEditor.java:323)
	at org.jkiss.dbeaver.ui.perspective.DataSourceManagementToolbar$4.run(DataSourceManagementToolbar.java:627)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.eclipse.core.expressions 4 201 2019-11-14 23:42:00.287
!MESSAGE No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource
!STACK 1
org.eclipse.core.runtime.CoreException: No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource
	at org.eclipse.core.internal.expressions.TypeExtensionManager.getProperty(TypeExtensionManager.java:130)
	at org.eclipse.core.internal.expressions.TestExpression.evaluate(TestExpression.java:100)
	at org.eclipse.core.internal.expressions.CompositeExpression.evaluateAnd(CompositeExpression.java:55)
	at org.eclipse.core.internal.expressions.AndExpression.evaluate(AndExpression.java:34)
	at org.eclipse.ui.internal.dialogs.RegistryPageContributor.failsEnablement(RegistryPageContributor.java:309)
	at org.eclipse.ui.internal.dialogs.RegistryPageContributor.isApplicableTo(RegistryPageContributor.java:251)
	at org.eclipse.ui.internal.dialogs.PropertyPageContributorManager.getApplicableContributors(PropertyPageContributorManager.java:218)
	at org.eclipse.ui.dialogs.PreferencesUtil.hasPropertiesContributors(PreferencesUtil.java:305)
	at org.jkiss.dbeaver.ui.navigator.NavigatorUtils.lambda$0(NavigatorUtils.java:223)
	at org.eclipse.jface.action.MenuManager.fireAboutToShow(MenuManager.java:342)
	at org.eclipse.jface.action.MenuManager.handleAboutToShow(MenuManager.java:473)
	at org.eclipse.jface.action.MenuManager.access$1(MenuManager.java:468)
	at org.eclipse.jface.action.MenuManager$2.menuShown(MenuManager.java:500)
	at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:259)
	at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:89)
	at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4145)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1055)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1079)
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1060)
	at org.eclipse.swt.widgets.Control.WM_INITMENUPOPUP(Control.java:5148)
	at org.eclipse.swt.widgets.Control.windowProc(Control.java:4797)
	at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:348)
	at org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1502)
	at org.eclipse.swt.widgets.Shell.windowProc(Shell.java:2162)
	at org.eclipse.swt.widgets.Display.windowProc(Display.java:4784)
	at org.eclipse.swt.internal.win32.OS.TrackPopupMenu(Native Method)
	at org.eclipse.swt.widgets.Menu._setVisible(Menu.java:253)
	at org.eclipse.swt.widgets.Display.runPopups(Display.java:3999)
	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3555)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$5.run(PartRenderingEngine.java:1173)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1062)
	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156)
	at org.eclipse.ui.internal.Workbench.lambda$3(Workbench.java:628)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)
	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:563)
	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:151)
	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:155)
	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:199)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:137)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:107)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:391)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:246)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:659)
	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:595)
	at org.eclipse.equinox.launcher.Main.run(Main.java:1501)
	at org.eclipse.equinox.launcher.Main.main(Main.java:1474)
!SUBENTRY 1 org.eclipse.core.expressions 4 201 2019-11-14 23:42:00.287
!MESSAGE No property tester contributes a property org.eclipse.wst.jsdt.chromium.debug.core.isJsFile to type class org.jkiss.dbeaver.model.navigator.DBNResource

!ENTRY org.jkiss.dbeaver.model 2 0 2019-11-14 23:42:16.188
!MESSAGE Datasource user 'org.jkiss.dbeaver.ui.editors.sql.SQLEditor@4ad061bd' already registered in datasource 'TEP'

!ENTRY org.jkiss.dbeaver.model 2 0 2019-11-15 06:13:20.890
!MESSAGE Can't read execution warnings
!SUBENTRY 1 org.jkiss.dbeaver.model 2 0 2019-11-15 06:13:20.890
!MESSAGE SQL-Fehler [17008] [08003]: Getrennte Verbindung
!SUBENTRY 2 org.jkiss.dbeaver.model 2 0 2019-11-15 06:13:20.890
!MESSAGE Getrennte Verbindung
!STACK 0
java.sql.SQLRecoverableException: Getrennte Verbindung
	at oracle.jdbc.driver.OracleStatement.ensureOpen(OracleStatement.java:4114)
	at oracle.jdbc.driver.OracleStatement.getWarnings(OracleStatement.java:3113)
	at oracle.jdbc.driver.OracleStatementWrapper.getWarnings(OracleStatementWrapper.java:348)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.getWarnings(JDBCStatementImpl.java:582)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.getStatementWarnings(JDBCStatementImpl.java:612)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:524)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-15 06:13:20.905
!MESSAGE Can't close statement
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-15 06:13:20.905
!MESSAGE Getrennte Verbindung
!STACK 0
java.sql.SQLRecoverableException: Getrennte Verbindung
	at oracle.jdbc.driver.PhysicalConnection.needLine(PhysicalConnection.java:3305)
	at oracle.jdbc.driver.OracleStatement.closeOrCache(OracleStatement.java:1409)
	at oracle.jdbc.driver.OracleStatement.close(OracleStatement.java:1392)
	at oracle.jdbc.driver.OracleStatementWrapper.close(OracleStatementWrapper.java:119)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.close(JDBCStatementImpl.java:512)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.closeStatement(SQLQueryJob.java:797)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:530)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-15 06:13:21.110
!MESSAGE Operation failed. Retry count remains = 1
!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-15 06:13:21.110
!MESSAGE SQL-Fehler [17002] [08006]: I/O-Fehler: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!SUBENTRY 2 org.jkiss.dbeaver.model 4 0 2019-11-15 06:13:21.110
!MESSAGE I/O-Fehler: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!STACK 0
java.sql.SQLRecoverableException: I/O-Fehler: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:738)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)
Caused by: java.io.IOException: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:51)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:113)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:79)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:50)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:463)
	at oracle.net.nt.TimeoutSocketChannel.write(TimeoutSocketChannel.java:207)
	at oracle.net.ns.NIOPacket.writeToSocketChannel(NIOPacket.java:308)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:182)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:133)
	at oracle.jdbc.driver.T4CMAREngineNIO.flush(T4CMAREngineNIO.java:741)
	at oracle.jdbc.driver.T4CMAREngineNIO.prepareForUnmarshall(T4CMAREngineNIO.java:754)
	at oracle.jdbc.driver.T4CMAREngineNIO.unmarshalUB1(T4CMAREngineNIO.java:427)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:394)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	... 18 more
!SUBENTRY 3 org.jkiss.dbeaver.model 4 0 2019-11-15 06:13:21.111
!MESSAGE Eine vorhandene Verbindung wurde vom Remotehost geschlossen
!STACK 0
java.io.IOException: Eine vorhandene Verbindung wurde vom Remotehost geschlossen
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:51)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:113)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:79)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:50)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:463)
	at oracle.net.nt.TimeoutSocketChannel.write(TimeoutSocketChannel.java:207)
	at oracle.net.ns.NIOPacket.writeToSocketChannel(NIOPacket.java:308)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:182)
	at oracle.net.ns.NIONSDataChannel.writeDataToSocketChannel(NIONSDataChannel.java:133)
	at oracle.jdbc.driver.T4CMAREngineNIO.flush(T4CMAREngineNIO.java:741)
	at oracle.jdbc.driver.T4CMAREngineNIO.prepareForUnmarshall(T4CMAREngineNIO.java:754)
	at oracle.jdbc.driver.T4CMAREngineNIO.unmarshalUB1(T4CMAREngineNIO.java:427)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:394)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 4 0 2019-11-15 06:15:28.617
!MESSAGE SQL-Fehler [904] [42000]: ORA-00904: "CASE_JOIN"."MAX_PROCESS_UID": ungültige ID

!SUBENTRY 1 org.jkiss.dbeaver.model 4 0 2019-11-15 06:15:28.617
!MESSAGE Error : 904, Position : 967, Sql = SELECT DISTINCT
	CASE WHEN XCPL.EVT_FINISHED IS NOT NULL THEN 
		to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') 
	ELSE ''
	END ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	CASE WHEN uc_cp_cat.text IS NOT NULL THEN 
		UPPER(uc_cp_cat.text) 
	ELSE ''
	END case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	CASE WHEN case_join.max_process_uid IS NOT NULL THEN 
		(
			SELECT uc_caseType.TEXT FROM BSI_UC_TEXT uc_caseType 
			WHERE uc_caseType.UC_UID = case_join.max_process_uid AND uc_caseType.LANGUAGE_UID = 1303
		) 
	ELSE ''
	END case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	LEFT JOIN (
			SELECT 
--				max(cse.PROCESS_UID) max_process_uid,
				MAX(cse.CASE_NR) max_case_nr,
				cse.PROCESS_UID,
				mcc.COMPLAINT_NR
			FROM BSI_X_CASE_COMPLAINT mcc 
				INNER JOIN BSI_CASE CSE
			ON CSE.CASE_NR = MCC.CASE_NR
			GROUP BY MCC.COMPLAINT_NR, cse.PROCESS_UID
	) case_join ON case_join.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	CASE WHEN XCPL.EVT_FINISHED IS NOT NULL THEN 
		to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') 
	ELSE ''
	END ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	CASE WHEN uc_cp_cat.text IS NOT NULL THEN 
		UPPER(uc_cp_cat.text) 
	ELSE ''
	END case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	CASE WHEN case_join.max_process_uid IS NOT NULL THEN 
		(
			SELECT uc_caseType.TEXT FROM BSI_UC_TEXT uc_caseType 
			WHERE uc_caseType.UC_UID = case_join.max_process_uid AND uc_caseType.LANGUAGE_UID = 1303
		) 
	ELSE ''
	END case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	LEFT JOIN (
			SELECT 
--				max(cse.PROCESS_UID) max_process_uid,
				MAX(cse.CASE_NR) max_case_nr,
				cse.PROCESS_UID,
				mcc.COMPLAINT_NR
			FROM BSI_X_CASE_COMPLAINT mcc 
				INNER JOIN BSI_CASE CSE
			ON CSE.CASE_NR = MCC.CASE_NR
			GROUP BY MCC.COMPLAINT_NR, cse.PROCESS_UID
	) case_join ON case_join.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00904: "CASE_JOIN"."MAX_PROCESS_UID": ungültige ID

!STACK 0
Error : 904, Position : 967, Sql = SELECT DISTINCT
	CASE WHEN XCPL.EVT_FINISHED IS NOT NULL THEN 
		to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') 
	ELSE ''
	END ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	CASE WHEN uc_cp_cat.text IS NOT NULL THEN 
		UPPER(uc_cp_cat.text) 
	ELSE ''
	END case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	CASE WHEN case_join.max_process_uid IS NOT NULL THEN 
		(
			SELECT uc_caseType.TEXT FROM BSI_UC_TEXT uc_caseType 
			WHERE uc_caseType.UC_UID = case_join.max_process_uid AND uc_caseType.LANGUAGE_UID = 1303
		) 
	ELSE ''
	END case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	LEFT JOIN (
			SELECT 
--				max(cse.PROCESS_UID) max_process_uid,
				MAX(cse.CASE_NR) max_case_nr,
				cse.PROCESS_UID,
				mcc.COMPLAINT_NR
			FROM BSI_X_CASE_COMPLAINT mcc 
				INNER JOIN BSI_CASE CSE
			ON CSE.CASE_NR = MCC.CASE_NR
			GROUP BY MCC.COMPLAINT_NR, cse.PROCESS_UID
	) case_join ON case_join.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, OriginalSql = SELECT DISTINCT
	CASE WHEN XCPL.EVT_FINISHED IS NOT NULL THEN 
		to_char(XCPL.EVT_FINISHED, 'dd.mm.yyyy') 
	ELSE ''
	END ClosedDate,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(dbms_lob.substr(XCPL.DESCRIPTION, 3000, 1), chr(13), ' '), 
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') description,
	1 Closed,
	CASE WHEN uc_cp_cat.text IS NOT NULL THEN 
		UPPER(uc_cp_cat.text) 
	ELSE ''
	END case_reason,
	'Closed' Status,
	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(XCPL.SUBJECT, chr(13), ' '),
		chr(10), ' '), 
		chr(11), ' '),
		chr(9), ' '), 
		chr(32), ' ') subject,
	CMP.COMPANY_NO Company,
	CASE WHEN upper(CMP.NAME1) NOT LIKE 'UNBEKANNT%' 
		AND trim(CMP.NAME1) NOT IN ('$','*','**','*/',',,','-','--','---','-.',':',';','?','??','^','¨',':','-','0','00')
		AND CMP.NAME1 NOT LIKE '%?%' THEN
			REPLACE(REPLACE(REPLACE(CMP.NAME1, chr(13), ' '),
				chr(9), ' '), 
				chr(32), ' ')
	ELSE ''
	END name,
	CASE WHEN case_join.max_process_uid IS NOT NULL THEN 
		(
			SELECT uc_caseType.TEXT FROM BSI_UC_TEXT uc_caseType 
			WHERE uc_caseType.UC_UID = case_join.max_process_uid AND uc_caseType.LANGUAGE_UID = 1303
		) 
	ELSE ''
	END case_type,
	XCPL.COMPLAINT_NO LCM_Complaint_Number,
	XCPL.PERSON_NR LCM_Contact_person,
	to_char(XCPL.EVT_ISSUED, 'dd.mm.yyyy') Created_in_LCM,
	CASE WHEN prs_responsible.FIRST_NAME IS NOT NULL THEN
		prs_responsible.FIRST_NAME || ' ' || prs_responsible.LAST_NAME
	WHEN prs_responsible.LAST_NAME IS NULL THEN
		''
	ELSE
		prs_responsible.LAST_NAME
	END Owner_lcm
--	TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) lfd_nr
FROM BSI_X_COMPLAINT xcpl 
	LEFT JOIN (
			SELECT 
--				max(cse.PROCESS_UID) max_process_uid,
				MAX(cse.CASE_NR) max_case_nr,
				cse.PROCESS_UID,
				mcc.COMPLAINT_NR
			FROM BSI_X_CASE_COMPLAINT mcc 
				INNER JOIN BSI_CASE CSE
			ON CSE.CASE_NR = MCC.CASE_NR
			GROUP BY MCC.COMPLAINT_NR, cse.PROCESS_UID
	) case_join ON case_join.COMPLAINT_NR = XCPL.COMPLAINT_NR
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj 
		INNER JOIN BSI_X_EXT_JOIN ej ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
			AND EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
			AND EJ.ACTIVE = 1
		INNER JOIN BSI_COMPANY cmp ON CMP.COMPANY_NR = EJJ.JOIN_NR
	ON EJJ.JOIN_NR = XCPL.COMPANY_NR
	LEFT JOIN BSI_UC_TEXT uc_cp_cat ON uc_cp_cat.UC_UID = XCPL.COMPLAINT_CATEGORY_UID AND uc_cp_cat.LANGUAGE_UID = 1303
	LEFT JOIN BSI_PERSON prs_responsible ON prs_responsible.PERSON_NR = XCPL.RESPONSIBLE_USER_NR
WHERE XCPL.COMPANY_NR IS NOT NULL
--109053	Abgeschlossen
--119170	Abgeschlossen
--109056	Abklärung erledigt
AND XCPL.STATUS_UID IN (119170, 109053, 109056)
AND XCPL.EVT_ISSUED > to_date('31.12.2014', 'dd.mm.yyyy')
--ORDER BY TO_NUMBER(to_char(XCPL.EVT_ISSUED, 'yyyymmddhh24mi')) DESC
, Error Msg = ORA-00904: "CASE_JOIN"."MAX_PROCESS_UID": ungültige ID

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1052)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:537)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:255)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:610)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:724)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:921)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1099)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1754)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1709)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.execute(JDBCStatementImpl.java:344)
	at org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:137)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:458)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:402)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:400)
	at org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.extractData(SQLQueryJob.java:839)
	at org.jkiss.dbeaver.ui.editors.sql.SQLEditor$QueryResultsContainer.readData(SQLEditor.java:2696)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.lambda$0(ResultSetJobDataRead.java:102)
	at org.jkiss.dbeaver.model.DBUtils.tryExecuteRecover(DBUtils.java:1679)
	at org.jkiss.dbeaver.ui.controls.resultset.ResultSetJobDataRead.run(ResultSetJobDataRead.java:100)
	at org.jkiss.dbeaver.model.runtime.AbstractJob.run(AbstractJob.java:102)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:63)

!ENTRY org.jkiss.dbeaver.model 2 0 2019-11-15 10:25:55.940
!MESSAGE Some data source listeners are still registered: [org.jkiss.dbeaver.ui.editors.sql.SQLEditor@42bc8e89, org.jkiss.dbeaver.ui.editors.sql.SQLEditor@4ad061bd]
!SESSION 2019-11-15 16:51:16.260 -----------------------------------------------
eclipse.buildId=4.9.0.I20180906-0745
java.version=11.0.3
java.vendor=Oracle Corporation
BootLoader constants: OS=win32, ARCH=x86_64, WS=win32, NL=de_CH
Framework arguments:  -product org.eclipse.epp.package.jee.product
Command-line arguments:  -os win32 -ws win32 -arch x86_64 -product org.eclipse.epp.package.jee.product

!ENTRY org.eclipse.jface 2 0 2019-11-15 16:51:35.857
!MESSAGE Keybinding conflicts occurred.  They may interfere with normal accelerator operation.
!SUBENTRY 1 org.eclipse.jface 2 0 2019-11-15 16:51:35.857
!MESSAGE A conflict occurred for CTRL+SHIFT+V:
Binding(CTRL+SHIFT+V,
	ParameterizedCommand(Command(org.eclipse.jdt.debug.ui.command.OpenFromClipboard,Open from Clipboard,
		Opens a Java element or a Java stack trace from clipboard,
		Category(org.eclipse.ui.category.navigate,Navigate,null,true),
		org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@40e420fe,
		,,true),null),
	org.eclipse.ui.defaultAcceleratorConfiguration,
	org.eclipse.ui.contexts.window,,,system)
Binding(CTRL+SHIFT+V,
	ParameterizedCommand(Command(org.jkiss.dbeaver.core.edit.paste.special,Erweitertes Einfügen,
		Einfügen mit zusätzlichen Einstellungen,
		Category(org.jkiss.dbeaver.core.util,Werkzeuge,Werkzeugebefehle,true),
		org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@7eaa52d6,
		,,true),null),
	org.eclipse.ui.defaultAcceleratorConfiguration,
	org.eclipse.ui.contexts.window,,,system)
!SUBENTRY 1 org.eclipse.jface 2 0 2019-11-15 16:51:35.857
!MESSAGE A conflict occurred for CTRL+SHIFT+A:
Binding(CTRL+SHIFT+A,
	ParameterizedCommand(Command(org.eclipse.pde.ui.openPluginArtifact,Open Plug-in Artifact,
		Open a plug-in artifact in the manifest editor,
		Category(org.eclipse.ui.category.navigate,Navigate,null,true),
		org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@4cbf1c30,
		,,true),null),
	org.eclipse.ui.defaultAcceleratorConfiguration,
	org.eclipse.ui.contexts.window,,,system)
Binding(CTRL+SHIFT+A,
	ParameterizedCommand(Command(org.jkiss.dbeaver.core.navigator.set.active,Aktives Objekt festlegen,
		Aktives Objekt festlegen,
		Category(org.jkiss.dbeaver.core.navigator,Datenbanknavigator,Datenbanknavigatorbefehle,true),
		org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@3c5095df,
		,,true),null),
	org.eclipse.ui.defaultAcceleratorConfiguration,
	org.eclipse.ui.contexts.window,,,system)
