WITH pre_sel AS 
(
	SELECT
		CASE WHEN CMC.TEXT_LOB IS NOT NULL AND DBMS_LOB.GETLENGTH(CMC.TEXT_LOB) > 3994 THEN
			DBMS_LOB.GETLENGTH(CMC.TEXT_LOB) 
		END lob_length,
		CASE WHEN CMC.TEXT_LOB IS NOT NULL THEN
			REPLACE(REPLACE(dbms_lob.substr(to_clob(CMC.TEXT_LOB), 3994, 1), CHR(10), ' '), chr(11), ' ')
		ELSE
			NULL
		END LCM_Communcation_Text_Part1,
		CASE WHEN CMC.TEXT_LOB IS NOT NULL AND DBMS_LOB.GETLENGTH(CMC.TEXT_LOB) > 3994 THEN
			REPLACE(REPLACE(dbms_lob.substr(to_clob(CMC.TEXT_LOB), 2000, 3995), CHR(10), ' '), chr(11), ' ')
		ELSE 
			NULL
		END LCM_Communcation_Text_Part2,
--		CMC.TEXT_LOB,
		CMC.X_COMMUNICATION_EXT_KEY
	--	CMC.CHANNEL_UID,
	--	CMC.STATUS_UID,
	--	CMC.ORIGIN_UID
	FROM BSI_COMMUNICATION cmc 
--	WHERE CMC.X_COMMUNICATION_EXT_KEY = '38A18A9F12C96BF5E053C020A60A91BB'
--	WHERE X_COMMUNICATION_EXT_KEY = '4E58F6EB19453B9BE053C020A60A06E7'
)
	SELECT 
--		PSL.LCM_Communcation_Text_Part1 part1,
		PSL.lob_length,
		PSL.LCM_Communcation_Text_Part2 part2,
		PSL.X_COMMUNICATION_EXT_KEY
	FROM pre_sel psl
	WHERE PSL.lob_length IS NOT NULL
;


SELECT
	CMC.CHANNEL_UID my_channel,
	CMC.TEXT_LOB,
	REPLACE(REPLACE(dbms_lob.substr(CMC.TEXT_LOB, 3000, 1), CHR(10), ' '), chr(11), ' ') part1 
FROM BSI_COMMUNICATION CMC
--WHERE X_COMMUNICATION_EXT_KEY = '38A18A9F12C96BF5E053C020A60A91BB'
--WHERE X_COMMUNICATION_EXT_KEY = '4E58F6EB19453B9BE053C020A60A06E7'
WHERE X_COMMUNICATION_EXT_KEY = '38A18AC8675E6BF5E053C020A60A91BB'
;