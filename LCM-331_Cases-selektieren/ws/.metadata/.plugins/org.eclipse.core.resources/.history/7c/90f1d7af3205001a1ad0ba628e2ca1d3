WITH pre_sel AS 
(
	SELECT
		DBMS_LOB.GETLENGTH(CMC.TEXT_LOB) lob_length,
		CASE WHEN CMC.TEXT_LOB IS NOT NULL THEN
			REPLACE(REPLACE(dbms_lob.substr(to_clob(CMC.TEXT_LOB), 3994, 1), CHR(10), ' '), chr(11), ' ')
		ELSE
			''
		END LCM_Communcation_Text_Part1,
		CASE WHEN CMC.TEXT_LOB IS NOT NULL AND DBMS_LOB.GETLENGTH(CMC.TEXT_LOB) > 3995 THEN
			REPLACE(REPLACE(dbms_lob.substr(to_clob(CMC.TEXT_LOB), 3000, 3995), CHR(10), ' '), chr(11), ' ')
		ELSE 
			''
		END LCM_Communcation_Text_Part2,
		CMC.TEXT_LOB,
		CMC.X_COMMUNICATION_EXT_KEY
	--	CMC.CHANNEL_UID,
	--	CMC.STATUS_UID,
	--	CMC.ORIGIN_UID
	FROM BSI_COMMUNICATION cmc 
--	WHERE CMC.X_COMMUNICATION_EXT_KEY = '38A18A9F12C96BF5E053C020A60A91BB'
	WHERE X_COMMUNICATION_EXT_KEY = '4E58F6EB19453B9BE053C020A60A06E7'
)
	SELECT 
		PSL.LCM_Communcation_Text_Part1 part1,
		PSL.LCM_Communcation_Text_Part2 part2
	FROM pre_sel psl
;


DECLARE
	my_var LONG;
BEGIN
	
END;

SELECT
	CAST (CHANNEL_UID AS int) my_channel,
	TEXT_LOB my_lob
--	CAST (REPLACE(REPLACE(dbms_lob.substr(CMC.TEXT_LOB, 6000, 1), CHR(10), ' '), chr(11), ' ') AS varchar2) 
FROM BSI_COMMUNICATION
--WHERE X_COMMUNICATION_EXT_KEY = '38A18A9F12C96BF5E053C020A60A91BB'
WHERE X_COMMUNICATION_EXT_KEY = '4E58F6EB19453B9BE053C020A60A06E7'
;