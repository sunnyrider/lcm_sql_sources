SELECT * FROM BSI_COMPANY WHERE COMPANY_NO = 8111262126
;

SELECT DISTINCT ATC.TABLE_NAME, ATC.OWNER, ATC.COLUMN_NAME 
	FROM sys.ALL_TAB_COLUMNS atc
WHERE lower(ATC.OWNER) = lower('BSICRM') 
--AND lower(ATC.COLUMN_NAME) LIKE lower('%structure_sales%')
--AND lower(ATC.COLUMN_NAME) LIKE lower('%ext%no%BSI_SOURCE_MAPPING%')
AND lower(ATC.COLUMN_NAME) LIKE lower('%COMMUNICATION%EXT%KEY%')
ORDER BY ATC.TABLE_NAME
;

SELECT 
	CMP.COMPANY_NO,
	CMP.COMPANY_NR,
	CMP.X_COMPLEX_NO
FROM BSI_COMPANY cmp WHERE CMP.COMPANY_NO = 1002612796 -- 1010247583
;

SELECT * FROM BSI_PERSON bp WHERE PERSON_NR = 90557978 --20893919
;
SELECT BXEJJ.JOIN_NR FROM BSI_X_EXT_JOIN_JOIN bxejj 
WHERE BXEJJ.JOIN_NO = 1002612796
;
SELECT * FROM BSI_PERSON bp WHERE BP.PERSON_NR IN (
			SELECT BXEJJ.JOIN_NR FROM BSI_X_EXT_JOIN_JOIN bxejj WHERE BXEJJ.JOIN_NO IN (
				1006121385, 1002059302, 1011515861, 1001596138, 1001227916, 1004269645, 1000431873, 1001595821, 1001435466, 1001959511, 1004470312, 1000003161, 1001718698, 1000582101, 1002441526, 1001824160, 1000642094, 1006899561, 1005949009, 1003028507, 1001630486, 1003582872, 1002042063, 1003343129, 1002217281, 1003097418, 1000846081, 1003000017, 1001435466, 1001628896, 1000998853, 1004150225, 1001782101, 1007097217, 1005320710, 1002381067, 1006257564, 1001795198, 1009741707, 1010045148, 1001609902
			)
		)
;

SELECT 
	ejj_join.JOIN_NR,
	ejj_join.EXT_JOIN_NR,
	BC.COMPANY_NO,
	BC.COMPANY_NR,
	BC.DISPLAY_NAME
FROM BSI_COMPANY bc INNER JOIN (
			SELECT BXEJJ.JOIN_NR, BXEJJ.EXT_JOIN_NR
			FROM BSI_X_EXT_JOIN_JOIN bxejj WHERE BXEJJ.JOIN_NO IN (
				1006121385, 1002059302, 1011515861, 1001596138, 1001227916, 1004269645, 1000431873, 1001595821, 1001435466, 1001959511, 1004470312, 1000003161, 1001718698, 1000582101, 1002441526, 1001824160, 1000642094, 1006899561, 1005949009, 1003028507, 1001630486, 1003582872, 1002042063, 1003343129, 1002217281, 1003097418, 1000846081, 1003000017, 1001435466, 1001628896, 1000998853, 1004150225, 1001782101, 1007097217, 1005320710, 1002381067, 1006257564, 1001795198, 1009741707, 1010045148, 1001609902
			) 
		) ejj_join ON ejj_join.join_nr = BC.COMPANY_NR
;


SELECT * FROM BSI_COMMUNICATION bc WHERE BC.X_COMMUNICATION_EXT_KEY LIKE '%5D6D41D4%'
;
SELECT * FROM BSI_COMMUNICATION bc WHERE BC.CALL_GUID LIKE '%35b8a8f7%'
;

SELECT * FROM BSI_COMMUNICATION bc WHERE BC.co LIKE '%5D6D41D4%'
;
SELECT * FROM BSI_COMMUNICATION bc
	INNER JOIN EXT_COMMUNICATION ec 
	ON EC.COMMUNICATION_EXT_KEY = BC.X_COMMUNICATION_EXT_KEY
--WHERE BC.X_COMMUNICATION_EXT_KEY IS NULL
;

SELECT 
	BC.X_COMMUNICATION_EXT_KEY,
	BC.DISPLAY_NAME,
	BC.CHANNEL_UID,
	BC.STATUS_UID,
	BC.EVT_START,
	PRS.PERSON_NR,
	PRS.PERSON_NO,
	PRS.X_COMPLEX_NO
FROM BSI_COMMUNICATION bc
INNER JOIN BSI_PERSON prs 
ON PRS.PERSON_NR = BC.RESPONSIBLE_USER_NR
AND PRS.PERSON_NO IS NOT NULL
;

SELECT 
	BC.COMPANY_NR, 
	DOC.DOCUMENT_NR,
	doc.X_LOCATION_LOB,
	DOC.ITEM_TYPE_ID,
	DOC.DOCUMENT_TYPE_UID
FROM BSI_COMPANY bc
INNER JOIN BSI_DOCUMENT doc
ON DOC.ITEM_KEY0_NR = bc.COMPANY_NR
--WHERE BC.COMPANY_NO = 1566383
WHERE BC.COMPANY_NR = 19062485 --19061391, 19062485, 5076427198
;
SELECT 
	BC.COMPANY_NR, 
	DOC.DOCUMENT_NR,
	doc.X_LOCATION_LOB,
	DOC.ITEM_TYPE_ID,
	DOC.DOCUMENT_TYPE_UID
FROM BSI_COMPANY bc
INNER JOIN BSI_DOCUMENT doc
ON DOC.ITEM_KEY0_NR = bc.COMPANY_NR
WHERE BC.COMPANY_NR = 21390199 -- 19062485
;
-- SUCCESS
SELECT 
	LISTAGG(DOC.X_LOCATION_LOB, ', ') WITHIN GROUP (ORDER BY DOC.X_LOCATION_LOB) document_links
FROM BSI_DOCUMENT doc
WHERE DOC.ITEM_KEY0_NR = 19062485
;
-- SUCCESS
SELECT 
    RTRIM (XMLAGG (XMLELEMENT (e, DOC.X_LOCATION_LOB || ',')).EXTRACT ('//text()'), ',') document_links
FROM BSI_DOCUMENT doc
WHERE DOC.ITEM_KEY0_NR = 19062485
;



SELECT table_0_.PARTITION_UID col_0_ 
FROM BSI_COMPANY table_0_ 
WHERE table_0_.COMPANY_NR= 19062485  and table_0_.DTYPE=2000
;



SELECT * FROM BSI_DOCUMENT bd WHERE BD.DOCUMENT_NR = '67532131'
;

SELECT 
	BC.X_COMMUNICATION_EXT_KEY
FROM BSI_COMMUNICATION bc
INNER JOIN BSI_CASE cse 
ON CSE.CASE_FRAME_NR = BC.CASE_FRAME_NR
WHERE CSE.X_COMPANY_NR IN (4963438374, 19107866)
;
-- 12’660’822
-- 12’660’822

SELECT *
FROM BSI_CASE bcs 
INNER JOIN BSI_DOCUMENT doc 
ON DOC.




-- ----------------------
--
SELECT * FROM BSI_COMPANY bc WHERE BC.COMPANY_NO = '1470886'
;
SELECT * FROM BSI_X_SAMBA_LOCK_CANDIDATE bxslc WHERE BXSLC.COMPANY_NR = '22329226'
;
DELETE FROM BSI_X_SAMBA_LOCK_CANDIDATE bxslc WHERE BXSLC.COMPANY_NR = '22329226'
;
SELECT * FROM BSI_UC_TEXT but WHERE BUT.UC_UID = 138431 AND BUT.LANGUAGE_UID = 246
;