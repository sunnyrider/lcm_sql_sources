SELECT uct.text, UC.* FROM BSI_UC uc
INNER JOIN BSI_UC_TEXT uct
ON UCT.UC_UID = UC.UC_UID
WHERE lower(UCT.TEXT) LIKE 'key%account%'
AND UCT.LANGUAGE_UID = 246;
--
-- TEXT								UC_UID		CODE_TYPE
-- KEY - Key Account				133504		143811
-- Key Account Management (KAM)		4224912303	119374
-- Key Account						4630656792	111866


SELECT UCT.UC_UID, UCT.TEXT, uc.CODE_TYPE, UC.IS_ACTIVE FROM BSI_UC uc INNER JOIN BSI_UC_TEXT uct ON UCT.UC_UID = UC.UC_UID 
WHERE UC.CODE_TYPE = 143811
AND UC.IS_ACTIVE = 1
AND UCT.LANGUAGE_UID = '246';
--
-- CODE_TYPE = 143811,  IS_ACTIVE = 1
--
-- UC_UID	TEXT
-- 133501	AUSL - Auslandkunde	
-- 133502	GKM - Grosskunde mit Sammelrechnung
-- 133503	GROS - Grosskunde ohne Sammelrechnung
-- 133504	KEY - Key Account
-- 133505	SPEZ - Spezialkunde Sammelrechnung
-- 133506	VOR - Vorauszahlung

SELECT uct.* FROM BSI_UC uc 
INNER JOIN BSI_UC_TEXT uct ON UCT.UC_UID = UC.UC_UID
INNER JOIN BSI_X_EXT_JOIN_JOIN ejj
	INNER JOIN BSI_X_EXT_JOIN ej
		ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
	ON CMP. = UC.UC_UID
WHERE UCT.TEXT LIKE 'key%account%';

SELECT UCT.UC_UID  FROM BSI_X_EXT_JOIN_JOIN ejj INNER JOIN BSI_X_EXT_JOIN ej
	INNER JOIN BSI_UC uc
		INNER JOIN BSI_UC_TEXT uct 
			ON UCT.UC_UID = UC.UC_UID
		ON UC.UC_UID = EJ.INTERFACE_UID
	ON EJ.EXT_JOIN_TYPE_UID = EJJ.EXT_JOIN_TYPE_UID
WHERE UCT.LANGUAGE_UID = 246
AND UC.IS_ACTIVE = 1
GROUP BY UCT.UC_UID, UCT.TEXT
;

SELECT * FROM BSI_UC_TEXT
WHERE UC_UID IN ();
	


SELECT * FROM (
SELECT * FROM BSI_COMPANY cmp
	INNER JOIN BSI_X_EXT_JOIN_JOIN ejj
		INNER JOIN BSI_X_EXT_JOIN ej
			ON EJ.EXT_JOIN_NR = EJJ.EXT_JOIN_NR
		ON EJJ.JOIN_NR = CMP.COMPANY_NR
	WHERE
		ej.interface_uid = 108187	-- Adresse > SAMBA
		AND CMP.TYPE_UID IN ()
) WHERE rownum < 11;

